!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("ramda"),require("rxjs/operators"),require("rxjs")):"function"==typeof define&&define.amd?define("spyne",["ramda","rxjs/operators","rxjs"],t):"object"==typeof exports?exports.spyne=t(require("ramda"),require("rxjs/operators"),require("rxjs")):e.spyne=t(e.R,e.rxjs.operators,e.rxjs)}(window,function(e,t,n){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t,n){e.exports=n(4)},function(e,t){e.exports=i;var n=Object.create,r=function(){throw new Error("Not implemented.")},o=function(){return this};function i(){}function a(e){this.value=e}function s(e){this.value=e}a.prototype=n(i.prototype),s.prototype=n(i.prototype),i.Failure=function(e){return new a(e)},i.prototype.Failure=i.Failure,i.Success=function(e){return new s(e)},i.prototype.Success=i.Success,i.fromNullable=function(e){return null!=e?new s(e):new a(e)},i.prototype.fromNullable=i.fromNullable,i.fromEither=function(e){return e.fold(i.Failure,i.Success)},i.prototype.isFailure=!1,a.prototype.isFailure=!0,i.prototype.isSuccess=!1,s.prototype.isSuccess=!0,i.of=function(e){return new s(e)},i.prototype.of=i.of,i.prototype.ap=r,a.prototype.ap=function(e){return e.isFailure?this.Failure(this.value.concat(e.value)):this},s.prototype.ap=function(e){return e.isFailure?e:e.map(this.value)},i.prototype.map=r,a.prototype.map=o,s.prototype.map=function(e){return this.of(e(this.value))},i.prototype.toString=r,a.prototype.toString=function(){return"Validation.Failure("+this.value+")"},s.prototype.toString=function(){return"Validation.Success("+this.value+")"},i.prototype.isEqual=r,a.prototype.isEqual=function(e){return e.isFailure&&e.value===this.value},s.prototype.isEqual=function(e){return e.isSuccess&&e.value===this.value},i.prototype.get=r,a.prototype.get=function(){throw new TypeError("Can't extract the value of a Failure(a).")},s.prototype.get=function(){return this.value},i.prototype.getOrElse=r,a.prototype.getOrElse=function(e){return e},s.prototype.getOrElse=function(e){return this.value},i.prototype.orElse=r,s.prototype.orElse=o,a.prototype.orElse=function(e){return e(this.value)},i.prototype.merge=function(){return this.value},i.prototype.fold=r,a.prototype.fold=function(e,t){return e(this.value)},s.prototype.fold=function(e,t){return t(this.value)},i.prototype.cata=r,a.prototype.cata=function(e){return e.Failure(this.value)},s.prototype.cata=function(e){return e.Success(this.value)},i.prototype.swap=r,a.prototype.swap=function(){return this.Success(this.value)},s.prototype.swap=function(){return this.Failure(this.value)},i.prototype.bimap=r,a.prototype.bimap=function(e,t){return this.Failure(e(this.value))},s.prototype.bimap=function(e,t){return this.Success(t(this.value))},i.prototype.failureMap=r,s.prototype.failureMap=o,a.prototype.failureMap=function(e){return this.Failure(e(this.value))},i.prototype.leftMap=i.prototype.failureMap,s.prototype.leftMap=s.prototype.failureMap,a.prototype.leftMap=a.prototype.failureMap},function(e,t,n){"use strict";n.r(t);var r=n(0),o=function(e){if(void 0!==e.constructor.name)return e.constructor.name;var t=e.toString();return Object(r.defaultTo)(String(t).substr(0,12),Object(r.match)(/^(function\s)(\w+)(\(.*)$/,t)[2])},i=function(e,t){void 0===e&&(e=void 0),void 0===t&&(t=[]);t=Object(r.concat)(["length","name","prototype","constructor"],t);var n=Object(r.compose)(Object(r.without)(t),r.uniq),o=n(Object.getOwnPropertyNames(e.constructor.prototype)),i=n(function(e,t){return void 0===e&&(e=void 0),void 0===t&&(t=[]),Object.getOwnPropertyNames(e)}(e.constructor));return{methods:o,staticMethods:i,allMethods:Object(r.concat)(o,i)}},a=n(2),s=n(2),c=function(){return{includes:function(){return void 0!==window.Spyne?(e=window.Spyne.channels.map,t=[],Object(r.forEach)(function(e,n,r){return t.push(n)},e),t):["CHANNEL_ROUTE","CHANNEL_UI","CHANNEL_WINDOW","DISPATCHER"];var e,t}}},u=["LOAD","RENDER","MOUNT","UNMOUNT","DISPOSE","GARBAGE_COLLECT","UPDATE"],d=["parent","self","child","children","view"],p=["Observable","BehaviorSubject","Subject","Observer","Subscriber","FromEventObservable"],h=["subscribe","combineLatest"],l=[],f=[],E=[];if(void 0!==r.compose&&void 0!==a){l=[{error:"need to match a valid name within "+p,predicate:function(e){return c().includes(e.name)}},{error:"param 'observable' must contain a valid Observable",predicate:function(e){return void 0!==e.observable.subscribe}},{error:"param action must be a registered action",predicate:function(e){return h.includes(e.action)}}],f=[{error:"needs vsid number in srcElement",predicate:Object(r.compose)(Object(r.is)(String),Object(r.path)(["data","srcElement","vsid"]))},{error:"needs a id in srcElement",predicate:Object(r.compose)(Object(r.is)(String),Object(r.path)(["data","srcElement","id"]))}],E=function(){return[].concat(l).concat(f)};var b=[{error:"need to match a valid name within "+p,predicate:function(e){return c().includes(e.name)}},{error:"needs one of the following step strings: "+u,predicate:function(e){return u.includes(e.STEP)}},{error:"type needs to one of the following: "+d,predicate:function(e){return d.includes(e.type)}},{error:"viewId needs to be added ",predicate:function(e){return void 0!==e.viewId}}];(function(){return[].concat(b)}),function(){return[{error:"DISPOSE STEP requires a disposeItem param in the data object",predicate:function(e){return"DISPOSE"===e.STEP&&void 0!==e.data.disposeItems}}].concat(b)},function(){var e=[{error:"UPDATE STEP requires a data object ",predicate:function(e){return"UPDATE"===e.STEP&&void 0!==e.data}}];return e.concat(b)},function(){return b.concat(l).concat(f)},function(){return[].concat(l).concat(f)},function(){var e=[{error:"param 'name' must be of a registered type",predicate:function(e){return c().includes(e.name)}},{error:"param 'observable' must contain a valid Observable",predicate:function(e){return p.includes((0,e.observable)().constructor.name)}},{error:"param action must be a registered action",predicate:function(e){return h.includes(e.action)}}];return{streams:[{init:{name:"DISPATCHER",observable:function(){return new s},action:"subscribe"},structure:{type:String,observable:a||s,action:String},validations:e},{init:{name:"UBU",observable:function(){return new s},action:"subscribe"},structure:{type:String,observable:a||s,action:String},validations:e}]}}}var m=function(){function e(t,n,o,i,a){var s=t,c={channelName:t,action:n,payload:o,srcElement:i,event:a,props:function(){return Object(r.mergeAll)([c.payload,{payload:c.payload},{channel:s},{event:a},c.srcElement,c.event,{action:c.action}])}},u=window.Spyne.getChannelActions(s);return e.validateAction(n,s,u),"CHANNEL_ROUTE"===s&&(c.location=e.getLocationData()),c}return e.validateAction=function(e,t,n){var o=Object(r.includes)(e,n);return!1===o&&void 0!==window.Spyne&&console.warn("warning: Action: '"+e+"' is not registered within the "+t+" channel!"),o},e.getLocationData=function(){return Object(r.pickAll)(["href","origin","protocol","host","hostname","port","pathname","search","hash"],window.location)},e.getStreamItem=function(){},e.getMouseEventKeys=function(){return["altKey","bubbles","cancelBubble","cancelable","clientX","clientY","composed","ctrlKey","currentTarget","defaultPrevented","detail","eventPhase","fromElement","isTrusted","layerX","layerY","metaKey","movementX","movementY","offsetX","offsetY","pageX","pageY","path","relatedTarget","returnValue","screenX","screenY","shiftKey","sourceCapabilities","srcElement","target","timeStamp","toElement","type","view","which","x","y"]},e}();function v(){return{createpropsMap:function(){var e=new WeakMap,t={vsid:this.props.vsid};return e.set(t,this.props),{key:t,weakMap:e}},gc:function(){for(var e in this)delete this[e]},createId:function(){return Math.random().toString(36).substring(2,8)},setTraceFunc:function(e){return!0===e?console.log:function(){}}}}function O(e){return e&&"object"==typeof e&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e)}function N(e,t){var n;return t&&!0===t.clone&&O(e)?y((n=e,Array.isArray(n)?[]:{}),e,t):e}function _(e,t,n){var r=e.slice();return t.forEach(function(t,o){void 0===r[o]?r[o]=N(t,n):O(t)?r[o]=y(e[o],t,n):-1===e.indexOf(t)&&r.push(N(t,n))}),r}function y(e,t,n){var r=Array.isArray(t),o=(n||{arrayMerge:_}).arrayMerge||_;return r?Array.isArray(e)?o(e,t,n):N(t,n):function(e,t,n){var r={};return O(e)&&Object.keys(e).forEach(function(t){r[t]=N(e[t],n)}),Object.keys(t).forEach(function(o){O(t[o])&&e[o]?r[o]=y(e[o],t[o],n):r[o]=N(t[o],n)}),r}(e,t,n)}y.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce(function(e,n){return y(e,n,t)})};var S=function(){function e(t,n){var o=this;this.template=this.formatTemplate(t);!0===Object(r.is)(Array,n)&&(n={spyneData:n},o.template=o.template.replace("{{/}}","{{/spyneData}}"),o.template=o.template.replace("{{#}}","{{#spyneData}}")),this.templateData=n;var i=e.getStringArray(this.template),a=this.template.match(e.findTmplLoopsRE());a=null===a?[]:a;var s=Object(r.includes)(r.__,a),c=Object(r.ifElse)(s,function(t,n){return t.replace(e.parseTmplLoopsRE(),o.parseTheTmplLoop.bind(o))},this.addParams.bind(this));this.finalArr=i.map(c)}e.getStringArray=function(t){var n=t.split(e.findTmplLoopsRE()),o=/^([\\n\s\W]+)$/;return Object(r.reject)(function(e){return e.match(o)},n)},e.findTmplLoopsRE=function(){return/({{#\w+}}[\w\n\s\W]+?{{\/\w+}})/gm},e.parseTmplLoopsRE=function(){return/({{#(\w+)}})([\w\n\s\W]+?)({{\/\2}})/gm},e.swapParamsForTagsRE=function(){return/({{)(.*?)(}})/gm};var t=e.prototype;return t.removeThis=function(){this.finalArr=void 0,this.templateData=void 0,this.template=void 0},t.renderDocFrag=function(){var e=this.finalArr.join(""),t=document.createRange().createContextualFragment(e);return window.setTimeout(this.removeThis(),10),t},t.getTemplateString=function(){return this.finalArr.join("")},t.formatTemplate=function(e){return"string"==typeof e?e:e.text},t.addParams=function(t){var n=this;return t.replace(e.swapParamsForTagsRE(),function(e,t,o,i){var a=Object(r.compose)(Object(r.path)(r.__,n.templateData),Object(r.split)("."))(o);return Object(r.defaultTo)("")(a)})},t.parseTheTmplLoop=function(t,n,o,i){var a=i,s=this.templateData[o];return!0===Object(r.isNil)(s)||Object(r.isEmpty)(s)?"":(void 0===s.length&&(s=[s]),s.map(function(t){var n;return"string"==typeof t?(n=t,t=a.replace(e.swapParamsForTagsRE(),n)):t=function(t,n){return n.replace(e.swapParamsForTagsRE(),function(e,n,o){return Object(r.compose)(Object(r.path)(r.__,t),Object(r.split)("."))(o)})}(t,a),t}).join(""))},e}();function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var A=function(){function e(e){void 0===e&&(e={});var t,n;e.tagName=(t="div",n=e.tagName,Object(r.defaultTo)(t)(n)),e.attributes=void 0!==e.attributes?e.attributes:this.getDomAttributes(e),e.attrs=this.updateAttrs(e.attributes),e.fragment=document.createDocumentFragment(),this.props=e,this.addMixins()}var t,n,o,i=e.prototype;return i.setProp=function(e,t){this.props[e]=t},i.getProp=function(e){return this.props[e]},i.setElAttrs=function(e,t){return this.getProp("attrs").forEach(function(t,n){"dataset"===n?Object(r.forEachObjIndexed)(function(t,n){e.dataset[n]=t},t):e.setAttribute(n,t)}),e},i.updateAttrs=function(e,t){var n=void 0!==t?t:new Map;return Object(r.mapObjIndexed)(function(e,t){return n.set(t,e)},e),n},i.addTemplate=function(e){var t=this,n=this.getProp("template");return void 0!==n?function(n){var o=t.getProp("data");o=Object(r.is)(Object,o)?o:{};var i=new S(n,o).renderDocFrag();return e.appendChild(i),e}(n):function(e){return e}(e)},i.createElement=function(e){return void 0===e&&(e="div"),document.createElement(e)},i.addContent=function(e){var t=this.getProp("data");if(!0===Object(r.is)(String,t)){var n=document.createTextNode(t);e.appendChild(n)}return e},i.execute=function(){var e=Object(r.pipe)(this.createElement.bind(this),this.setElAttrs.bind(this),this.addTemplate.bind(this),this.addContent.bind(this))(this.getProp("tagName"));this.props.el=e},i.render=function(){return this.execute(),this.props.template=void 0,this.props.data=void 0,this.props.attributes=void 0,this.getProp("el")},i.returnIfDefined=function(e,t){if(void 0!==t){var n=void 0===t;e[t]=!1===n?t:y(e[t],t)}},i.updateprops=function(e){return this.returnIfDefined(this.props,e),this},i.updatepropsAndRun=function(e){return this.updateprops(e),this.execute(),this.getProp("fragment")},i.unmount=function(){void 0!==this.props&&(this.getProp("el").remove(),this.props=void 0,this.gc())},i.updateTag=function(e){void 0===e&&(e="div"),this.updateprops(e)},i.updateAttributes=function(e){void 0===e&&(e={}),this.updateprops(e)},i.updateTemplate=function(e){this.updateprops(e)},i.updateData=function(e){void 0===e&&(e={}),this.updateprops(e)},i.addTagAndRender=function(e){void 0===e&&(e="div"),this.updatepropsAndRun(e)},i.addAttrsibutesAndRender=function(e){void 0===e&&(e={}),this.updatepropsAndRun(e)},i.addTemplateAndRender=function(e){this.updatepropsAndRun(e)},i.addDataAndRender=function(e){void 0===e&&(e={}),this.updatepropsAndRun(e)},i.addMixins=function(){var e=v();this.gc=e.gc.bind(this)},i.getDomAttributes=function(e){return Object(r.pick)(this.attributesArray,e)},t=e,(n=[{key:"el",get:function(){return this.props.el}},{key:"attributesArray",get:function(){return["accept","accept-charset","accesskey","action","align","allow","alt","async","autocapitalize","autocomplete","autofocus","autoplay","bgcolor","border","buffered","challenge","charset","checked","cite","class","code","codebase","color","cols","colspan","content","contenteditable","contextmenu","controls","coords","crossorigin","csp","dataset","datetime","decoding","default","defer","dir","dirname","disabled","download","draggable","dropzone","enctype","for","form","formaction","headers","height","hidden","high","href","hreflang","http-equiv","icon","id","importance","integrity","ismap","itemprop","keytype","kind","label","lang","language","lazyload","list","loop","low","manifest","max","maxlength","minlength","media","method","min","multiple","muted","name","novalidate","open","optimum","pattern","ping","placeholder","poster","preload","radiogroup","readonly","referrerpolicy","rel","required","reversed","rows","rowspan","sandbox","scope","scoped","selected","shape","size","sizes","slot","span","spellcheck","src","srcdoc","srclang","srcset","start","step","style","summary","tabindex","target","title","translate","type","usemap","value","width","wrap"]}}])&&T(t.prototype,n),o&&T(t,o),e}(),g=function(e,t,n,r){return void 0===e&&(e=!1),void 0===t&&(t=1),void 0===n&&(n="ease"),void 0===r&&(r=!1),(!0===r?"opacity:0;":"")+"transition: opacity "+t+"s "+n+"; opacity: "+(!0===e?1:0)+";"};var j=n(2),C=n(1),I=function(){function e(t){this.props.observableStreams=e.createDirectionalObservables()}return e.createDirectionalFiltersObject=function(){return{P:["parent"],C:["child"],PCI:["parent","internal","child"],CI:["child","internal"],PI:["parent","internal"],PC:["parent","child"]}},e.addDefaultDir=function(e){return Object(r.flip)(r.mergeRight)({$dir:["internal"]},Object(r.clone)(e))},e.addDownInternalDir=function(e,t){return void 0===t&&(t=["internal","down"]),Object(r.flip)(r.mergeRight)(Object(r.clone)(e),{$dir:t})},e.addChildAndInternalDir=function(e,t){return void 0===t&&(t=["child","down"]),Object(r.flip)(r.mergeRight)(Object(r.clone)(e),{$dir:t})},e.mapToDefaultDir=function(e){return this.addDefaultDir(e)},e.createDirectionalObservables=function(e,t,n){void 0===e&&(e=new j.Subject),void 0!==t&&void 0!==n&&(e.viewName=t,e.vsid=n);var o=function(e){return Object(r.propSatisfies)(function(t){return t.includes(e)},"$dir")},i=o("parent"),a=o("child"),s=o("internal"),c=function(e){return Object(r.mergeRight)({from$:e})},u=c("child"),d=c("internal"),p=c("parent"),h=e.pipe(Object(C.filter)(function(e){return void 0!==e&&void 0!==e.action})),l=e.pipe(Object(C.filter)(s),Object(C.map)(d)),f=e.pipe(Object(C.filter)(i),Object(C.map)(u)),E=e.pipe(Object(C.filter)(a),Object(C.map)(p)),b={parent:f,internal:l,child:E};return{raw$:h,toInternal$:l,toParent$:f,toChild$:E,completeAll:function(){Object(r.forEach)(function(e){e.complete(),e.isStopped=!0},[h,l,f,E])},completeStream:function(e){void 0===e&&(e=[]);void 0!==e&&e.length>=1&&e.forEach(function(e){var t;void 0!==b[e]&&((t=b[e]).complete(),t.isStopped=!0)})}}},e}(),L=function(){function e(e,t,n,r){var o=this;void 0===t&&(t={}),void 0===n&&(n=""),void 0===r&&(r="theName"),this.addMixins(),this._state="INIT",this.vsid=n,this.vsName=r,this.defaults={debug:!1,extendedHashMethods:{}},this.options=y(this.defaults,t);this.addActionListeners().forEach(function(e){var t=e[0],n=e[1];o.options.extendedHashMethods[t]=function(e){return o[n](e)}}),this.options.hashMethods=this.setHashMethods(this.options.extendedHashMethods),this.sink$=e,this.sink$.subscribe(this.onObsSinkSubscribe.bind(this)),this.$dirs=I.createDirectionalFiltersObject(),this.addDefaultDir=I.addDefaultDir,this.sourceStreams=I.createDirectionalObservables(new j.Subject,this.vsName,this.vsid),this._source$=this.sourceStreams.toInternal$}var t=e.prototype;return t.addActionListeners=function(){return[]},t.setHashMethods=function(e){var t=this;return void 0===e&&(e={}),y({VS_DETRITUS_COLLECT:function(e){return t.onGarbageCollect(e)},READY_FOR_VS_DETRITUS_COLLECT:function(e){return t.onReadyForGC(e)},EXTIRPATE:function(e){return t.onDispose(e)},VS_SPAWN:function(e){return t.onRender(e)},VS_SPAWN_AND_ATTACH_TO_PARENT:function(e){return t.onRenderAndAttachToParent(e)},VS_SPAWN_AND_ATTACH_TO_DOM:function(e){return t.onRenderAndAttachToDom(e)},ATTACH_CHILD_TO_SELF:function(e){return t.onAttachChildToSelf(e)}},e)},t.createDomItem=function(){this.props=void 0!==this.props?this.props:{};var e=Object(r.filter)(function(e){return void 0!==e},Object(r.pick)(["id","className"],this.props)),t=this.props,n=t.tagName,o=t.data,i=t.template;return new A(n,e,o,i)},t.onDisposeCompleted=function(e){},t.animateInTween=function(e,t){!function(e,t){var n=1*window.getComputedStyle(e).opacity,r=g(!0,t,"ease",1===n);e.style.cssText+=r}(e,t)},t.animateOutTween=function(e,t,n){!function(e,t,n){var r=g(!1,t,"ease");e.style.cssText+=r,console.log(t," inline is ",r),e.addEventListener("transitionend",n,!1)}(e,t,n)},t.setAnimateIn=function(e){if(!0===e.animateIn){var t=void 0!==e.el?e.el:this.domItem.el;this.animateInTween(t,e.animateInTime)}},t.disposeMethod=function(e){var t=this,n=void 0!==e.el.el?e.el.el:e.el,r={action:"READY_FOR_VS_DETRITUS_COLLECT",$dir:this.$dirs.PI,el:n},o=Object(j.bindCallback)(function(e,r){t.animateOutTween(n,e.animateOutTime,r)}),i=function(e){t._source$.next(r)};return(!0===e.animateOut?function(e){return o(e).subscribe(i),{action:"EXTIRPATING",$dir:t.$dirs.CI}}:function(){return{action:"EXTIRPATE_AND_READY_FOR_VS_DETRITUS_COLLECT",$dir:t.$dirs.CI}})(e)},t.onDispose=function(e){return this.disposeMethod(e)},t.removeStream=function(){void 0!==this.sourceStreams&&this.sourceStreams.completeStream(["internal","child"])},t.onReadyForGC=function(e){this.removeStream()},t.onGarbageCollect=function(e){void 0!==this.domItem&&this.domItem.unmount(),void 0!==this.sourceStreams&&this.sourceStreams.completeStream(["parent"])},t.getSourceStream=function(){return this._source$},t.combineDomItems=function(e){var t=Object(r.isNil)(e.query)?e.node:e.query;("appendChild"===e.attachType?function(e,t){return e.appendChild(t)}:function(e,t){return e.insertBefore(t,e.firstChild)})(t,this.domItem.render()),this.setAnimateIn(e)},t.onAttachChildToSelf=function(e){var t=e.childRenderData;return this.combineDomItems(t),{action:"CHILD_ATTACHED",$dir:this.$dirs.PI}},t.onRenderAndAttachToParent=function(e){return this.onRender(e),this.combineDomItems(e),{action:"VS_SPAWNED_AND_ATTACHED_TO_PARENT",el:this.domItem.el,$dir:this.$dirs.PI}},t.renderDomItem=function(e){var t,n,r,o;return t=e[0],n=e[1],r=e[2],o=e[3],this.domItem=new A({tagName:t,attributes:n,data:r,template:o}),this.domItem},t.onRender=function(e){var t,n=this;return{action:"VS_SPAWNED",el:(t=Object(r.props)(["tagName","domAttributes","data","template"],e),n.renderDomItem(t)),$dir:this.$dirs.I}},t.extendedMethods=function(e){},t.onRenderAndAttachToDom=function(e){var t,n=this;return e.attachData.el=(t=Object(r.props)(["tagName","domAttributes","data","template"],e),n.renderDomItem(t)),this.combineDomItems(e.attachData),{action:"VS_SPAWNED_AND_ATTACHED_TO_DOM",el:e.attachData.el.el,$dir:this.$dirs.CI}},t.onObsSinkSubscribe=function(e){var t,n=this,o=e.action,i=Object(r.defaultTo)(function(e){return n.extendedMethods(e)})(this.options.hashMethods[o])(e);void 0!==i&&(t=Object.freeze(i),n._source$.next(t))},t.addMixins=function(){},e}(),D=function(){function e(e,t){this.context=e,this.enhancersMap=new Map,this.enhancersArr=t,this.initMap(),this.addAllEnhancerMethods()}var t=e.prototype;return t.initMap=function(){this.enhancersMap.set("ALL",[]);var e=i(this.context).allMethods;this.updateMap("LOCAL",e)},t.getEnhancersMap=function(){return this.enhancersMap},t.updateMap=function(e,t){var n=Object(r.concat)(this.enhancersMap.get("ALL"),t);this.enhancersMap.set(e,t),this.enhancersMap.set("ALL",n)},t.getMethodsArr=function(e){return this.enhancersMap.get(e)},t.createEnhancerMethodsObj=function(e){var t,n,o,i=this,a=function(e){return console.error('Spyne Error: The following enhancer method, "'+e+'", already exists and cannot be added to the '+s.name+" Enhancer!")},s=new e(this.context),c=s.getEnhancerMethods(),u=(t=c.allMethods,n=Object(r.includes)(r.__,i.getMethodsArr("ALL")),(o=Object(r.filter)(n,t)).forEach(a),o),d=Object(r.dropWhile)(Object(r.includes)(r.__,u));return c=Object(r.map)(d,c),this.updateMap(s.name,c.allMethods),c.enhancer=s,c.name=s.name,c},t.addAllEnhancerMethods=function(){var e=this;Object(r.forEach)(function(t){var n=e.createEnhancerMethodsObj(t);n.enhancer.bindParentViewStream(n,e.context)},this.enhancersArr)},e}(),w=n(3),R=n.n(w),P=R.a.Success,V=R.a.Failure,H=function(){};function M(){var e=this;setTimeout(function(){Object(r.forEach)(function(e){},e)},1)}void 0!==r.curry&&(H=Object(r.curry)(function(e,t){var n=P(Object(r.curryN)(Object(r.length)(e),Object(r.always)(t)));return Object(r.reduce)(function(e,n){return e.ap(n.predicate(t)?P(t):V([n.error]))},n,e)}));var W=function(){function e(e,t,n,r,o){void 0===r&&(r="subscribe"),void 0===o&&(o=!1),this.addMixins(),this.options={name:e,observable:t,data:n,action:r},this.getValidationChecks(e)}var t=e.prototype;return t.getValidationChecks=function(e){var t,n,r=this;return!0===window.Spyne.channels.map.has(e)?(n=E,r.onRunValidations(n)):(t="payload Needs a Valid Stream Name!",console.warn(t))},t.onRunValidations=function(e){H(e(),this.options).fold(this.onError.bind(this),this.onSuccess.bind(this))},t.onPayloadValidated=function(e){this.sendToDirectorStream(e)},t.sendToDirectorStream=function(e){window.Spyne.channels.getStream("DISPATCHER").next(e),this.gc()},t.onError=function(e){console.warn("payload failed due to:\n"+e.map(function(e){return"* "+e}).join("\n")),this.gc()},t.onSuccess=function(e){this.onPayloadValidated(e)},t.addMixins=function(){this.gc=M},e}();var F=function(){function e(e,t){this.addMixins(),this.props=e,this.broadcastFn=t,this.broadcaster(this.broadcastFn)}var t=e.prototype;return t.addDblClickEvt=function(e){return Object(j.fromEvent)(e,"dblclick").pipe(Object(C.map)(function(e){var t=Object(r.clone)(e);return t.typeOverRide="dblclick",t}))},t.broadcast=function(e){var t,n,o=this,i={UI:this.sendUIPayload,ROUTE:this.sendRoutePayload},a=e[0],s=e[1],c=e[2],u=this.props.el.querySelectorAll(a);if(u.length<=0){var d=this.props.el,p=function(e){e===d&&(u=[e])};(n=(null!==d.parentElement?d.parentElement:document).querySelectorAll(a)).forEach=Array.prototype.forEach,n.forEach(p)}var h=void 0!==c,l=!0===Object(r.path)(["Spyne","config","debug"],window);!0===(void 0===u||u.length<=0)&&!0===l?console.warn("Spyne Warning: The item "+a+", does not appear to exist!"):(u.forEach=Array.prototype.forEach,u.forEach(function(e){var n="dblClick"!==s?Object(j.fromEvent)(e,s,{preventDefault:function(){return!0}}):o.addDblClickEvt(e);t=e.dataset.channel;var a={};a.payload=function(e){var t={};for(var n in e)t[n]=e[n];return t}(e.dataset),a.payload=Object(r.omit)(["channel"],a.payload),a.channel=t,a.srcElement={},a.srcElement.id=o.props.id,a.srcElement.vsid=o.props.vsid,a.srcElement.isLocalEvent=h,a.srcElement.srcEvent=s,a.srcElement.el=e,(void 0!==t?i[t]:i.UI)(n,a)}))},t.broadcaster=function(e){var t=this;e().forEach(function(e){return t.broadcast(e)})},t.addMixins=function(){var e={testFunc:function(e){console.log("stream mixin is ",e)},sendRoutePayload:function(e,t){return new W("CHANNEL_ROUTE",e,t,"subscribe")},sendUIPayload:function(e,t){return new W("CHANNEL_UI",e,t,"subscribe")}};this.sendUIPayload=e.sendUIPayload,this.sendRoutePayload=e.sendRoutePayload},e}(),U=n(0).map,k=function(){function e(t,n){var o=Object(r.compose)(r.not,r.isEmpty),i=Object(r.allPass)([Object(r.is)(String),o]),a=Object(r.allPass)([Object(r.is)(Array),o]),s=i(t)?e.filterSelector([t]):void 0,c=a(t)?e.filterSelector(t):void 0,u=Object(r.is)(Object,n)?e.filterData(n):void 0,d=Object(r.reject)(r.isNil,[s,c,u]);return Object(r.isEmpty)(d)&&(d=[Object(r.always)(!1)],!0===Object(r.path)(["Spyne","config","debug"],window)&&console.warn("Spyne Warning: The Channel Filter, with selector: "+t+", and data:"+n+" appears to be empty!")),Object(r.allPass)(d)}return e.filterData=function(e){return function(){if(Object(r.isEmpty)(e))return Object(r.always)(!1);e=U(function(e,t,n){return!0===Object(r.is)(String,e)?(o=e,function(e){return e===o}):e;var o},e);var t=Object(r.where)(e),n=Object(r.ifElse)(Object(r.prop)("props"),Object(r.invoker)(0,"props"),r.identity);return Object(r.compose)(t,Object(r.defaultTo)({}),n)}()},e.checkPayloadSelector=function(e,t){var n=Object(r.path)(["el"],t),o=function(e){return e.isEqualNode(n)};if("object"!=typeof n)return!1;var i=Object(r.compose)(r.flatten,U(function(e){var t=Object(r.flatten)(document.querySelectorAll(e));return U(o,t)}))(e);return!0!==Object(r.isEmpty)(i)&&Object(r.any)(Object(r.equals)(!0),i)},e.filterSelector=function(t){var n=Object(r.reject)(r.isEmpty,t);return Object(r.curry)(e.checkPayloadSelector)(n)},e}();function x(){return!0===Object(r.path)(["Spyne","config","debug"],window)}function $(e,t,n){void 0===n&&(n=!1);var o=q(e,t,n);return 1===o.length?Object(r.head)(o):o}function G(e,t,n){var o=document.querySelector(e);!1!==Object(r.compose)(Object(r.lte)(0),Object(r.defaultTo)(-1),Object(r.prop)("nodeType"))(o)?void 0!==t&&null===o.querySelector(t)&&!0===x()&&!0===n&&console.warn("Spyne Warning: the selector, "+t+" does not exist in this el, "+e):console.warn("Spyne Warning: the el object is not a valid single element, "+o)}function q(e,t,n){void 0===n&&(n=!1);var r=void 0!==t?e+" "+t:e;return!0===n&&G(e,t,n),document.querySelectorAll(r)}function Y(e,t,n){return q(t,n).forEach(function(t){t.style.cssText=e}),this}function B(e,t){var n,o,i=this;function a(t){return B(e,t)}return G(e="string"==typeof e?e:(n=e,o=""+Math.random().toString(36).substring(2,8),void 0===n.dataset.vsid?n.dataset.vsid=o:o=n.dataset.vsid,"[data-vsid='"+o+"']"),t,!1),a.map=function(n){return Array.from(q(e,t)).map(n)},a.forEach=function(n){return Array.from(q(e,t)).map(n)},a.getNodeListArray=function(){return q(e,t)},a.addClass=function(n){return q(e,t).forEach(function(e){return e.classList.add(n)}),i},a.removeClass=function(n){return q(e,t).forEach(function(e){e.classList.remove(n)}),i},a.setClass=function(n){return q(e,t).forEach(function(e){return e.classList=n}),i},a.unmount=function(){console.log("unmounting selector ",i)},a.toggleClass=function(n,r){return q(e,t).forEach(function(e){r=void 0!==r?r:!e.classList.contains(n),e.classList.toggle(n,r)}),i},a.toggle=function(e,t){return a.toggleClass(e,t),i},a.appendChild=function(e){return 0!==a.el.length?a.el.appendChild(e):console.warn("Spyne Warning: The selector, "+t+" does not appear to be valid!"),a.el},a.addAnimClass=function(n){window.setTimeout(function(){q(e,t).forEach(function(e){return e.classList.add(n)})},1)},a.setActiveItem=function(n,o){var a,s=q(e,t),c="string"==typeof o?$(e,o):o;return!0===(a=c,Object(r.compose)(Object(r.lte)(0),Object(r.defaultTo)(-1),Object(r.prop)("nodeType"))(a))?s.forEach(function(e){return e.classList.toggle(n,e.isEqualNode(c))}):!0===x()&&(console.log("SEL IS ",o,n),console.warn("Spyne Warning: The selector, "+o+", does not appear to be a valid item in setActiveItem: "+n)),i},Object.defineProperty(a,"el",{get:function(){return $(e,t,!0)}}),Object.defineProperty(a,"length",{get:function(){return q(e,t,!1).length}}),Object.defineProperty(a,"exists",{get:function(){return q(e,t,!1).length>=1}}),Object.defineProperty(a,"exist",{get:function(){return q(e,t,!1).length>=1}}),Object.defineProperty(a,"nodeList",{get:function(){return q(e,t)}}),Object.defineProperty(a,"inline",{set:function(n){return Y(n,e,t)}}),Object.defineProperty(a,"inlineCss",{set:function(n){return Y(n,e,t)}}),a}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var K=function(){function e(t){var n=this;void 0===t&&(t={}),this.checker=Math.random(),this.addMixins(),this.defaults=function(){var e=n.createId(),r=t.id?t.id:e;return{vsid:e,id:r,tagName:"div",el:void 0,data:void 0,animateIn:!1,animateInTime:.5,animateOut:!1,animateOutTime:.5,sendLifecyleEvents:!1,hashId:"#"+r,viewClass:L,extendedSourcesHashMethods:{},debug:!1,template:void 0,node:document.createDocumentFragment(),name:o(n)}},this._state={},this.$dirs=I.createDirectionalFiltersObject(),this.addDefaultDirection=I.addDefaultDir,this.addDownInternalDir=I.addDownInternalDir,this.props=y(this.defaults(),t),this.sendLifecycleMethod=!0===this.props.sendLifecyleEvents?this.sendLifecycleMethodActive.bind(this):this.sendLifecycleMethodInactive.bind(this);var i=this.attributesArray;this.props.domAttributes=Object(r.pick)(i,this.props),void 0!==this.props.traits&&this.addTraits(this.props.traits),this.loadEnhancers(),this.loadAllMethods(),this.props.action="LOADED",this.sink$=new j.Subject;var a=this.props.viewClass;this.view=new a(this.sink$,{},this.props.vsid,this.props.id),this.sourceStreams=this.view.sourceStreams,this._rawSource$=this.view.getSourceStream(),this._rawSource$.viewName=this.props.name,this.sendEventsDownStream=this.sendEventsDownStreamFn,this.initViewStream(),this.isDevMode=e.isDevMode(),this.props.addedChannels=[],this.checkIfElementAlreadyExists()}var t,n,i,a=e.prototype;return a.updatePropsToMatchEl=function(){var e=Object(r.compose)(r.toLower,Object(r.either)(Object(r.prop)("tagName"),Object(r.always)("")));this.props.tagName=e(this.props.el)},a.checkIfElementAlreadyExists=function(){var e=Object(r.compose)(Object(r.lte)(0),Object(r.defaultTo)(-1),Object(r.prop)("nodeType"));Object(r.propSatisfies)(Object(r.allPass)([function(e){return document.contains(e)},e]),"el")(this.props)&&(this.updatePropsToMatchEl(),this.postRender())},a.loadEnhancers=function(e){void 0===e&&(e=[]);var t=new D(this,e);this.props.enhancersMap=t.getEnhancersMap(),t=void 0},a.loadAllMethods=function(){var e=this,t=Object(r.curry)(this.onChannelMethodCall.bind(this));this.addActionListeners().forEach(function(n){var o=n[0],i=n[1],a=n[2];Object(r.is)(String,a)&&(a=new k(a)),e.props.extendedSourcesHashMethods[o]=t(i,a)}),this.props.hashSourceMethods=this.setSourceHashMethods(this.props.extendedSourcesHashMethods)},a.addActionListeners=function(){return[]},a.onChannelMethodCall=function(e,t,n){var o,i=this;if(void 0!==n.$dir&&n.$dir.includes("child")&&!0!==this.deleted){var a=y({},n);a.$dir=this.$dirs.C,this.sourceStreams.raw$.next(a)}!0===Object(r.defaultTo)(Object(r.always)(!0),t)(n.props())&&(n=Object(r.omit)(["$dir"],n),o=n,void 0===i[e]?console.warn("Spyne Warning: The method, "+e+" does not appear to exist in "+i.constructor.name+"!"):i[e](o))},a.setSourceHashMethods=function(e){var t=this;void 0===e&&(e={});var n={EXTIRPATING:function(e){return t.checkParentDispose(e)},EXTIRPATE:function(e){return t.disposeViewStream(e)},VS_SPAWNED:function(e){return t.onVSRendered(e)},VS_SPAWNED_AND_ATTACHED_TO_DOM:function(e){return t.onVSRendered(e)},VS_SPAWNED_AND_ATTACHED_TO_PARENT:function(e){return t.onVSRendered(e)},READY_FOR_VS_DETRITUS_COLLECT:function(e){return t.onReadyToGC(e)},VS_NULLITY:function(){return{}}};return y.all([{},n,e])},a.initViewStream=function(){var e=this;this._source$=this._rawSource$.pipe(Object(C.map)(function(t){return e.onMapViewSource(t)}),Object(C.takeWhile)(this.notGCSTATE)),this.initAutoMergeSourceStreams(),this.updateSourceSubscription(this._source$,!0)},a.notGCSTATE=function(e){return!e.action.includes("READY_FOR_VS_DETRITUS_COLLECT")},a.eqGCSTATE=function(e){return!e.action.includes("READY_FOR_VS_DETRITUS_COLLECT")},a.notCOMPLETED=function(e){return!e.action.includes("COMPLETED")},a.notGCCOMPLETE=function(e){return!e.action.includes("GC_COMPLETE")},a.testVal=function(e){console.log("TESTING VALL IS ",e)},a.addParentStream=function(e,t){var n=this;this.parent$=e.pipe(Object(C.filter)(function(e){return void 0!==e&&void 0!==e.action}),Object(C.map)(function(e){var t=y({},e);return"EXTIRPATE_AND_READY_FOR_VS_DETRITUS_COLLECT"===t.action&&(n.disposeViewStream(t),t.action="READY_FOR_VS_DETRITUS_COLLECT"),t})),this.updateSourceSubscription(this.parent$,!1,"PARENT"),this.renderAndAttachToParent(t)},a.addChildStream=function(e){var t=this,n=e.pipe(Object(C.filter)(function(e){return void 0!==e&&void 0!==e.action}),Object(C.tap)(function(e){return t.tracer("addChildStraem do ",e)}),Object(C.map)(function(e){return e}),Object(C.finalize)(function(e){return t.onChildCompleted(n.source)}));this.updateSourceSubscription(n,!0,"CHILD")},a.onChildDisposed=function(e){},a.onChildCompleted=function(e){var t,n=(t=e,Object(r.pick)(["id","vsid"],function e(t){for(;void 0!==t.destination;)t=e(t.destination);return t}(t)));return this.tracer("onChildCompleted ",this.checker,e),this.onChildDisposed(n,e),n},a.initAutoMergeSourceStreams=function(){var e=this,t={next:this.onSubscribeToSourcesNext.bind(this),error:this.onSubscribeToSourcesError.bind(this),complete:this.onSubscribeToSourcesComplete.bind(this)},n=function(){0===(r-=1)&&(e.props.el$=void 0,e.uberSource$.complete(),e.autoSubscriber$.complete(),e.sink$.complete(),e.props=void 0,e.deleted=!0,e.tracer("completeAll",e.deleted,e.props))},r=0;this.uberSource$=new j.Subject;this.autoMergeSubject$=this.uberSource$.pipe(Object(C.mergeMap)(function(t){var o=t.observable.pipe(Object(C.filter)(function(e){return void 0!==e&&void 0!==e.action}),Object(C.map)(function(t){var n=y({},t);return n.action=t.action,e.tracer("autoMergeSubject$",n),n}));return!1===t.autoClosesBool?o:(r+=1,o.pipe(Object(C.finalize)(n)))})),this.autoSubscriber$=this.autoMergeSubject$.pipe(Object(C.filter)(function(e){return void 0!==e&&void 0!==e.action})).subscribe(t)},a.updateSourceSubscription=function(e,t,n){void 0===t&&(t=!1);var r={observable:e,autoClosesBool:t,rel:n};this.tracer("updateSourceSubscription ",this.checker,r),this.uberSource$.next(r)},a.onSubscribeToSourcesNext=function(e){var t=this;void 0===e&&(e={});var n=Object(r.defaultTo)(function(e){return t.sendExtendedStreams(e)}),o=function(e,t){if(void 0!==e[t])return t;return Object(r.compose)(r.head,Object(r.filter)(Object(r.compose)(Object(r.test)(r.__,t),function(e){return new RegExp(e)})))(Object(r.keys)(e))}(this.props.hashSourceMethods,e.action);n(this.props.hashSourceMethods[o])(e),this.tracer("onSubscribeToSourcesNext",{payload:e})},a.onSubscribeToSourcesError=function(e){void 0===e&&(e=""),console.log("ALL ERROR  ",this.constructor.name,e)},a.onSubscribeToSourcesComplete=function(){this.tracer("onSubscribeToSourcesComplete","VS_DETRITUS_COLLECT"),this.openSpigot("VS_DETRITUS_COLLECT")},a.sendExtendedStreams=function(e){this.tracer("sendExtendedStreams",e),this.openSpigot(e.action,e)},a.renderAndAttachToParent=function(e){this.openSpigot("VS_SPAWN_AND_ATTACH_TO_PARENT",e)},a.renderView=function(){this.openSpigot("VS_SPAWN")},a.renderViewAndAttachToDom=function(e,t,n){var r={node:e,type:t,attachType:n};this.openSpigot("VS_SPAWN_AND_ATTACH_TO_DOM",{attachData:r})},a.checkParentDispose=function(e){"parent"===e.from$&&this.disposeViewStream(e)},a.onBeforeDispose=function(){},a.disposeViewStream=function(e){this.onBeforeDispose(),this.openSpigot("EXTIRPATE")},a.onChildDispose=function(e){},a.onParentDisposing=function(e){this.openSpigot("EXTIRPATE")},a.onReadyToGC=function(e){var t=void 0!==e.from$&&"internal"===e.from$;this.tracer("onReadyToGC",t,e)},a.openSpigot=function(e,t){if(void 0===t&&(t={}),void 0!==this.props){this.props.action=e;var n=Object(r.mergeRight)(this.props,t);this.sink$.next(Object.freeze(n))}},e.isDevMode=function(){return!0===Object(r.path)(["Spyne","config","debug"],window)},a.setAttachData=function(t,n){var o,i=this;return{node:this.props.el,type:"ViewStreamObservable",attachType:t,query:(o=i.props.el.querySelector(n),!0===e.isDevMode()&&Object(r.is)(String,n)&&Object(r.isNil)(o)&&console.warn("Spyne Warning: The appendView query in "+i.props.name+", '"+n+"', appears to not exist!"),o)}},a.getParentEls=function(e,t){for(var n=function(e){return e.parentElement},r=0,o=e;r<t;)o=n(o),r++;return o},a.setAttachParentData=function(e,t,n){return t=""!==t?t:void 0,{node:this.getParentEls(this.props.el,n),type:"ViewStreamObservable",attachType:e,query:this.props.el.parentElement.querySelector(t)}},a.onMapViewSource=function(e){return void 0===e&&(e={}),this.props=Object(r.mergeRight)(this.props,e),e},a.exchangeViewsWithChild=function(e,t){this.addChildStream(e.sourceStreams.toParent$),e.addParentStream(this.sourceStreams.toChild$,t)},a.appendToDom=function(e){this.renderViewAndAttachToDom(e,"dom","appendChild")},a.prependToDom=function(e){this.renderViewAndAttachToDom(e,"dom","prependChild")},a.appendView=function(e,t){this.exchangeViewsWithChild(e,this.setAttachData("appendChild",t))},a.appendViewToParentEl=function(e,t,n){void 0===n&&(n=1),this.exchangeViewsWithChild(e,this.setAttachParentData("appendChild",t,n))},a.prependViewToParentEl=function(e,t,n){void 0===n&&(n=1),this.exchangeViewsWithChild(e,this.setAttachParentData("prependChild",t,n))},a.prependView=function(e,t){this.exchangeViewsWithChild(e,this.setAttachData("prependChild",t))},a.appendToNull=function(){var e=document.getElementById("spyne-null-views");this.renderViewAndAttachToDom(e,"dom","appendChild")},a.onVSRendered=function(e){"internal"===e.from$&&this.postRender()},a.postRender=function(){this.beforeAfterRender(),this.afterRender(),this.onRendered(),this.viewsStreamBroadcaster=new F(this.props,this.broadcastEvents.bind(this)),this.afterBroadcastEvents()},a.addTraits=function(e){var t=this;"Array"!==e.constructor.name&&(e=[e]);e.forEach(function(e){new e(t)})},a.afterBroadcastEvents=function(){var t=this;if(!0===this.isDevMode){var n=this.addActionListeners().map(function(e){return e[0]});window.setTimeout(function(){void 0!==Object(r.path)(["props","addedChannels"],t)&&e.checkIfActionsAreRegistered.bind(t)(t.props.addedChannels,n)},500)}},e.checkIfActionsAreRegistered=function(e,t){var n,o=this;if(void 0===e&&(e=[]),t.length>0){var i=(n=e.map(function(e){return window.Spyne.channels.getChannelActions(e)}),Object(r.flatten)(n));t.forEach(function(t){var n=new RegExp(t);if(Object(r.findIndex)(Object(r.test)(n),i)<0){var a=1===e.length?"from added channel":"from added dchannels";console.warn("Spyne Warning: The action, "+t+", in "+o.props.name+", does not match any of the registered actions "+a+", "+e.join(", "))}})}},a.setDataVSID=function(){this.props.el.dataset.vsid=this.props.vsid},a.beforeAfterRender=function(){this.setDataVSID(),this.props.el$=B(this.props.el)},a.downStream=function(){},a.onRendered=function(){},a.afterRender=function(){},a.broadcastEvents=function(){return[]},a.getChannel=function(e){var t=this;return Object(r.ifElse)(function(e){return c().includes(e)},function(e){return window.Spyne.channels.getStream(e).observer.pipe(Object(C.takeWhile)(function(e){return!0!==t.deleted}))},function(e){return console.warn("channel name "+e+" is not within "+c)})(e)},a.addChannel=function(e,t,n){var o=this;void 0===t&&(t=!1),void 0===n&&(n=!1);var i=!0===t?this.$dirs.CI:this.$dirs.I,a=Object(r.path)(["srcElement","isLocalEvent"]),s=Object(r.path)(["srcElement","vsid"]),c=this.getChannel(e).pipe(Object(C.map)(function(e){var t=Object(r.defaultTo)({},Object(r.clone)(e));return y({$dir:i},t)}),Object(C.filter)(function(e){var t=s(e);return!0!==a(e)||t===o.props.vsid}));this.updateSourceSubscription(c,!1),this.props.addedChannels.push(e)},a.checkIfChannelExists=function(e){var t=void 0!==window.Spyne.channels.map.get(e);return!0!==t&&console.warn("SPYNE WARNING: The ChannelPayload from "+this.props.name+", has been sent to a channel, "+e+", that has not been registered!"),t},a.sendInfoToChannel=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n="VIEWSTREAM_EVENT");var o={payload:t,action:n};if(o.srcElement=Object(r.compose)(Object(r.pick)(["id","vsid","class","tagName"]),Object(r.prop)("props"))(this),!0===this.checkIfChannelExists(e)){var i=Object(j.of)(o);return new W(e,i,o)}},a.tracer=function(){this.sendLifecycleMethod.apply(this,arguments)},a.sendLifecycleMethodInactive=function(){},a.sendLifecycleMethodActive=function(e,t){var n="VS_DETRITUS_COLLECT"===t;!0===Object(r.where)({from$:Object(r.equals)("internal"),action:Object(r.equals)("VS_SPAWNED_AND_ATTACHED_TO_PARENT")},t)?this.sendInfoToChannel("CHANNEL_LIFECYCLE",{action:"CHANNEL_LIFECYCLE_RENDERED_EVENT"},"CHANNEL_LIFECYCLE_RENDERED_EVENT"):!0===n&&this.sendInfoToChannel("CHANNEL_LIFECYCLE",{action:"CHANNEL_LIFECYCLE_DISPOSED_EVENT"},"CHANNEL_LIFECYCLE_DISPOSED_EVENT")},a.createActionFilter=function(e,t){return new k(e,t)},a.isLocalEvent=function(e){return void 0!==Object(r.path)(["srcElement","el"],e)&&this.props.el.contains(e.srcElement.el)},a.addMixins=function(){var e=v();this.createId=e.createId},t=e,(n=[{key:"source$",get:function(){return this._source$}},{key:"attributesArray",get:function(){return["accept","accept-charset","accesskey","action","align","allow","alt","async","autocapitalize","autocomplete","autofocus","autoplay","bgcolor","border","buffered","challenge","charset","checked","cite","class","code","codebase","color","cols","colspan","content","contenteditable","contextmenu","controls","coords","crossorigin","csp","dataset","datetime","decoding","default","defer","dir","dirname","disabled","download","draggable","dropzone","enctype","for","form","formaction","headers","height","hidden","high","href","hreflang","http-equiv","icon","id","importance","integrity","ismap","itemprop","keytype","kind","label","lang","language","lazyload","list","loop","low","manifest","max","maxlength","minlength","media","method","min","multiple","muted","name","novalidate","open","optimum","pattern","ping","placeholder","poster","preload","radiogroup","readonly","referrerpolicy","rel","required","reversed","rows","rowspan","sandbox","scope","scoped","selected","shape","size","sizes","slot","span","spellcheck","src","srcdoc","srclang","srcset","start","step","style","summary","tabindex","target","title","translate","type","usemap","value","width","wrap"]}}])&&z(t.prototype,n),i&&z(t,i),e}(),Q=function(){function e(t){var n=String(t.props.name),o=n+"_ROUTE_UPDATER";return Object(r.curry)(e.createTemporaryViewStreamObj)({id:o,name:n})}return e.createTemporaryViewStreamObj=function(e,t){var n=e.name,r=e.id,o=t,i=new K({id:r,name:n,data:t});i.onRendered=function(){i.sendInfoToChannel("CHANNEL_ROUTE",o)},i.afterBroadcastEvents=function(){i.disposeViewStream()},i.appendToNull()},e}();function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Z=n(0).map,J=function(){function e(e,t){var n=this;void 0===t&&(t={}),this.addRegisteredActions.bind(this),this.createChannelActionsObj(e,t.extendedActionsArr),t.name=e,this.props=t,this.props.isProxy=void 0!==this.props.isProxy&&this.props.isProxy,this.props.sendCachedPayload=void 0!==this.props.sendCachedPayload&&this.props.sendCachedPayload,this.sendPayloadToRouteChannel=new Q(this),this.createChannelActionMethods(),this.streamsController=window.Spyne.channels;var r=this.getMainObserver();this.observer$=this.props.observer=r,this.streamsController.getStream("DISPATCHER").subscribe(function(e){return n.onReceivedObservable(e)})}var t,n,o,i=e.prototype;return i.getMainObserver=function(){return!0===this.streamsController.testStream(this.props.name)?this.streamsController.getProxySubject(this.props.name,this.props.sendCachedPayload):!0===this.props.sendCachedPayload?new j.ReplaySubject(1):new j.Subject},i.onChannelInitialized=function(){},i.onRegistered=function(){},i.checkForTraits=function(){var e=this;void 0!==this.props.traits&&function(t){"Array"!==t.constructor.name&&(t=[t]);t.forEach(function(t){new t(e)})}(this.props.traits)},i.initializeStream=function(){this.checkForTraits(),this.onChannelInitialized(),this.onRegistered()},i.setTrace=function(e){},i.createChannelActionsObj=function(e,t){void 0===t&&(t=[]);var n=Object(r.ifElse)(Object(r.is)(String),r.identity,r.head),o=t.concat(this.addRegisteredActions(e)),i=Z(n,o),a=Object(r.mergeAll)(Object(r.chain)(function(e){return Object(r.objOf)(e,e)},i));this.channelActions=a},i.createChannelActionMethods=function(){var e=this,t=Object(r.ifElse)(Object(r.is)(String),r.identity,r.head),n=Object(r.ifElse)(Object(r.is)(String),Object(r.always)("onViewStreamInfo"),function(t){var n=Object(r.view)(Object(r.lensIndex)(1),t);return!0==("function"==typeof e[n])?e[n].bind(e):console.warn('"'+e.props.name+'", REQUIRES THE FOLLOWING METHOD '+n+" FOR ACTION, "+t[0]),n});this.channelActionMethods=Object(r.fromPairs)(Z(function(e){return[t(e),n(e)]},this.addRegisteredActions()))},i.addRegisteredActions=function(){return[]},i.onReceivedObservable=function(e){this.onIncomingObservable(e)},i.getActionMethodForObservable=function(e){var t=this.onViewStreamInfo.bind(this),n=Object(r.path)(["data","action"],e),o=Object(r.prop)(n,this.channelActionMethods),i=t;void 0!==o&&"onViewStreamInfo"!==o&&(!0===("function"==typeof this[o])&&(i=this[o].bind(this)));return i},i.onIncomingObservable=function(e){var t=this,n=Object(r.equals)(e.name,this.props.name),o=e.data,i=o.action,a=o.payload,s=o.srcElement,c=function(t){return{props:function(){return t=e.data,Object(r.mergeAll)([t,{action:Object(r.prop)("action",t)},Object(r.prop)("payload",t),Object(r.prop)("srcElement",t)]);var t},action:i,payload:a,srcElement:s,event:t}};return!0===n?function(e){return e.observable.pipe(Object(C.map)(c)).subscribe(t.getActionMethodForObservable(e))}(e):void 0},i.onViewStreamInfo=function(e){},i.sendChannelPayload=function(e,t,n,r,o){void 0===n&&(n={}),void 0===r&&(r={}),void 0===o&&(o=this.observer$);var i=new m(this.props.name,e,t,n,r);o.next(i)},i.getChannel=function(e,t){var n=this;return Object(r.ifElse)(function(e){return c().includes(e)},function(e){var r=n.streamsController.getStream(e).observer;return void 0!==t?r.pipe(Object(C.filter)(t)):r},function(e){return console.warn("channel name "+e+" is not within "+c)})(e)},t=e,(n=[{key:"isProxy",get:function(){return this.props.isProxy}},{key:"channelName",get:function(){return this.props.name}},{key:"observer",get:function(){return this.observer$}}])&&X(t.prototype,n),o&&X(t,o),e}(),ee=function(){function e(){this.checkIfObjIsNotEmptyOrNil=e.checkIfObjIsNotEmptyOrNil.bind(this)}return e.checkIfObjIsNotEmptyOrNil=function(e){var t=Object(r.compose)(Object(r.complement)(r.isEmpty),r.head,r.values),n=Object(r.compose)(Object(r.complement)(r.isNil),r.head,r.values);return Object(r.allPass)([t,n])(e)},e.checkIfParamValueMatchesRegex=function(e,t){var n=Object(r.reject)(Object(r.equals)("routeName")),o=Object(r.compose)(n,r.keys),i=Object(r.compose)(Object(r.find)(function(t){return Object(r.test)(new RegExp(t),e)}),o)(t);return Object(r.is)(String,i)&&(t=Object(r.assoc)(e,Object(r.prop)(i,t),t)),t},e.formatStrAsWindowLocation=function(e){return{hash:e,search:e,pathname:e}},e.getLocationStrByType=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=window.location);var o={slash:"pathname",query:"search",hash:"hash"}[!0===t?"hash":e];return Object(r.prop)(o,n).replace(/^(\/)?(#)?(\/)?(.*)$/,"$4")},e.createRouteArrayFromParams=function(e,t,n,o){var i=this;void 0===n&&(n="slash");var a=[];return function t(n){var s={},c=n.routeName,u=void 0!==e[c]?e[c]:Object(r.prop)(c,o),d=typeof n[u];"string"===d?u=n[u]:"undefined"===d&&(n=i.checkIfParamValueMatchesRegex(u,n)),s[c]=u,i.checkIfObjIsNotEmptyOrNil(s)&&a.push(s);var p=Object(r.is)(Object,n),h=Object(r.has)(u,n),l=Object(r.has)("routePath",n);if(!0===(h&&p)){var f=n[u];Object(r.has)("routePath",f)&&t(f.routePath)}else!0===l&&void 0!==u&&t(n.routePath)}(t),a},e.createSlashString=function(e){var t=Object(r.reject)(r.isNil),n=Object(r.when)(Object(r.complement)(r.isNil,r.__),Object(r.join)("/"));return Object(r.compose)(n,t,r.flatten,Object(r.map)(r.values))(e)},e.createQueryString=function(e){var t=Object(r.reject)(r.isNil),n=this.checkIfObjIsNotEmptyOrNil,o=Object(r.compose)(Object(r.join)("="),r.flatten,r.toPairs),i=Object(r.ifElse)(n,o,Object(r.always)(void 0)),a=Object(r.map)(i),s=Object(r.when)(Object(r.complement)(r.isEmpty),Object(r.concat)("?"));return Object(r.compose)(s,Object(r.join)("&"),t,a)(e)},e.checkPayloadForRegexOverrides=function(e,t,n){void 0===n&&(n="Value");var o=Object(r.compose)(function(e){return Object(r.prop)(""+e+n,t)},r.head,r.keys);return Object(r.map)(function(e){var t=o(e);return void 0!==t?Object(r.assoc)(Object(r.compose)(r.head,r.keys)(e),t,e):e},e)},e.convertParamsToRoute=function(t,n,r,o){void 0===n&&(n=window.Spyne.config.channels.ROUTE);var i=void 0!==r?r:n.type,a=n.isHash,s=n.routes.routePath,c=void 0!==o?o:this.getLocationStrByType(i,a),u=this.convertRouteToParams(c,n,i).routeData,d=this.createRouteArrayFromParams(t,s,i,u);return d=e.checkPayloadForRegexOverrides(d,t),"query"===i?this.createQueryString(d):this.createSlashString(d)},e.findIndexOfMatchedStringOrRegex=function(e,t){var n=Object(r.replace)(/^$/,"^$"),o=Object(r.either)(Object(r.propEq)("str",e),Object(r.compose)(Object(r.test)(r.__,e),Object(r.prop)("re")));return Object(r.compose)(Object(r.findLastIndex)(Object(r.equals)(!0)),Object(r.map)(o),Object(r.map)(function(e){var t;return{str:e,re:(t=e,new RegExp(t))}}),Object(r.map)(n))(t)},e.checkIfValueShouldMapToParam=function(t,n,o){var i=Object(r.compose)(Object(r.map)(r.last),Object(r.map)(Object(r.filter)(Object(r.is)(String))),r.toPairs)(t),a=e.findIndexOfMatchedStringOrRegex(n,i),s=n;if(a>=0){var c=i[a],u=Object(r.invert)(t),d=Object(r.compose)(r.head,Object(r.defaultTo)([]),Object(r.prop)(c))(u);!0===/^(\w*)$/.test(d)&&!0===Object(r.is)(String,d)&&(s=d)}return s},e.createArrFromSlashStr=function(e){return e.replace(/^([\/])?(.*)$/,"$2").split("/")},e.convertSlashRouteStrToParamsObj=function(e,t,n){var o=this,i=t,a=this.createArrFromSlashStr(t),s=[],c=[],u=e;Object(r.reduce)(function(e,t){var i=o.checkIfValueShouldMapToParam(u,t,n);void 0!==(u=o.checkIfParamValueMatchesRegex(t,u))&&(s.push(u.routeName),c.push(i));var a=[t,"routePath"],d=Object(r.path)(a,u),p=Object(r.path)(["routePath"],u);void 0!==d?u=d:void 0!==p&&(u=p)},0,a);var d=Object(r.zipObj)(s,c),p=this.getLastArrVal(s);return{paths:s,pathInnermost:p,routeData:d,routeValue:i}},e.getLastArrVal=function(e){var t;return t=e,void 0!==Object(r.last)(t)?Object(r.last)(t):""},e.createDefaultParamFromEmptyStr=function(e,t){var n={};return n[e.routeName]=this.checkIfValueShouldMapToParam(e,t),n},e.convertQueryStrToParams=function(e,t,n){var o=t,i=t.replace(/^([?])?(.*)$/,"$2"),a=Object(r.compose)(Object(r.map)(Object(r.split)("=")),Object(r.split)("&"))(i),s=Object(r.fromPairs)(a),c=Object(r.map)(r.head,a);return!0===Object(r.isEmpty)(t)&&(s=this.createDefaultParamFromEmptyStr(e,t,n),c=Object(r.keys)(s)),{paths:c,pathInnermost:this.getLastArrVal(c),routeData:s,routeValue:o}},e.convertRouteToParams=function(e,t,n){if(void 0===t)return{};var o=void 0!==n?n:t.type,i=Object(r.defaultTo)({},Object(r.prop)("regexTokens",t)),a=t.routes.routePath;return"query"===o?this.convertQueryStrToParams(a,e):this.convertSlashRouteStrToParamsObj(a,e,i)},e}(),te=function(){function e(){this.createPopStateStream=e.createPopStateStream.bind(this)}return e.createPopStateStream=function(e){Object(j.fromEventPattern)(function(e){window.onpopstate=e},function(){window.onpopstate=function(){}}).subscribe(e)},e.getLastArrVal=function(e){var t;return t=e,void 0!==Object(r.last)(t)?Object(r.last)(t):""},e.compareRouteKeywords=function(e,t){void 0===e&&(e={});var n=function(e,t){return void 0!==t?Object(r.pick)(t,e):e},o=n(e,t);return{pickValues:n,compare:function(e,t){void 0===e&&(e={});var i=n(e,t),a=function(e){return Object(r.compose)(r.keys,Object(r.filter)(Object(r.propEq)(e,!0)))},s=Object(r.compose)(Object(r.map)(function(e){var t=Object(r.prop)(e,o),n=Object(r.prop)(e,i),a=Object(r.equals)(t,n),s=void 0!==t,c=void 0!==n,u=!a,d=!1===s&&!0===c,p=!0===s&&!1===c,h={};return h[e]={same:a,changed:u,added:d,removed:p,previousExists:s,nextExists:c},h}),r.uniq,Object(r.chain)(r.keys))([o,i]),c=Object(r.chain)(a("changed"),s),u=Object(r.chain)(a("added"),s),d=Object(r.chain)(a("removed"),s);return o=i,{pathsAdded:u,pathsRemoved:d,pathsChanged:c}},getComparer:function(){return o}}},e.getRouteArrData=function(t,n){var o=Object(r.filter)(Object(r.includes)(r.__,t),n);return{paths:o,pathInnermost:e.getLastArrVal(o)}},e.flattenConfigObject=function(e){return Object(r.values)(Object(r.fromPairs)(function e(t){return Object(r.chain)(function(t){var n=t[0],o=t[1];return"[object Object]"===Object.prototype.toString.call(o)?Object(r.map)(function(e){var t=e[0],r=e[1];return[n+"."+t,r]},e(o)):[[n,o]]},Object(r.toPairs)(t))}(e)))},e.getLocationData=function(){return Object(r.pickAll)(["href","origin","protocol","host","hostname","port","pathname","search","hash"],window.location)},e}();var ne=n(0).filter,re=n(0).mergeRight,oe=function(e){var t,n;function o(t,n){var r;return void 0===t&&(t="CHANNEL_ROUTE"),void 0===n&&(n={}),n.sendCachedPayload=!0,(r=e.call(this,"CHANNEL_ROUTE",n)||this).createChannelActionsObj(),r.routeConfigJson=r.getRouteConfig(),r.bindStaticMethods(),r.navToStream$=new j.ReplaySubject(1),r.observer$=r.navToStream$.pipe(Object(C.map)(function(e){return r.onMapNext(e)})),r.compareRouteKeywords=te.compareRouteKeywords(),r}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=o.prototype;return i.checkConfigForHash=function(){!0===("hash"===window.Spyne.config.channels.ROUTE.type)&&(window.Spyne.config.channels.ROUTE.type="slash",window.Spyne.config.channels.ROUTE.isHash=!0)},i.onRegistered=function(){this.checkConfigForHash(),this.initStream()},i.createChannelActionsObj=function(){var e=this.addRegisteredActions(),t=Object(r.mergeAll)(Object(r.chain)(function(e){return Object(r.objOf)(e,e)},e));this.channelActions=t},i.addRegisteredActions=function(){return["CHANNEL_ROUTE_DEEPLINK_EVENT","CHANNEL_ROUTE_CHANGE_EVENT"]},i.getRouteConfig=function(){var e=window.Spyne.config,t=Object(r.path)(["channels","ROUTE"],e);"query"===t.type&&(t.isHash=!1);var n=te.flattenConfigObject(t.routes);return t.paramsArr=n,t},i.initStream=function(){this.firstLoadStream$=new j.ReplaySubject(1),this.onIncomingDomEvent(void 0,this.routeConfigJson,"CHANNEL_ROUTE_DEEPLINK_EVENT"),te.createPopStateStream(this.onIncomingDomEvent.bind(this)),this.observer$=Object(j.merge)(this.firstLoadStream$,this.navToStream$)},i.onMapNext=function(e,t){return void 0===t&&(t=!1),console.log("MAP NEXT ",{firstLoaded:t,data:e}),e.action="CHANNEL_ROUTE_CHANGE_EVENT",e},o.removeSSID=function(e){var t=Object(r.lensProp)(["routeData"]);return Object(r.over)(t,Object(r.omit)(["vsid"]))(e)},o.onIncomingDomEvent=function(e,t,n){void 0===t&&(t=this.routeConfigJson);var o=void 0!==n?n:this.channelActions.CHANNEL_ROUTE_CHANGE_EVENT,i=Object(r.path)(["state","routeCount"],e),a=!0===Object(r.is)(Number,i),s=this.getDataFromString(t,a);!0===a&&(s.routeCount=i);var c=this.compareRouteKeywords.compare(s.routeData,s.paths);s=re(s,c),this.sendChannelPayload(o,s,void 0,void 0,this.navToStream$)},o.checkForRouteParamsOverrides=function(e){return e},o.checkForEventMethods=function(e){var t=Object(r.compose)(ne(Object(r.test)(/^(event)([A-Z].*)([A-Z].*)$/gm)),r.keys,Object(r.prop)("payload"))(e);if(t.length>=1){var n=Object(r.prop)("event",e);if(void 0!==n){var o=Object(r.replace)(/^(event)([A-Z])(.*)([A-Z].*)$/gm,function(e,t,n,r,o){return String(n).toLowerCase()+r+o});t.forEach(function(e){var t=o(e);void 0!==n[t]&&n[t]()})}}return e},i.onViewStreamInfo=function(e){var t=this.channelActions.CHANNEL_ROUTE_CHANGE_EVENT;o.checkForEventMethods(e);var n=this.getDataFromParams(e),i=Object(r.prop)("srcElement",e),a=Object(r.prop)("event",e),s=!n.isHidden,c=this.compareRouteKeywords.compare(n.routeData,n.paths);n=re(n,c),this.sendRouteStream(n,s),n=o.removeSSID(n),this.sendChannelPayload(t,n,i,a,this.navToStream$)},o.checkAndConvertStrWithRegexTokens=function(e,t){return Object(r.keys)(t)},i.sendRouteStream=function(e,t){void 0===t&&(t=!0),!0===t&&this.setWindowLocation(e)},o.getRouteState=function(){return"CHANNEL_ROUTE_CHANGE_EVENT"},o.getIsDeepLinkBool=function(){return 0===this._routeCount},o.getRouteCount=function(e){return void 0===e&&(e=!1),void 0===this._routeCount?(this._routeCount=0,this._routeCount):(!1===e&&(this._routeCount+=1),this._routeCount)},o.getExtraPayloadParams=function(e,t){return void 0===e&&(e=this.routeConfigJson),void 0===t&&(t=!1),{routeCount:this.getRouteCount(t),isDeepLink:this.getIsDeepLinkBool(),isHash:e.isHash,isHidden:e.isHidden,routeType:e.type}},o.getDataFromParams=function(e,t){void 0===t&&(t=this.routeConfigJson);var n=Object(r.prop)("payload",e),o=this.getRouteStrFromParams(n,t),i=function(e,n){return Object(r.defaultTo)(n,Object(r.prop)(e,t))},a=i("type","slash"),s=i("isHash",!1),c=ee.formatStrAsWindowLocation(o),u=this.getDataFromLocationStr(a,s,c),d=u.pathInnermost,p=u.paths;n=re(u.routeData,n);var h=this.getExtraPayloadParams(t),l=h.routeCount;return{isDeepLink:h.isDeepLink,routeCount:l,pathInnermost:d,paths:p,routeData:n,routeValue:o,isHash:h.isHash,isHidden:h.isHidden,routeType:h.routeType}},o.getDataFromString=function(e,t){void 0===e&&(e=this.routeConfigJson),void 0===t&&(t=!1);var n=e.type,r=!0===e.isHash,i=ee.getLocationStrByType(n,r),a=o.getParamsFromRouteStr(i,e,n),s=a.paths,c=a.pathInnermost,u=a.routeData,d=a.routeValue,p=this.getExtraPayloadParams(e,t),h=p.routeCount,l=p.isDeepLink,f=p.isHash,E=p.routeType;return{isDeepLink:l,routeCount:h,pathInnermost:c,paths:s,routeData:u,routeValue:d,isHash:f,isHidden:p.isHidden,routeType:E}},o.getDataFromLocationStr=function(e,t,n){void 0===e&&(e="slash"),void 0===t&&(t=this.routeConfigJson.isHash),void 0===n&&(n=window.location);var r=void 0!==this.routeConfigJson?this.routeConfigJson.type:e,o=ee.getLocationStrByType(r,t,n),i=this.getParamsFromRouteStr(o,this.routeConfigJson,r);return{paths:i.paths,pathInnermost:i.pathInnermost,routeData:i.routeData,routeValue:i.routeValue,action:this.getRouteState()}},o.getLocationData=function(){return Object(r.pickAll)(["href","origin","protocol","host","hostname","port","pathname","search","hash"],window.location)},o.getRouteStrFromParams=function(e,t,n){var r=void 0!==n?n:t.type;return ee.convertParamsToRoute(e,t,r)},o.getParamsFromRouteStr=function(e,t,n){var r=void 0!==n?n:t.type;return ee.convertRouteToParams(e,t,r)},i.checkEmptyRouteStr=function(e,t){void 0===t&&(t=!1);var n=Object(r.isEmpty)(e);return!0===(!0===n&&!1===t)||!0===(!0===n&&!0===t)?"/":!0===(!1===n&&!0===t)?Object(r.concat)("#",e):e},o.removeLastSlash=function(e){return e.replace(/^(.*)(\/)$/,"$1")},i.setWindowLocation=function(e){var t=e.isHash,n=e.routeValue;n=this.checkEmptyRouteStr(n,t);var i=e.routeCount;if(!0===t){n=o.removeLastSlash(window.location.pathname)+n,window.history.pushState({routeCount:i},"",n)}else{var a=Object(r.when)(Object(r.compose)(Object(r.complement)(Object(r.equals)("/")),r.head),Object(r.concat)("/",r.__));window.history.pushState({routeCount:i},"",a(n))}},i.getWindowLocation=function(){return window.location.pathname},i.bindStaticMethods=function(){this.getIsDeepLinkBool=o.getIsDeepLinkBool.bind(this),this.getDataFromLocationStr=o.getDataFromLocationStr.bind(this),this.onIncomingDomEvent=o.onIncomingDomEvent.bind(this),this.getDataFromString=o.getDataFromString.bind(this),this.getParamsFromRouteStr=o.getParamsFromRouteStr.bind(this),this.getLocationData=o.getLocationData.bind(this),this.getRouteState=o.getRouteState.bind(this),this.getDataFromParams=o.getDataFromParams.bind(this),this.getRouteCount=o.getRouteCount.bind(this),this.getExtraPayloadParams=o.getExtraPayloadParams.bind(this);var e=Object(r.curryN)(3,o.getRouteStrFromParams);this.getRouteStrFromParams=e(r.__,this.routeConfigJson,this.routeConfigJson.type)},o}(J);var ie=function(e){var t,n;function o(t,n){var r;return void 0===t&&(t="CHANNEL_UI"),void 0===n&&(n={}),n.sendCachedPayload=!1,(r=e.call(this,t,n)||this).keyEventsLoaded=!1,r.keyCodeArr=[],r}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=o.prototype;return i.addRegisteredActions=function(){return["CHANNEL_UI_ANIMATIONEND_EVENT","CHANNEL_UI_ANIMATIONITERATION_EVENT","CHANNEL_UI_ANIMATIONSTART_EVENT","CHANNEL_UI_AUDIOEND_EVENT","CHANNEL_UI_AUDIOPROCESS_EVENT","CHANNEL_UI_AUDIOSTART_EVENT","CHANNEL_UI_BLUR_EVENT","CHANNEL_UI_CACHED_EVENT","CHANNEL_UI_CANPLAYTHROUGH_EVENT","CHANNEL_UI_CANPLAY_EVENT","CHANNEL_UI_CHANGE_EVENT","CHANNEL_UI_CHECKBOXSTATECHANGE_EVENT","CHANNEL_UI_CLICK_EVENT","CHANNEL_UI_COMPLETE_EVENT","CHANNEL_UI_COPY_EVENT","CHANNEL_UI_CUT_EVENT","CHANNEL_UI_DBLCLICK_EVENT","CHANNEL_UI_DURATIONCHANGE_EVENT","CHANNEL_UI_EMPTIED_EVENT","CHANNEL_UI_ENDED_EVENT","CHANNEL_UI_EVENT","CHANNEL_UI_FOCUSIN_EVENT","CHANNEL_UI_FOCUSOUT_EVENT","CHANNEL_UI_FOCUS_EVENT","CHANNEL_UI_HASHCHANGE_EVENT","CHANNEL_UI_INPUT_EVENT","CHANNEL_UI_KEYDOWN_EVENT","CHANNEL_UI_KEYPRESS_EVENT","CHANNEL_UI_KEYUP_EVENT","CHANNEL_UI_LOADEDDATA_EVENT","CHANNEL_UI_LOADEDMETADATA_EVENT","CHANNEL_UI_MOUSEDOWN_EVENT","CHANNEL_UI_MOUSEENTER_EVENT","CHANNEL_UI_MOUSELEAVE_EVENT","CHANNEL_UI_MOUSEMOVE_EVENT","CHANNEL_UI_MOUSEOUT_EVENT","CHANNEL_UI_MOUSEOVER_EVENT","CHANNEL_UI_MOUSEUP_EVENT","CHANNEL_UI_PAUSE_EVENT","CHANNEL_UI_PLAYING_EVENT","CHANNEL_UI_PLAY_EVENT","CHANNEL_UI_RADIOSTATECHANGE_EVENT","CHANNEL_UI_RATECHANGE_EVENT","CHANNEL_UI_READYSTATECHANGE_EVENT","CHANNEL_UI_SEEKED_EVENT","CHANNEL_UI_SEEKING_EVENT","CHANNEL_UI_SELECT_EVENT","CHANNEL_UI_STALLED_EVENT","CHANNEL_UI_SUBMIT_EVENT","CHANNEL_UI_SUSPEND_EVENT","CHANNEL_UI_SVGABORT_EVENT","CHANNEL_UI_SVGERROR_EVENT","CHANNEL_UI_SVGLOAD_EVENT","CHANNEL_UI_SVGRESIZE_EVENT","CHANNEL_UI_SVGSCROLL_EVENT","CHANNEL_UI_SVGUNLOAD_EVENT","CHANNEL_UI_SVGZOOM_EVENT","CHANNEL_UI_TIMEUPDATE_EVENT","CHANNEL_UI_TOUCHCANCEL_EVENT","CHANNEL_UI_TOUCHEND_EVENT","CHANNEL_UI_TOUCHMOVE_EVENT","CHANNEL_UI_TOUCHSTART_EVENT","CHANNEL_UI_TRANSITIONEND_EVENT","CHANNEL_UI_VALUECHANGE_EVENT","CHANNEL_UI_VOLUMECHANGE_EVENT","CHANNEL_UI_WAITING_EVENT"]},i.loadKeyStream=function(){var e=this,t=j.Observable.fromEvent(document,"keyup");this.keyPresses$=t.groupBy(function(e){return e.keyCode}).mergeAll().filter(function(t){return e.keyCodeArr.indexOf(t.keyCode)>=0}).repeat().subscribe(this.onKeyPressed.bind(this))},i.addKeyEvent=function(e){!1===this.keyEventsLoaded&&this.loadKeyStream(),this.keyEventsLoaded=!0,this.registerKey(e)},i.registerKey=function(e){this.keyCodeArr.push(e)},i.onKeyPressed=function(e){console.log("key is ",e)},o.removeSSID=function(e){var t=Object(r.lensProp)(["payload"]);return Object(r.over)(t,Object(r.omit)(["vsid"]))(e)},i.onIncomingObservable=function(e){var t=this,n=Object(r.equals)(e.name,this.props.name);e.data=o.removeSSID(e.data);var i=e.data,a=i.payload,s=i.srcElement,c=function(e){return{payload:a,srcElement:s,event:e}};return!0===n?function(e){return e.observable.pipe(Object(C.map)(c)).subscribe(t.onUIEvent.bind(t))}(e):void 0},i.getActionState=function(e){var t=Object(r.path)(["event","type"]),n=Object(r.path)(["event","typeOverRide"]),o=Object(r.compose)(r.toUpper,Object(r.either)(n,t))(e);return void 0!==o?"CHANNEL_UI_"+o+"_EVENT":"CHANNEL_UI"},o.checkForEventMethods=function(e){var t=Object(r.compose)(Object(r.filter)(Object(r.test)(/^(event)([A-Z].*)([A-Z].*)$/gm)),r.keys,Object(r.prop)("payload"))(e);if(t.length>=1){var n=Object(r.prop)("event",e);if(void 0!==n){var o=Object(r.replace)(/^(event)([A-Z])(.*)([A-Z].*)$/gm,function(e,t,n,r,o){return String(n).toLowerCase()+r+o});t.forEach(function(e){var t=o(e);void 0!==n[t]&&"function"==typeof n[t]&&n[t]()})}}return e},i.onUIEvent=function(e){o.checkForEventMethods(e),e.action=this.getActionState(e);var t=e.action,n=e.payload,r=e.srcElement,i=e.event;this.sendChannelPayload(t,n,r,i)},o}(J),ae=function(){function e(){this.createDomObservableFromEvent=e.createDomObservableFromEvent.bind(this)}return e.createDomObservableFromEvent=function(e,t,n){void 0===n&&(n=!0);return t=void 0===t?function(e){return e}:t,Object(j.fromEventPattern)(function(t){return window.addEventListener(e,t,{passive:n})},function(){window[e]=function(e){return e}}).pipe(Object(C.map)(t))},e.createMediaQuery=function(e){var t=window.matchMedia(e);return this.checkIfValidMediaQuery(t,e),t},e.checkIfValidMediaQuery=function(e,t){var n=function(e){return e.replace(/\s+/gm,"")},r=void 0!==e.matches&&n(e.media)===n(t);return!1===r&&function(t){console.warn('Spyne Info: the following query string, "'+t+'", has been optimized to "'+e.media+'" by the browser and may not be a valid Media Query item!')}(t),r},e.createMediaQueryHandler=function(e,t){var n,r=function(e){return function(t){return t.mediaQueryName=e,t}}(t),o=(n=e,{addHandler:function(e){n.addListener(e)},removeHandler:function(e){n.onchange=function(){}}});return new j.fromEventPattern(o.addHandler,o.removeHandler).pipe(Object(C.map)(r))},e.createMergedObsFromObj=function(t){var n=t.mediqQueries,o=[];return Object(r.mapObjIndexed)(function(t,n,r){var i=e.createMediaQuery(t);o.push(e.createMediaQueryHandler(i,n))},n),o},e}();var se=n(0).map,ce=function(e){var t,n;function o(t){var n;return void 0===t&&(t="CHANNEL_WINDOW"),(n=e.call(this,t)||this).bindStaticMethods(),n}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=o.prototype;return i.initializeStream=function(){var e=this;this.domChannelConfig=window.Spyne.config.channels.WINDOW,this.currentScrollY=window.scrollY;var t=this.getActiveObservables();j.merge.apply(void 0,t).subscribe(function(t){var n=t.action,r=t.payload,o=t.srcElement,i=t.event;e.sendChannelPayload(n,r,o,i)})},o.getScrollMapFn=function(e){var t=this.channelActions.CHANNEL_WINDOW_SCROLL_EVENT,n=window.scrollY,r=this.currentScrollY-n,o=r>=0?"up":"down";return this.currentScrollY=n,{action:t,payload:{scrollY:n,scrollDistance:r,scrollDir:o},srcElement:e.srcElement,scrollDistance:r,event:e}},o.getMouseWheelMapFn=function(e){return{action:this.channelActions.CHANNEL_WINDOW_MOUSEWHEEL_EVENT,payload:{scrollDir:e.deltaY<=0?"up":"down",deltaX:e.deltaX,deltaY:e.deltaY,deltaZ:e.deltaZ},srcElement:e.srcElement,event:e}},o.createCurriedGenericEvent=function(e){var t="CHANNEL_WINDOW_"+e.toUpperCase()+"_EVENT";return Object(r.curry)(o.mapGenericEvent)(t)},o.mapGenericEvent=function(e,t){return{action:e,payload:t,srcElement:t.srcElement,event:t}},o.getResizeMapFn=function(e){return{action:this.channelActions.CHANNEL_WINDOW_RESIZE_EVENT,payload:Object(r.pick)(["innerWidth","innerHeight","outerWidth","outerHeight"],window),srcElement:e.srcElement,event:e}},o.getOrientationMapFn=function(e){var t=this.channelActions.CHANNEL_WINDOW_ORIENTATION_EVENT,n=window.matchMedia("(orientation: portrait)").matches,o=Object(r.pick)(["innerWidth","innerHeight","outerWidth","outerHeight"],window);return o.orientation=!0===n?"portrait":"landscape",{action:t,payload:o,srcElement:e.srcElement,event:e}},i.getMediaQueryMapFn=function(e){return{action:this.channelActions.CHANNEL_WINDOW_MEDIA_QUERY_EVENT,payload:Object(r.pick)(["matches","media","mediaQueryName"],e),srcElement:e.srcElement,event:e}},i.createMouseWheelObservable=function(e){var t=e.debounceMSTimeForScroll;return ae.createDomObservableFromEvent("mousewheel",o.getMouseWheelMapFn.bind(this)).debounceTime(t)},i.createScrollObservable=function(e){var t=e.debounceMSTimeForScroll;return ae.createDomObservableFromEvent("scroll",o.getScrollMapFn.bind(this)).pipe(Object(C.map)(function(e){if(Object(r.pathEq)(["Spyne","config","scrollLock"],!0)(window)){var t=window.Spyne.config.scrollLockX,n=window.Spyne.config.scrollLockY;window.scrollTo(t,n)}return e}),Object(C.debounceTime)(t),Object(C.skipWhile)(function(e){return 0===e.scrollDistance}))},i.createOrientationObservable=function(e){return ae.createDomObservableFromEvent("orientationchange",o.getOrientationMapFn.bind(this))},i.createResizeObservable=function(e){var t=e.debounceMSTimeForResize;return ae.createDomObservableFromEvent("resize",o.getResizeMapFn.bind(this)).pipe(Object(C.debounceTime)(t))},i.getEventsFromConfig=function(e){void 0===e&&(e=this.domChannelConfig);var t=e.events;return se(function(e){var t=o.createCurriedGenericEvent(e);return ae.createDomObservableFromEvent(e,t)},t)},i.getActiveObservables=function(e){void 0===e&&(e=this.domChannelConfig);var t,n,o,i=[];e.listenForMediaQueries=(t=e.mediqQueries,n=Object(r.compose)(Object(r.complement)(r.isEmpty),r.head,r.values),o=Object(r.compose)(Object(r.complement)(r.isNil),r.head,r.values),Object(r.allPass)([n,o])(t));var a={listenForResize:this.createResizeObservable.bind(this),listenForOrientation:this.createOrientationObservable.bind(this),listenForScroll:this.createScrollObservable.bind(this),listenForMouseWheel:this.createMouseWheelObservable.bind(this)};Object(r.mapObjIndexed)(function(t,n,r){e[n]&&i.push(t(e))},a),this.checkForMediaQueries(e.listenForMediaQueries);var s=this.getEventsFromConfig(e);return i=i.concat(s)},i.checkForMediaQueries=function(e){var t=this;!0===e&&this.getMediaQueryObservable(this.domChannelConfig).subscribe(function(e){var n=e.action,r=e.payload,o=e.srcElement,i=e.event;t.sendChannelPayload(n,r,o,i,t.observer$)})},i.getMediaQueryObservable=function(e){var t=this.createMergedObsFromObj(e);return Object(j.merge)(t[0],t[1]).pipe(Object(C.map)(this.getMediaQueryMapFn.bind(this)))},i.addRegisteredActions=function(){return["CHANNEL_WINDOW_ABORT_EVENT","CHANNEL_WINDOW_AFTERPRINT_EVENT","CHANNEL_WINDOW_ANIMATIONEND_EVENT","CHANNEL_WINDOW_ANIMATIONITERATION_EVENT","CHANNEL_WINDOW_ANIMATIONSTART_EVENT","CHANNEL_WINDOW_APPINSTALLED_EVENT","CHANNEL_WINDOW_BEFOREPRINT_EVENT","CHANNEL_WINDOW_BEFOREUNLOAD_EVENT","CHANNEL_WINDOW_BEGINEVENT_EVENT","CHANNEL_WINDOW_BLUR_EVENT","CHANNEL_WINDOW_CACHED_EVENT","CHANNEL_WINDOW_CHANGE_EVENT","CHANNEL_WINDOW_CLICK_EVENT","CHANNEL_WINDOW_CLOSE_EVENT","CHANNEL_WINDOW_COMPOSITIONEND_EVENT","CHANNEL_WINDOW_COMPOSITIONSTART_EVENT","CHANNEL_WINDOW_COMPOSITIONUPDATE_EVENT","CHANNEL_WINDOW_COPY_EVENT","CHANNEL_WINDOW_CUT_EVENT","CHANNEL_WINDOW_DEVICECHANGE_EVENT","CHANNEL_WINDOW_DEVICELIGHT_EVENT","CHANNEL_WINDOW_DEVICEMOTION_EVENT","CHANNEL_WINDOW_DEVICEORIENTATION_EVENT","CHANNEL_WINDOW_DEVICEPROXIMITY_EVENT","CHANNEL_WINDOW_DOMATTRIBUTENAMECHANGED_EVENT","CHANNEL_WINDOW_DOMATTRMODIFIED_EVENT","CHANNEL_WINDOW_DOMCHARACTERDATAMODIFIED_EVENT","CHANNEL_WINDOW_DOMCONTENTLOADED_EVENT","CHANNEL_WINDOW_DOMELEMENTNAMECHANGED_EVENT","CHANNEL_WINDOW_ERROR_EVENT","CHANNEL_WINDOW_FOCUSIN_EVENT","CHANNEL_WINDOW_FOCUS_EVENT","CHANNEL_WINDOW_FULLSCREENCHANGE_EVENT","CHANNEL_WINDOW_FULLSCREENERROR_EVENT","CHANNEL_WINDOW_LOAD_EVENT","CHANNEL_WINDOW_MEDIA_QUERY_EVENT","CHANNEL_WINDOW_MESSAGE_EVENT","CHANNEL_WINDOW_MOUSEWHEEL_EVENT","CHANNEL_WINDOW_OFFLINE_EVENT","CHANNEL_WINDOW_ONLINE_EVENT","CHANNEL_WINDOW_OPEN_EVENT","CHANNEL_WINDOW_ORIENTATION_EVENT","CHANNEL_WINDOW_PAGEHIDE_EVENT","CHANNEL_WINDOW_PAGESHOW_EVENT","CHANNEL_WINDOW_POPSTATE_EVENT","CHANNEL_WINDOW_RESET_EVENT","CHANNEL_WINDOW_RESIZE_EVENT","CHANNEL_WINDOW_SCROLL_EVENT","CHANNEL_WINDOW_SCROLL_LOCK_EVENT",["CHANNEL_WINDOW_SCROLL_LOCK_EVENT","onScrollLockEvent"],"CHANNEL_WINDOW_SUBMIT_EVENT","CHANNEL_WINDOW_TRANSITIONCANCEL_EVENT","CHANNEL_WINDOW_TRANSITIONEND_EVENT","CHANNEL_WINDOW_TRANSITIONRUN_EVENT","CHANNEL_WINDOW_TRANSITIONSTART_EVENT","CHANNEL_WINDOW_UNLOAD_EVENT","CHANNEL_WINDOW_WHEEL_EVENT"]},i.onScrollLockEvent=function(e){var t=e.props(),n=t.action,r=t.scrollLock;window.Spyne.config.scrollLock=r,!0===r&&(window.Spyne.config.scrollLockX=window.scrollX,window.Spyne.config.scrollLockY=window.scrollY),this.sendChannelPayload(n,{scrollLock:r})},i.bindStaticMethods=function(){this.createMediaQueryHandler=ae.createMediaQueryHandler.bind(this),this.createMergedObsFromObj=ae.createMergedObsFromObj.bind(this)},o}(J);var ue=function(e){var t,n;function r(t){return void 0===t&&(t={}),e.call(this,"CHANNEL_LIFECYCLE",t)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=r.prototype;return o.addRegisteredActions=function(){return["CHANNEL_LIFECYCLE_RENDERED_EVENT","CHANNEL_LIFECYCLE_DISPOSED_EVENT"]},o.onViewStreamInfo=function(e){var t=e.props(),n=(t.data,t.action),r=t.srcElement;r.action=n,this.onSendEvent(n,r)},o.onSendEvent=function(e,t){var n=this;void 0===t&&(t={});var r=this.channelActions[e],o={};window.setTimeout(function(){return n.sendChannelPayload(r,t,o,void 0)},0)},r}(J);function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var pe=function(e){var t,n;function o(t,n){var o;return void 0===n&&(n={}),n.isProxy=!0,(o=e.call(this,t,n)||this).props=n,o.subject$=new j.Subject,o.replaySub$=new j.ReplaySubject(1),o.observer$=Object(j.merge)(o.subject$,o.replaySub$),!0===(!0===Object(r.path)(["Spyne","config","debug"],window))&&o.checkIfChannelIsStillProxy(t),o}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i,a,s,c=o.prototype;return c.getMergedSubject=function(e){return void 0===e&&(e=!1),!0===e?this.replaySub$:this.subject$},c.checkIfChannelIsStillProxy=function(e){var t=e;window.setTimeout(function(){!0!==Object(r.includes)(t,window.Spyne.channels.listRegisteredChannels())&&console.warn("Spyne Warning: The channel, "+t+" does not appear to be registered!")},1e3)},i=o,(a=[{key:"replaySubject",get:function(){return this.replaySub$}},{key:"subject",get:function(){return this.subject$}}])&&de(i.prototype,a),s&&de(i,s),o}(J),he=n(0).map,le=function(){function e(){this.addMixins(),this.map=new Map,this.map.set("DISPATCHER",new j.Subject),this.listRegisteredChannels=e.listRegisteredChannels.bind(this),this.getChannelsList=e.getChannelsList.bind(this)}e.getChannelsList=function(){return Array.from(window.Spyne.channels.map,function(e,t){return{key:e[0],val:e[1].constructor.name}})},e.listRegisteredChannels=function(e){void 0===e&&(e=!1);var t=this.getChannelsList(),n=Object(r.reject)(Object(r.propEq)("val","ChannelProxy")),o=Object(r.filter)(Object(r.propEq)("val","ChannelProxy")),i=(!0===e?o:n)(t);return Object(r.pluck)(["key"],i)};var t=e.prototype;return t.listProxyChannels=function(){return this.listRegisteredChannels(!0)},t.checkForMissingChannels=function(){var e=this.getChannelsList(),t=Object(r.filter)(Object(r.propEq)("val","ChannelProxy"))(e);if(t.length>=1){var n="Spyne Warning: The following "+(1===t.length?"Channel has":"Channels have")+" not been initialized: "+Object(r.compose)(Object(r.join)(", "),he(Object(r.prop)("key")))(t);console.warn(n)}},t.init=function(){this.createMainStreams()},t.createObserver=function(e){H(e.validations,e.init),this.map.set(e.init.name,e.init.observable())},t.createMainStreams=function(){this.routeStream=new oe,this.map.set("CHANNEL_ROUTE",this.routeStream),this.uiStream=new ie,this.map.set("CHANNEL_UI",this.uiStream),this.domStream=new ce,this.map.set("CHANNEL_WINDOW",this.domStream),this.viewStreamLifecycle=new ue,this.map.set("CHANNEL_LIFECYCLE",this.viewStreamLifecycle),this.routeStream.initializeStream(),this.domStream.initializeStream()},t.addKeyEvent=function(e){this.map.get("UI").addKeyEvent(e)},t.registerStream=function(e){var t=e.channelName;this.map.set(t,e),e.initializeStream()},t.getChannelActions=function(e){return this.map.get(e).addRegisteredActions()},t.getProxySubject=function(e,t){void 0===t&&(t=!1);var n=!0===t?"replaySubject":"subject";return this.map.get(e)[n]},t.testStream=function(e){return void 0!==this.map.get(e)},t.getStream=function(e){return!1===this.testStream(e)&&this.map.set(e,new pe(e)),this.map.get(e)},t.addMixins=function(){},e}(),fe=function(){function e(e,t,n){return void 0===t&&(t=""),void 0===n&&(n=!0),this.parentContext=e,this.omittedMethods=["autoBinder","initAutoBinder","getEnhancerMethods","checkForMalformedMethods","bindParentViewStream"],this.prefix=t,!0===n&&this.autoBinder(),this.allMethodsList}var t=e.prototype;return t.initAutoBinder=function(){this.autoBinder()},t.getEnhancerMethods=function(){return i(this,this.omittedMethods)},t.checkForMalformedMethods=function(e){var t=this;if(""!==this.prefix){var n=Object(r.reject)(function(e){return 0===e.indexOf(t.prefix)},e);if(n.length>=1){var o="Spyne Warning: The following method(s) in "+this.constructor.name+' require the prefix, "'+this.prefix+'": ['+n.join(", ")+"];";console.warn(o)}}else console.warn("SPYNE WARNING: The following SpyneTrait "+this.constructor.name+" needs a prefix")},t.bindParentViewStream=function(e,t){var n=this;this.checkForMalformedMethods(e.allMethods);var o={},i=function(e,r){void 0===r&&(r=!1);var i,a=!0===r?n.constructor:n;"function"===typeof a[e]&&(o[e]=t[i=e]=a[i].bind(t))},a=Object(r.curryN)(2,i)(r.__,!0);return Object(r.map)(a,e.staticMethods),Object(r.map)(i,e.methods),o},t.autoBinder=function(){var e=this.getEnhancerMethods();return this.allMethodsList=this.bindParentViewStream(e,this.parentContext),this.allMethodsList},e}();function Ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var be=function(){function e(t,n,r){this._mapFn=e.setMapFn(t),this._url=e.setUrl(t),this._responseType=e.setResponseType(t),this._serverOptions=e.setServerOptions(t),this._subscriber=void 0!==n?n:function(e){return console.log("FETCH RETURNED ",e)},this.debug=void 0!==t.debug&&t.debug;var o={mapFn:this.mapFn,url:this.url,serverOptions:this.serverOptions,responseType:this.responseType,debug:this.debug};!0!==r&&e.startWindowFetch(o,this._subscriber)}var t,n,o;return e.startWindowFetch=function(e,t){var n=e.mapFn,r=e.url,o=e.serverOptions,i=e.responseType,a=!0===e.debug?function(e){return console.log("DEBUG FETCH :",e)}:function(){},s=Object(j.from)(window.fetch(r,o)).pipe(Object(C.tap)(a),Object(C.flatMap)(function(e){return Object(j.from)(e[i]())}),Object(C.map)(n),Object(C.publish)());s.connect(),s.subscribe(t)},e.setMapFn=function(e){return Object(r.compose)(Object(r.defaultTo)(function(e){return e}),Object(r.prop)("mapFn"))(e)},e.setUrl=function(e){var t=Object(r.prop)("url",e);return void 0===t&&console.warn("SPYNE WARNING: URL is undefined for data channel"),t},e.setResponseType=function(e){return Object(r.defaultTo)("json",Object(r.prop)("responseType",e))},e.stringifyBodyIfItExists=function(e){return Object(r.when)(Object(r.propIs)(Object,"body"),Object(r.compose)(Object(r.over)(Object(r.lensProp)("body"),JSON.stringify)))(e)},e.updateMethodWhenBodyExists=function(e){var t=Object(r.has)("body"),n=Object(r.propEq)("method","GET"),o=Object(r.allPass)([t,n]);return Object(r.when)(o,Object(r.assoc)("method","POST"))(e)},e.setServerOptions=function(t){var n=Object(r.pick)(["header","body","mode","method"],t),o=Object(r.mergeDeepRight)(e.baseOptions(),n);return o=e.updateMethodWhenBodyExists(o),o=e.stringifyBodyIfItExists(o)},e.baseOptions=function(){return{method:"GET",headers:{"Content-type":"application/json; charset=UTF-8"}}},t=e,(n=[{key:"mapFn",get:function(){return this._mapFn}},{key:"url",get:function(){return this._url}},{key:"serverOptions",get:function(){return this._serverOptions}},{key:"responseType",get:function(){return this._responseType}}])&&Ee(t.prototype,n),o&&Ee(t,o),e}();function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ve=function(e){var t,n;function o(t,n){return void 0===n&&(n={}),n.extendedActionsArr=[t+"_DATA_EVENT",[t+"_UPDATE_DATA_EVENT","onFetchUpdate"]],n.sendCachedPayload=!0,e.call(this,t,n)||this}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i,a,s,c=o.prototype;return c.onRegistered=function(){this.startFetch()},c.addRegisteredActions=function(e){var t=Object(r.compose)(Object(r.defaultTo)([]),Object(r.path)(["props","extendedActionsArr"]));return["CHANNEL_DATA_EVENT",["CHANNEL_UPDATE_DATA_EVENT","onFetchUpdate"]].concat(t(this))},c.startFetch=function(e,t){void 0===e&&(e={}),void 0===t&&(t=this.onFetchReturned.bind(this));var n=this.consolidateAllFetchProps(e);return new be(n,t)},c.onFetchUpdate=function(e){var t=this.getPropsForFetch(e);this.startFetch(t)},c.onFetchReturned=function(e){this.createChannelPayloadItem(e)},c.createChannelPayloadItem=function(e,t){void 0===t&&(t=this.props.name+"_DATA_EVENT"),this.sendChannelPayload(t,e)},c.getPropsForFetch=function(e){var t=Object(r.path)(["viewStreamInfo","payload"],e);return Object(r.pick)(["mapFn","url","header","body","mode","method","responseType","debug"],t)},c.consolidateAllFetchProps=function(e,t){void 0===t&&(t=this.props);var n=Object(r.pick)(["mapFn","url","header","body","mode","method","responseType","debug"],t),o=Object(r.reject)(r.isNil);return Object(r.compose)(o,function(e,t){return Object(r.mergeDeepRight)(e,t)})(n,e)},i=o,(a=[{key:"observer",get:function(){return this.observer$}}])&&me(i.prototype,a),s&&me(i,s),o}(J);n.d(t,"SpyneApp",function(){return Oe}),n.d(t,"ViewStreamElement",function(){return L}),n.d(t,"Channel",function(){return J}),n.d(t,"ChannelFetch",function(){return ve}),n.d(t,"ChannelsController",function(){return le}),n.d(t,"ViewStreamPayload",function(){return W}),n.d(t,"ChannelPayload",function(){return m}),n.d(t,"ChannelPayloadFilter",function(){return k}),n.d(t,"DomEl",function(){return A}),n.d(t,"ViewStream",function(){return K}),n.d(t,"ViewStreamBroadcaster",function(){return F}),n.d(t,"SpyneTrait",function(){return fe}),n.d(t,"deepMerge",function(){return y});var Oe=function(){function e(e){var t=this;void 0===e&&(e={}),this.channels=new le,this.VERSION="0.10.15",this.ViewStream=K,this.BasicView=L,this.DomEl=A,this.ViewStreamBroadcaster=F,this.ChannelsPayload=W,this.ChannelsController=le,this.ChannelsBase=J,this.ChannelPayloadItem=m,window.Spyne=this;void 0!==e&&(window.Spyne.config=y({scrollLock:!1,scrollLockX:0,scrollLockY:0,debug:!1,channels:{WINDOW:{mediqQueries:{},events:[],listenForResize:!0,listenForOrientation:!0,listenForScroll:!0,listenForMouseWheel:!1,debounceMSTimeForResize:200,debounceMSTimeForScroll:150},ROUTE:{type:"slash",isHash:!1,isHidden:!1,routes:{routePath:{routeName:"change"}}}}},e)),this.getChannelActions=function(e){return window.Spyne.channels.getChannelActions(e)},this.registerChannel=function(e){return t.channels.registerStream(e)},this.registerDataChannel=function(e){return t.channels.registerStream(e)},this.listChannels=function(){return Array.from(window.Spyne.channels.map.keys())};var n=new K({id:"spyne-null-views"});n.appendToDom(document.body),n.props.el.style.cssText="display:none; opacity:0; pointer-events:none;",this.channels.init()}return e.listChannels=function(){return Array.from(window.Spyne.channels.map.keys())},e.getChannelActions=function(e){return window.Spyne.channels.getChannelActions(e)},e.registerChannel=function(e){if(void 0!==window.Spyne)return window.Spyne.channels.registerStream(e);console.warn("Spyne has not been initialized")},e}();window.Spyne=Oe}])});