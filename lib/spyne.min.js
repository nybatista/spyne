!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("rxjs/operators"),require("rxjs"),require("ramda")):"function"==typeof define&&define.amd?define("spyne",["rxjs/operators","rxjs","ramda"],t):"object"==typeof exports?exports.spyne=t(require("rxjs/operators"),require("rxjs"),require("ramda")):e.spyne=t(e.rxjs.operators,e.rxjs,e.R)}(window,function(e,t,n){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t,n){e.exports=n(4)},function(e,t){e.exports=o;var n=Object.create,r=function(){throw new Error("Not implemented.")},i=function(){return this};function o(){}function a(e){this.value=e}function s(e){this.value=e}a.prototype=n(o.prototype),s.prototype=n(o.prototype),o.Failure=function(e){return new a(e)},o.prototype.Failure=o.Failure,o.Success=function(e){return new s(e)},o.prototype.Success=o.Success,o.fromNullable=function(e){return null!=e?new s(e):new a(e)},o.prototype.fromNullable=o.fromNullable,o.fromEither=function(e){return e.fold(o.Failure,o.Success)},o.prototype.isFailure=!1,a.prototype.isFailure=!0,o.prototype.isSuccess=!1,s.prototype.isSuccess=!0,o.of=function(e){return new s(e)},o.prototype.of=o.of,o.prototype.ap=r,a.prototype.ap=function(e){return e.isFailure?this.Failure(this.value.concat(e.value)):this},s.prototype.ap=function(e){return e.isFailure?e:e.map(this.value)},o.prototype.map=r,a.prototype.map=i,s.prototype.map=function(e){return this.of(e(this.value))},o.prototype.toString=r,a.prototype.toString=function(){return"Validation.Failure("+this.value+")"},s.prototype.toString=function(){return"Validation.Success("+this.value+")"},o.prototype.isEqual=r,a.prototype.isEqual=function(e){return e.isFailure&&e.value===this.value},s.prototype.isEqual=function(e){return e.isSuccess&&e.value===this.value},o.prototype.get=r,a.prototype.get=function(){throw new TypeError("Can't extract the value of a Failure(a).")},s.prototype.get=function(){return this.value},o.prototype.getOrElse=r,a.prototype.getOrElse=function(e){return e},s.prototype.getOrElse=function(e){return this.value},o.prototype.orElse=r,s.prototype.orElse=i,a.prototype.orElse=function(e){return e(this.value)},o.prototype.merge=function(){return this.value},o.prototype.fold=r,a.prototype.fold=function(e,t){return e(this.value)},s.prototype.fold=function(e,t){return t(this.value)},o.prototype.cata=r,a.prototype.cata=function(e){return e.Failure(this.value)},s.prototype.cata=function(e){return e.Success(this.value)},o.prototype.swap=r,a.prototype.swap=function(){return this.Success(this.value)},s.prototype.swap=function(){return this.Failure(this.value)},o.prototype.bimap=r,a.prototype.bimap=function(e,t){return this.Failure(e(this.value))},s.prototype.bimap=function(e,t){return this.Success(t(this.value))},o.prototype.failureMap=r,s.prototype.failureMap=i,a.prototype.failureMap=function(e){return this.Failure(e(this.value))},o.prototype.leftMap=o.prototype.failureMap,s.prototype.leftMap=s.prototype.failureMap,a.prototype.leftMap=a.prototype.failureMap},function(e,t,n){"use strict";n.r(t);var r=n(2),i=function(e){if(void 0!==e.constructor.name)return e.constructor.name;var t=e.toString();return r.defaultTo(String(t).substr(0,12),r.match(/^(function\s)(\w+)(\(.*)$/,t)[2])},o=function(e){var t={};for(var n in e)t[n]=e[n];return t},a=function e(t){return{map:function(n){return e(n(t))},fold:function(e,n){return n(t)},inspect:function(){return"right("+t+")"}}},s=function(e,t){return r.isNil(e)?t:e},c=function e(t){return{map:function(n){return e(t)},fold:function(e,n){return e(t)},inspect:function(){return"left("+t+")"}}},u=function(e,t){void 0===e&&(e=void 0),void 0===t&&(t=[]);t=r.concat(["length","name","prototype","constructor"],t);var n=r.compose(r.without(t),r.uniq),i=n(Object.getOwnPropertyNames(e.constructor.prototype)),o=n(function(e,t){return void 0===e&&(e=void 0),void 0===t&&(t=[]),Object.getOwnPropertyNames(e)}(e.constructor));return{methods:i,staticMethods:o,allMethods:r.concat(i,o)}},d=n(2),h=n(1),p=n(1),l=function(){return{includes:function(){return void 0!==window.Spyne?(e=window.Spyne.channels.map,t=[],r.forEach(function(e,n,r){return t.push(n)},e),t):["CHANNEL_ROUTE","CHANNEL_UI","CHANNEL_WINDOW","DISPATCHER"];var e,t}}},f=["LOAD","RENDER","MOUNT","UNMOUNT","DISPOSE","GARBAGE_COLLECT","UPDATE"],m=["parent","self","child","children","view"],v=["Observable","BehaviorSubject","Subject","Observer","Subscriber","FromEventObservable"],E=["subscribe","combineLatest"],b=[],y=[],N=[],S=[],g=[],_=[];if(void 0!==d&&void 0!==h){b=[{error:"need to match a valid name within "+v,predicate:function(e){return l().includes(e.name)}},{error:"param 'observable' must contain a valid Observable",predicate:function(e){return void 0!==e.observable.subscribe}},{error:"param action must be a registered action",predicate:function(e){return E.includes(e.action)}}],y=[{error:"needs cid number in srcElement",predicate:d.compose(d.is(String),d.path(["data","srcElement","cid"]))},{error:"needs a viewName in srcElement",predicate:d.compose(d.is(String),d.path(["data","srcElement","viewName"]))}],N=function(){return[].concat(b).concat(y)};var A=[{error:"need to match a valid name within "+v,predicate:function(e){return l().includes(e.name)}},{error:"needs one of the following step strings: "+f,predicate:function(e){return f.includes(e.STEP)}},{error:"type needs to one of the following: "+m,predicate:function(e){return m.includes(e.type)}},{error:"viewId needs to be added ",predicate:function(e){return void 0!==e.viewId}}];S=function(){return[].concat(A)},g=function(){return[{error:"DISPOSE STEP requires a disposeItem param in the data object",predicate:function(e){return"DISPOSE"===e.STEP&&void 0!==e.data.disposeItems}}].concat(A)},_=function(){var e=[{error:"UPDATE STEP requires a data object ",predicate:function(e){return"UPDATE"===e.STEP&&void 0!==e.data}}];return e.concat(A)},function(){return A.concat(b).concat(y)},function(){return[].concat(b).concat(y)},function(){var e=[{error:"param 'name' must be of a registered type",predicate:function(e){return l().includes(e.name)}},{error:"param 'observable' must contain a valid Observable",predicate:function(e){return v.includes((0,e.observable)().constructor.name)}},{error:"param action must be a registered action",predicate:function(e){return E.includes(e.action)}}];return{streams:[{init:{name:"DISPATCHER",observable:function(){return new p},action:"subscribe"},structure:{type:String,observable:h||p,action:String},validations:e},{init:{name:"UBU",observable:function(){return new p},action:"subscribe"},structure:{type:String,observable:h||p,action:String},validations:e}]}}}var T=n(2),C=function(){function e(t,n,r,i,o){var a=t,s={channel:a,action:n,channelPayload:r,srcElement:i,event:o,props:function(){return T.mergeAll([s.channelPayload,{channel:a},{event:o},{action:s.action},s.srcElement,s.event])}},c=window.Spyne.getChannelActions(a);return e.validateAction(n,a,c),"CHANNEL_ROUTE"===a&&(s.location=e.getLocationData()),s}return e.validateAction=function(e,t,n){var r=T.contains(e,n);return!1===r&&void 0!==window.Spyne&&console.warn("warning: Action: '"+e+"' is not registered within the "+t+" channel!"),r},e.getLocationData=function(){return T.pickAll(["href","origin","protocol","host","hostname","port","pathname","search","hash"],window.location)},e.getStreamItem=function(){},e.getMouseEventKeys=function(){return["altKey","bubbles","cancelBubble","cancelable","clientX","clientY","composed","ctrlKey","currentTarget","defaultPrevented","detail","eventPhase","fromElement","isTrusted","layerX","layerY","metaKey","movementX","movementY","offsetX","offsetY","pageX","pageY","path","relatedTarget","returnValue","screenX","screenY","shiftKey","sourceCapabilities","srcElement","target","timeStamp","toElement","type","view","which","x","y"]},e}(),O=n(1),D=n(0);function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=n(2),L=function(){function e(e,t){var n=this;void 0===e&&(e="observer"),void 0===t&&(t={}),this.addMixins(),this.addRegisteredActions.bind(this),this.createChannelActionsObj();t.name=e,this.props=t,this.props.isProxy=void 0!==this.props.isProxy&&this.props.isProxy,this.props.sendLastPayload=void 0!==this.props.sendLastPayload&&this.props.sendLastPayload,this.createChannelActionMethods(),this.streamsController=window.Spyne.channels;var r=this.getMainObserver();this.observer$=this.props.observer=r,this.streamsController.getStream("DISPATCHER").subscribe(function(e){return n.onReceivedObservable(e)})}var t,n,r,i=e.prototype;return i.getMainObserver=function(){return!0===this.streamsController.testStream(this.props.name)?this.streamsController.getProxySubject(this.props.name,this.props.sendLastPayload):!0===this.props.sendLastPayload?new O.ReplaySubject(1):new O.Subject},i.onStreamInitialized=function(){},i.initializeStream=function(){this.onStreamInitialized()},i.setTrace=function(e){},i.createChannelActionsObj=function(){var e=w.ifElse(w.is(String),w.identity,w.head),t=w.map(e,this.addRegisteredActions()),n=w.mergeAll(w.chain(function(e){return w.objOf(e,e)},t));this.channelActions=n},i.createChannelActionMethods=function(){var e=this,t=w.ifElse(w.is(String),w.identity,w.head),n=w.ifElse(w.is(String),w.always("onIncomingObserverableData"),function(t){var n=w.view(w.lensIndex(1),t);return!0==("function"==typeof e[n])?e[n].bind(e):console.warn('"'+e.props.name+'", REQUIRES THE FOLLOWING METHOD '+n+" FOR ACTION, "+t[0]),n});this.channelActionMethods=w.fromPairs(w.map(function(e){return[t(e),n(e)]},this.addRegisteredActions()))},i.addRegisteredActions=function(){return[]},i.onReceivedObservable=function(e){e.action;this.onIncomingObservable(e)},i.getActionMethodForObservable=function(e){var t=this.onIncomingObserverableData.bind(this),n=w.path(["data","action"],e),r=w.prop(n,this.channelActionMethods),i=t;void 0!==r&&"onIncomingObserverableData"!==r&&(!0===("function"==typeof this[r])&&(i=this[r].bind(this)));return i},i.onIncomingObservable=function(e){var t=this,n=w.equals(e.name,this.props.name),r=function(t){return{observableData:e.data,observableEvent:t}};return!0===n?function(e){return e.observable.pipe(Object(D.map)(r)).subscribe(t.getActionMethodForObservable(e))}(e):void 0},i.onIncomingObserverableData=function(e){},i.sendStreamItem=function(e,t,n,r,i){void 0===i&&(i=this.observer$);var o=new C(this.props.name,e,t,n,r);i.next(o)},i.getChannel=function(e){var t=this;return w.ifElse(function(e){return l().includes(e)},function(e){return t.streamsController.getStream(e).observer},function(e){return console.warn("channel name "+e+" is not within "+l)})(e)},i.addMixins=function(){},t=e,(n=[{key:"isProxy",get:function(){return this.props.isProxy}},{key:"channelName",get:function(){return this.props.name}},{key:"observer",get:function(){return this.observer$}}])&&I(t.prototype,n),r&&I(t,r),e}(),P=n(2),M=function(){function e(){this.checkIfObjIsNotEmptyOrNil=e.checkIfObjIsNotEmptyOrNil.bind(this)}return e.checkIfObjIsNotEmptyOrNil=function(e){var t=P.compose(P.complement(P.isEmpty),P.head,P.values),n=P.compose(P.complement(P.isNil),P.head,P.values);return P.allPass([t,n])(e)},e.checkIfParamValueMatchesRegex=function(e,t){var n=P.reject(P.equals("routeName")),r=P.compose(n,P.keys),i=P.compose(P.find(function(t){return P.test(new RegExp(t),e)}),r)(t);return P.is(String,i)&&(t=P.assoc(e,P.prop(i,t),t)),t},e.formatStrAsWindowLocation=function(e){return{hash:e,search:e,pathname:e}},e.getLocationStrByType=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=window.location);var r={slash:"pathname",query:"search",hash:"hash"}[!0===t?"hash":e];return P.prop(r,n).replace(/^(\/)?(#)?(\/)?(.*)$/,"$4")},e.createRouteArrayFromParams=function(e,t,n,r){var i=this;void 0===n&&(n="slash");var o=[];return function t(n){var a={},s=n.routeName,c=void 0!==e[s]?e[s]:P.prop(s,r),u=typeof n[c];"string"===u?c=n[c]:"undefined"===u&&(n=i.checkIfParamValueMatchesRegex(c,n)),a[s]=c,i.checkIfObjIsNotEmptyOrNil(a)&&o.push(a);var d=P.is(Object,n),h=P.has(c,n),p=P.has("routePath",n);if(!0===(h&&d)){var l=n[c];P.has("routePath",l)&&t(l.routePath)}else!0===p&&void 0!==c&&t(n.routePath)}(t),o},e.createSlashString=function(e){P.map(function(e){return e.replace(/^(\W*)(.*?)(\W*)$/g,"$2")},P.values);var t=P.reject(P.isNil),n=P.when(P.complement(P.isNil,P.__),P.join("/")),r=P.compose(n,t,P.flatten,P.map(P.values));r(e);return r(e)},e.createQueryString=function(e){var t=P.reject(P.isNil),n=this.checkIfObjIsNotEmptyOrNil,r=P.compose(P.join("="),P.flatten,P.toPairs),i=P.ifElse(n,r,P.always(void 0)),o=P.map(i),a=P.when(P.complement(P.isEmpty),P.concat("?"));return P.compose(a,P.join("&"),t,o)(e)},e.checkPayloadForRegexOverrides=function(e,t,n){void 0===n&&(n="Value");var r=P.compose(function(e){return P.prop(""+e+n,t)},P.head,P.keys);return P.map(function(e){var t=r(e);return void 0!==t?P.assoc(P.compose(P.head,P.keys)(e),t,e):e},e)},e.convertParamsToRoute=function(t,n,r,i){void 0===n&&(n=window.Spyne.config.channels.ROUTE);var o=void 0!==r?r:n.type,a=n.isHash,s=n.routes.routePath,c=void 0!==i?i:this.getLocationStrByType(o,a),u=this.convertRouteToParams(c,n,o).routeData,d=this.createRouteArrayFromParams(t,s,o,u);return d=e.checkPayloadForRegexOverrides(d,t),"query"===o?this.createQueryString(d):this.createSlashString(d)},e.findIndexOfMatchedStringOrRegex=function(e,t){var n=P.replace(/^$/,"^$"),r=P.either(P.propEq("str",e),P.compose(P.test(P.__,e),P.prop("re")));return P.compose(P.findLastIndex(P.equals(!0)),P.map(r),P.map(function(e){var t;return{str:e,re:(t=e,new RegExp(t))}}),P.map(n))(t)},e.checkIfValueShouldMapToParam=function(t,n,r){var i=P.test(P.__,n),o=P.replace(/^$/,"^$"),a=P.compose(P.map(P.last),P.map(P.filter(P.is(String))),P.toPairs)(t),s=(P.compose(P.findLastIndex(P.equals(!0)),P.map(i),P.map(function(e){return new RegExp(e)}),P.map(o)),e.findIndexOfMatchedStringOrRegex(n,a)),c=n;if(s>=0){var u=a[s],d=P.invert(t),h=P.compose(P.head,P.defaultTo([]),P.prop(u))(d);!0===/^(\w*)$/.test(h)&&!0===P.is(String,h)&&(c=h)}return c},e.createArrFromSlashStr=function(e){return e.replace(/^([\/])?(.*)$/,"$2").split("/")},e.convertSlashRouteStrToParamsObj=function(e,t,n){var r=this,i=t,o=this.createArrFromSlashStr(t),a=[],s=[],c=e;P.reduce(function(e,t){var i=r.checkIfValueShouldMapToParam(c,t,n);void 0!==(c=r.checkIfParamValueMatchesRegex(t,c))&&(a.push(c.routeName),s.push(i));var o=[t,"routePath"],u=P.path(o,c),d=P.path(["routePath"],c);void 0!==u?c=u:void 0!==d&&(c=d)},0,o);var u=P.zipObj(a,s),d=this.getLastArrVal(a);return{paths:a,pathInnermost:d,routeData:u,routeValue:i}},e.getLastArrVal=function(e){var t;return t=e,void 0!==P.last(t)?P.last(t):""},e.createDefaultParamFromEmptyStr=function(e,t){var n={};return n[e.routeName]=this.checkIfValueShouldMapToParam(e,t),n},e.convertQueryStrToParams=function(e,t,n){var r=t,i=t.replace(/^([?])?(.*)$/,"$2"),o=P.compose(P.map(P.split("=")),P.split("&"))(i),a=P.fromPairs(o),s=P.map(P.head,o);return!0===P.isEmpty(t)&&(a=this.createDefaultParamFromEmptyStr(e,t,n),s=P.keys(a)),{paths:s,pathInnermost:this.getLastArrVal(s),routeData:a,routeValue:r}},e.convertRouteToParams=function(e,t,n){if(void 0===t)return{};var r=void 0!==n?n:t.type,i=P.defaultTo({},P.prop("regexTokens",t)),o=t.routes.routePath;return"query"===r?this.convertQueryStrToParams(o,e):this.convertSlashRouteStrToParamsObj(o,e,i)},e}(),V=n(2),F=function(){function e(){this.createPopStateStream=e.createPopStateStream.bind(this)}return e.createPopStateStream=function(e){Object(O.fromEventPattern)(function(e){window.onpopstate=e},function(){window.onpopstate=function(){}}).subscribe(e)},e.getLastArrVal=function(e){var t;return t=e,void 0!==V.last(t)?V.last(t):""},e.compareRouteKeywords=function(e,t){void 0===e&&(e={});var n=function(e,t){return void 0!==t?V.pick(t,e):e},r=n(e,t);return{pickValues:n,compare:function(e,t){void 0===e&&(e={});var i=n(e,t),o=function(e){return V.compose(V.keys,V.filter(V.propEq(e,!0)))},a=V.compose(V.map(function(e){var t=V.prop(e,r),n=V.prop(e,i),o=V.equals(t,n),a=void 0!==t,s=void 0!==n,c=!o,u=!1===a&&!0===s,d=!0===a&&!1===s,h={};return h[e]={same:o,changed:c,added:u,removed:d,previousExists:a,nextExists:s},h}),V.uniq,V.chain(V.keys))([r,i]),s=V.chain(o("changed"),a),c=V.chain(o("added"),a),u=V.chain(o("removed"),a);return r=i,{pathsAdded:c,pathsRemoved:u,pathsChanged:s}},getComparer:function(){return r}}},e.getRouteArrData=function(t,n){var r=V.filter(V.contains(V.__,t),n);return{paths:r,pathInnermost:e.getLastArrVal(r)}},e.translateRouteParameter=function(e,t,n){},e.flattenConfigObject=function(e){return V.values(V.fromPairs(function e(t){return V.chain(function(t){var n=t[0],r=t[1];return"[object Object]"===Object.prototype.toString.call(r)?V.map(function(e){var t=e[0],r=e[1];return[n+"."+t,r]},e(r)):[[n,r]]},V.toPairs(t))}(e)))},e.getLocationData=function(){return V.pickAll(["href","origin","protocol","host","hostname","port","pathname","search","hash"],window.location)},e}();var H=n(2),j=function(e){var t,n;function r(t,n){var r;return void 0===t&&(t="CHANNEL_ROUTE"),void 0===n&&(n={}),n.sendLastPayload=!0,(r=e.call(this,"CHANNEL_ROUTE",n)||this).createChannelActionsObj(),r.routeConfigJson=r.getRouteConfig(),r.bindStaticMethods(),r.navToStream$=new O.ReplaySubject(1),r.observer$=r.navToStream$.pipe(Object(D.map)(function(e){return r.onMapNext(e)})),r.compareRouteKeywords=F.compareRouteKeywords(),r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.initializeStream=function(){this.initStream()},i.createChannelActionsObj=function(){var e=this.addRegisteredActions(),t=H.mergeAll(H.chain(function(e){return H.objOf(e,e)},e));this.channelActions=t},i.addRegisteredActions=function(){return["CHANNEL_ROUTE_DEEPLINK_EVENT","CHANNEL_ROUTE_CHANGE_EVENT"]},i.getRouteConfig=function(){var e=window.Spyne.config,t=H.path(["channels","ROUTE"],e);"query"===t.type&&(t.isHash=!1);var n=F.flattenConfigObject(t.routes);return t.paramsArr=n,t},i.initStream=function(){this.firstLoadStream$=new O.BehaviorSubject(this.onIncomingDomEvent(void 0,this.routeConfigJson,"CHANNEL_ROUTE_DEEPLINK_EVENT")),F.createPopStateStream(this.onIncomingDomEvent.bind(this)),this.observer$=Object(O.merge)(this.firstLoadStream$,this.navToStream$)},i.onMapNext=function(e,t){return void 0===t&&(t=!1),e.action="CHANNEL_ROUTE_CHANGE_EVENT",e},r.onIncomingDomEvent=function(e,t,n){void 0===t&&(t=this.routeConfigJson);var r=void 0!==n?n:this.channelActions.CHANNEL_ROUTE_CHANGE_EVENT,i=this.getDataFromString(t),o=this.compareRouteKeywords.compare(i.routeData,i.paths);i=H.merge(i,o),this.sendStreamItem(r,i,void 0,void 0,this.navToStream$)},r.checkForRouteParamsOverrides=function(e){return e},i.onIncomingObserverableData=function(e){var t=this.channelActions.CHANNEL_ROUTE_CHANGE_EVENT,n=this.getDataFromParams(e),r=H.path(["observableData","srcElement"],e),i=e.observableEvent,o=!n.isHidden,a=this.compareRouteKeywords.compare(n.routeData,n.paths);n=H.merge(n,a),this.sendRouteStream(n,o),this.sendStreamItem(t,n,r,i,this.navToStream$)},r.checkAndConvertStrWithRegexTokens=function(e,t){return H.keys(t)},i.sendRouteStream=function(e,t){void 0===t&&(t=!0),!0===t&&this.setWindowLocation(e)},r.getRouteState=function(e){return"CHANNEL_ROUTE_CHANGE_EVENT"},r.getIsDeepLinkBool=function(){return 0===this._routeCount},r.getRouteCount=function(){return void 0===this._routeCount?(this._routeCount=0,this._routeCount):(this._routeCount+=1,this._routeCount)},r.getExtraPayloadParams=function(e){return void 0===e&&(e=this.routeConfigJson),{routeCount:this.getRouteCount(),isDeepLink:this.getIsDeepLinkBool(),isHash:e.isHash,isHidden:e.isHidden,routeType:e.type}},r.getDataFromParams=function(e,t){void 0===t&&(t=this.routeConfigJson);var n=H.path(["observableData","payload"],e),r=this.getRouteStrFromParams(n,t),i=function(e,n){return H.defaultTo(n,H.prop(e,t))},o=i("type","slash"),a=i("isHash",!1),s=M.formatStrAsWindowLocation(r),c=this.getDataFromLocationStr(o,a,s),u=c.pathInnermost,d=c.paths;n=H.merge(c.routeData,n);var h=this.getExtraPayloadParams(t),p=h.routeCount;return{isDeepLink:h.isDeepLink,routeCount:p,pathInnermost:u,paths:d,routeData:n,routeValue:r,isHash:h.isHash,isHidden:h.isHidden,routeType:h.routeType}},r.getDataFromString=function(e,t){void 0===e&&(e=this.routeConfigJson);var n=e.type,i=!0===e.isHash,o=M.getLocationStrByType(n,i),a=r.getParamsFromRouteStr(o,e,n),s=a.paths,c=a.pathInnermost,u=a.routeData,d=a.routeValue,h=this.getExtraPayloadParams(e),p=h.routeCount,l=h.isDeepLink,f=h.isHash,m=h.routeType;return{isDeepLink:l,routeCount:p,pathInnermost:c,paths:s,routeData:u,routeValue:d,isHash:f,isHidden:h.isHidden,routeType:m}},r.getDataFromLocationStr=function(e,t,n){void 0===e&&(e="slash"),void 0===t&&(t=this.routeConfigJson.isHash),void 0===n&&(n=window.location);var r=void 0!==this.routeConfigJson?this.routeConfigJson.type:e,i=M.getLocationStrByType(r,t,n),o=this.getParamsFromRouteStr(i,this.routeConfigJson,r);return{paths:o.paths,pathInnermost:o.pathInnermost,routeData:o.routeData,routeValue:o.routeValue,action:this.getRouteState()}},r.getLocationData=function(){return H.pickAll(["href","origin","protocol","host","hostname","port","pathname","search","hash"],window.location)},r.getRouteStrFromParams=function(e,t,n){var r=void 0!==n?n:t.type;return M.convertParamsToRoute(e,t,r)},r.getParamsFromRouteStr=function(e,t,n){var r=void 0!==n?n:t.type;return M.convertRouteToParams(e,t,r)},i.checkEmptyRouteStr=function(e,t){void 0===t&&(t=!1);var n=H.isEmpty(e);return!0===(!0===n&&!1===t)||!0===(!0===n&&!0===t)?"/":!0===(!1===n&&!0===t)?H.concat("#",e):e},r.removeLastSlash=function(e){return e.replace(/^(.*)(\/)$/,"$1")},i.setWindowLocation=function(e){var t=e.isHash,n=e.routeValue;if(n=this.checkEmptyRouteStr(n,t),!0===t){n=r.removeLastSlash(window.location.pathname)+n,window.history.pushState({},"",n)}else{var i=H.when(H.compose(H.complement(H.equals("/")),H.head),H.concat("/",H.__));window.history.pushState({},"",i(n))}},i.getWindowLocation=function(){return window.location.pathname},i.bindStaticMethods=function(){this.getIsDeepLinkBool=r.getIsDeepLinkBool.bind(this),this.getDataFromLocationStr=r.getDataFromLocationStr.bind(this),this.onIncomingDomEvent=r.onIncomingDomEvent.bind(this),this.getDataFromString=r.getDataFromString.bind(this),this.getParamsFromRouteStr=r.getParamsFromRouteStr.bind(this),this.getLocationData=r.getLocationData.bind(this),this.getRouteState=r.getRouteState.bind(this),this.getDataFromParams=r.getDataFromParams.bind(this),this.getRouteCount=r.getRouteCount.bind(this),this.getExtraPayloadParams=r.getExtraPayloadParams.bind(this);var e=H.curryN(3,r.getRouteStrFromParams);this.getRouteStrFromParams=e(H.__,this.routeConfigJson,this.routeConfigJson.type)},r}(L);var W=n(2),x=function(e){var t,n;function r(t,n){var r;return void 0===t&&(t="CHANNEL_UI"),void 0===n&&(n={}),n.sendLastPayload=!1,(r=e.call(this,t,n)||this).keyEventsLoaded=!1,r.keyCodeArr=[],r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.addRegisteredActions=function(){return["CHANNEL_UI_EVENT","CHANNEL_UI_BLUR_EVENT","CHANNEL_UI_CLICK_EVENT","CHANNEL_UI_CHANGE_EVENT","CHANNEL_UI_CHANGE_EVENT","CHANNEL_UI_DBLCLICK_EVENT","CHANNEL_UI_FOCUS_EVENT","CHANNEL_UI_FOCUSIN_EVENT","CHANNEL_UI_FOCUSOUT_EVENT","CHANNEL_UI_INPUT_EVENT","CHANNEL_UI_KEYDOWN_EVENT","CHANNEL_UI_KEYPRESS_EVENT","CHANNEL_UI_KEYUP_EVENT","CHANNEL_UI_MOUSEDOWN_EVENT","CHANNEL_UI_MOUSEENTER_EVENT","CHANNEL_UI_MOUSELEAVE_EVENT","CHANNEL_UI_MOUSEMOVE_EVENT","CHANNEL_UI_MOUSEOUT_EVENT","CHANNEL_UI_MOUSEOVER_EVENT","CHANNEL_UI_MOUSEUP_EVENT","CHANNEL_UI_SELECT_EVENT"]},i.loadKeyStream=function(){var e=this,t=O.Observable.fromEvent(document,"keyup");this.keyPresses$=t.groupBy(function(e){return e.keyCode}).mergeAll().filter(function(t){return e.keyCodeArr.indexOf(t.keyCode)>=0}).repeat().subscribe(this.onKeyPressed.bind(this))},i.addKeyEvent=function(e){!1===this.keyEventsLoaded&&this.loadKeyStream(),this.keyEventsLoaded=!0,this.registerKey(e)},i.registerKey=function(e){this.keyCodeArr.push(e)},i.onKeyPressed=function(e){console.log("key is ",e)},i.onIncomingObservable=function(e){var t=this,n=W.equals(e.name,this.props.name),r=function(t){return{observableData:e.data,uiEvent:t}};return!0===n?function(e){return e.observable.pipe(Object(D.map)(r)).subscribe(t.onUIEvent.bind(t))}(e):void 0},i.getActionState=function(e){var t=W.path(["uiEvent","type"]),n=W.path(["uiEvent","typeOverRide"]),r=W.compose(W.toUpper,W.either(n,t))(e);return void 0!==r?"CHANNEL_UI_"+r+"_EVENT":"CHANNEL_UI"},r.checkToPreventDefaultEvent=function(e){var t=W.pathEq(["observableData","payload","eventPreventDefault"],"true"),n=W.compose(function(e){void 0!==e&&e.preventDefault()},W.prop("uiEvent"));W.when(t,n)(e)},i.onUIEvent=function(e){r.checkToPreventDefaultEvent(e),e.action=this.getActionState(e);var t=e.action,n=e.observableData,i=n.payload,o=n.srcElement,a=e.uiEvent;this.sendStreamItem(t,i,o,a)},r}(L),k=n(2),$=function(){function e(){this.createDomObservableFromEvent=e.createDomObservableFromEvent.bind(this)}return e.createDomObservableFromEvent=function(e,t,n){void 0===n&&(n=!0);return t=void 0===t?function(e){return e}:t,Object(O.fromEventPattern)(function(t){return window.addEventListener(e,t,{passive:n})},function(){window[e]=function(e){return e}}).pipe(Object(D.map)(t))},e.createMediaQuery=function(e){var t=window.matchMedia(e);return this.checkIfValidMediaQuery(t,e),t},e.checkIfValidMediaQuery=function(e,t){var n=function(e){return e.replace(/\s+/gm,"")},r="MediaQueryList"===e.constructor.name&&n(e.media)===n(t);return!1===r&&function(t){console.warn('Spyne Info: the following query string, "'+t+'", has been optimized to "'+e.media+'" by the browser and may not be a valid Media Query item!')}(t),r},e.createMediaQueryHandler=function(e,t){var n,r=function(e){return function(t){return t.mediaQueryName=e,t}}(t),i=(n=e,{addHandler:function(e){n.addListener(e)},removeHandler:function(e){n.onchange=function(){}}});return new O.fromEventPattern(i.addHandler,i.removeHandler).pipe(Object(D.map)(r))},e.createMergedObsFromObj=function(t){var n=t.mediqQueries,r=[];return k.mapObjIndexed(function(t,n,i){var o=e.createMediaQuery(t);r.push(e.createMediaQueryHandler(o,n))},n),r},e}();var U=n(2),G=function(e){var t,n;function i(){var t;return(t=e.call(this,"CHANNEL_WINDOW")||this).bindStaticMethods(),t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=i.prototype;return o.initializeStream=function(){var e=this;this.domChannelConfig=window.Spyne.config.channels.WINDOW,this.currentScrollY=window.scrollY;var t=this.getActiveObservables();O.merge.apply(void 0,t).subscribe(function(t){var n=t.action,r=t.channelPayload,i=t.srcElement,o=t.event;e.sendStreamItem(n,r,i,o)})},i.getScrollMapFn=function(e){var t=this.channelActions.CHANNEL_WINDOW_SCROLL_EVENT,n=window.scrollY,r=this.currentScrollY-n,i=r>=0?"up":"down";return this.currentScrollY=n,{action:t,channelPayload:{scrollY:n,scrollDistance:r,scrollDir:i},srcElement:e.srcElement,scrollDistance:r,event:e}},i.getMouseWheelMapFn=function(e){return{action:this.channelActions.CHANNEL_WINDOW_MOUSEWHEEL_EVENT,channelPayload:{scrollDir:e.deltaY<=0?"up":"down",deltaX:e.deltaX,deltaY:e.deltaY,deltaZ:e.deltaZ},srcElement:e.srcElement,event:e}},i.createCurriedGenericEvent=function(e){var t="CHANNEL_WINDOW_"+e.toUpperCase()+"_EVENT";return U.curry(i.mapGenericEvent)(t)},i.mapGenericEvent=function(e,t){return console.log("map generic event ",e),{action:e,channelPayload:t,srcElement:t.srcElement,event:t}},i.getResizeMapFn=function(e){return{action:this.channelActions.CHANNEL_WINDOW_RESIZE_EVENT,channelPayload:U.pick(["innerWidth","innerHeight","outerWidth","outerHeight"],window),srcElement:e.srcElement,event:e}},i.getOrientationMapFn=function(e){var t=this.channelActions.CHANNEL_WINDOW_ORIENTATION_EVENT,n=window.matchMedia("(orientation: portrait)").matches,r=U.pick(["innerWidth","innerHeight","outerWidth","outerHeight"],window);return r.orientation=!0===n?"portrait":"landscape",{action:t,channelPayload:r,srcElement:e.srcElement,event:e}},o.getMediaQueryMapFn=function(e){return{action:this.channelActions.CHANNEL_WINDOW_MEDIA_QUERY_EVENT,channelPayload:U.pick(["matches","media","mediaQueryName"],e),srcElement:e.srcElement,event:e}},o.createMouseWheelObservable=function(e){var t=e.debounceMSTimeForScroll;return $.createDomObservableFromEvent("mousewheel",i.getMouseWheelMapFn.bind(this)).debounceTime(t)},o.createScrollObservable=function(e){var t=e.debounceMSTimeForScroll;return $.createDomObservableFromEvent("scroll",i.getScrollMapFn.bind(this)).pipe(Object(D.debounceTime)(t),Object(D.skipWhile)(function(e){return 0===e.scrollDistance}))},o.createOrientationObservable=function(e){return $.createDomObservableFromEvent("orientationchange",i.getOrientationMapFn.bind(this))},o.createResizeObservable=function(e){var t=e.debounceMSTimeForResize;return $.createDomObservableFromEvent("resize",i.getResizeMapFn.bind(this)).pipe(Object(D.debounceTime)(t))},o.getEventsFromConfig=function(e){void 0===e&&(e=this.domChannelConfig);var t=e.events;return U.map(function(e){var t=i.createCurriedGenericEvent(e);return $.createDomObservableFromEvent(e,t)},t)},o.getActiveObservables=function(e){void 0===e&&(e=this.domChannelConfig);var t,n,i,o=[];e.listenForMediaQueries=(t=e.mediqQueries,n=r.compose(r.complement(r.isEmpty),r.head,r.values),i=r.compose(r.complement(r.isNil),r.head,r.values),r.allPass([n,i])(t));var a={listenForResize:this.createResizeObservable.bind(this),listenForOrientation:this.createOrientationObservable.bind(this),listenForScroll:this.createScrollObservable.bind(this),listenForMouseWheel:this.createMouseWheelObservable.bind(this)};U.mapObjIndexed(function(t,n,r){e[n]&&o.push(t(e))},a),this.checkForMediaQueries(e.listenForMediaQueries);var s=this.getEventsFromConfig(e);return o=o.concat(s)},o.checkForMediaQueries=function(e){var t=this;!0===e&&this.getMediaQueryObservable(this.domChannelConfig).subscribe(function(e){var n=e.action,r=e.channelPayload,i=e.srcElement,o=e.event;t.sendStreamItem(n,r,i,o,t.observer$)})},o.getMediaQueryObservable=function(e){var t=this.createMergedObsFromObj(e);return Object(O.merge)(t[0],t[1]).pipe(Object(D.map)(this.getMediaQueryMapFn.bind(this)))},o.addRegisteredActions=function(){return["CHANNEL_WINDOW_SCROLL_EVENT","CHANNEL_WINDOW_MOUSEWHEEL_EVENT","CHANNEL_WINDOW_MEDIA_QUERY_EVENT","CHANNEL_WINDOW_RESIZE_EVENT","CHANNEL_WINDOW_ORIENTATION_EVENT","CHANNEL_WINDOW_CACHED_EVENT","CHANNEL_WINDOW_ERROR_EVENT","CHANNEL_WINDOW_ABORT_EVENT","CHANNEL_WINDOW_LOAD_EVENT","CHANNEL_WINDOW_BEFOREUNLOAD_EVENT","CHANNEL_WINDOW_UNLOAD_EVENT","CHANNEL_WINDOW_ONLINE_EVENT","CHANNEL_WINDOW_OFFLINE_EVENT","CHANNEL_WINDOW_FOCUS_EVENT","CHANNEL_WINDOW_BLUR_EVENT","CHANNEL_WINDOW_OPEN_EVENT","CHANNEL_WINDOW_MESSAGE_EVENT","CHANNEL_WINDOW_ERROR_EVENT","CHANNEL_WINDOW_CLOSE_EVENT","CHANNEL_WINDOW_PAGEHIDE_EVENT","CHANNEL_WINDOW_PAGESHOW_EVENT","CHANNEL_WINDOW_POPSTATE_EVENT","CHANNEL_WINDOW_ANIMATIONSTART_EVENT","CHANNEL_WINDOW_ANIMATIONEND_EVENT","CHANNEL_WINDOW_ANIMATIONITERATION_EVENT","CHANNEL_WINDOW_TRANSITIONSTART_EVENT","CHANNEL_WINDOW_TRANSITIONCANCEL_EVENT","CHANNEL_WINDOW_TRANSITIONEND_EVENT","CHANNEL_WINDOW_TRANSITIONRUN_EVENT","CHANNEL_WINDOW_RESET_EVENT","CHANNEL_WINDOW_SUBMIT_EVENT","CHANNEL_WINDOW_BEFOREPRINT_EVENT","CHANNEL_WINDOW_AFTERPRINT_EVENT","CHANNEL_WINDOW_COMPOSITIONSTART_EVENT","CHANNEL_WINDOW_COMPOSITIONUPDATE_EVENT","CHANNEL_WINDOW_COMPOSITIONEND_EVENT","CHANNEL_WINDOW_FULLSCREENCHANGE_EVENT","CHANNEL_WINDOW_FULLSCREENERROR_EVENT","CHANNEL_WINDOW_CUT_EVENT","CHANNEL_WINDOW_WHEEL_EVENT","CHANNEL_WINDOW_COPY_EVENT"]},o.bindStaticMethods=function(){this.createMediaQueryHandler=$.createMediaQueryHandler.bind(this),this.createMergedObsFromObj=$.createMergedObsFromObj.bind(this)},i}(L);var q=n(2),B=function(e){var t,n;function r(t){return void 0===t&&(t={}),e.call(this,"CHANNEL_VIEWSTREAM_LIFECYCLE",t)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.addRegisteredActions=function(){return["CHANNEL_VIEWSTREAM_LIFECYCLE_RENDERED_EVENT","CHANNEL_VIEWSTREAM_LIFECYCLE_REMOVED_EVENT"]},i.onIncomingObserverableData=function(e){var t=e.observableData,n=t.action,r=q.prop("srcElement",t);r.action=n,this.onSendEvent(n,r)},i.onSendEvent=function(e,t){var n=this;void 0===t&&(t={});var r=this.channelActions[e],i={};window.setTimeout(function(){return n.sendStreamItem(r,t,i,void 0)},0)},r}(L),Y=n(3),Q=n.n(Y),z=n(2),K=Q.a.Success,J=Q.a.Failure,X=function(){};function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}void 0!==z&&(X=z.curry(function(e,t){var n=K(z.curryN(z.length(e),z.always(t)));return z.reduce(function(e,n){return e.ap(n.predicate(t)?K(t):J([n.error]))},n,e)}));var ee=function(e){var t,n,r,i,o;function a(t,n){var r;return void 0===n&&(n={}),n.isProxy=!0,(r=e.call(this,t,n)||this).props=n,r.subject$=new O.Subject,r.replaySub$=new O.ReplaySubject(1),r.observer$=Object(O.merge)(r.subject$,r.replaySub$),r}return n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,a.prototype.getMergedSubject=function(e){return void 0===e&&(e=!1),!0===e?this.replaySub$:this.subject$},r=a,(i=[{key:"replaySubject",get:function(){return this.replaySub$}},{key:"subject",get:function(){return this.subject$}}])&&Z(r.prototype,i),o&&Z(r,o),a}(L),te=n(2),ne=function(){function e(e){this.addMixins(),this.map=new Map,this.map.set("DISPATCHER",new O.Subject),window.setTimeout(this.checkForMissingChannels.bind(this),3e3)}var t=e.prototype;return t.checkForMissingChannels=function(){var e=Array.from(this.map,function(e,t){return{key:e[0],val:e[1].constructor.name}}),t=te.filter(te.propEq("val","ChannelsBaseProxy"))(e);if(t.length>=1){var n="Spyne Warning: The following "+(1===t.length?"Channel has":"Channels have")+" not been initialized: "+te.compose(te.join(", "),te.map(te.prop("key")))(t);console.warn(n),console.log("FILTER PROXY WARNING ",t)}},t.init=function(){this.createMainStreams()},t.createObserver=function(e){X(e.validations,e.init),this.map.set(e.init.name,e.init.observable())},t.createMainStreams=function(){this.routeValueeam=new j,this.map.set("CHANNEL_ROUTE",this.routeValueeam),this.uiStream=new x,this.map.set("CHANNEL_UI",this.uiStream),this.domStream=new G,this.map.set("CHANNEL_WINDOW",this.domStream),this.viewStreamLifecycle=new B,this.map.set("CHANNEL_VIEWSTREAM_LIFECYCLE",this.viewStreamLifecycle),this.routeValueeam.initializeStream(),this.domStream.initializeStream()},t.addKeyEvent=function(e){this.map.get("UI").addKeyEvent(e)},t.registerStream=function(e){var t=e.channelName;this.map.set(t,e),e.initializeStream()},t.getChannelActions=function(e){return this.map.get(e).addRegisteredActions()},t.getProxySubject=function(e,t){void 0===t&&(t=!1);var n=!0===t?"replaySubject":"subject";return this.map.get(e)[n]},t.testStream=function(e){return void 0!==this.map.get(e)},t.getStream=function(e){return!1===this.testStream(e)&&this.map.set(e,new ee(e)),this.map.get(e)},t.addMixins=function(){},e}();function re(){return{createpropsMap:function(){var e=new WeakMap,t={cid:this.props.cid};return e.set(t,this.props),{key:t,weakMap:e}},gc:function(){for(var e in this)delete this[e]},createId:function(){return"cid-"+Math.floor(1e7*Math.random(1e7))},setTraceFunc:function(e){return!0===e?console.log:function(){}}}}var ie=n(2),oe=function(){function e(t,n){var r=this;this.template=this.formatTemplate(t),this.templateData=n;var i=e.getStringArray(this.template),o=this.template.match(e.findTmplLoopsRE());o=null===o?[]:o;var a=ie.contains(ie.__,o),s=ie.ifElse(a,function(t,n){return t.replace(e.parseTmplLoopsRE(),r.parseTheTmplLoop.bind(r))},this.addParams.bind(this));this.finalArr=i.map(s)}e.getStringArray=function(t){var n=t.split(e.findTmplLoopsRE()),r=/^([\\n\s\W]+)$/;return ie.reject(function(e){return e.match(r)},n)},e.findTmplLoopsRE=function(){return/({{#\w+}}[\w\n\s\W]+?{{\/\w+}})/gm},e.parseTmplLoopsRE=function(){return/({{#(\w+)}})([\w\n\s\W]+?)({{\/\2}})/gm},e.swapParamsForTagsRE=function(){return/({{)(.*?)(}})/gm};var t=e.prototype;return t.removeThis=function(){this.finalArr=void 0,this.templateData=void 0,this.template=void 0},t.getTemplateNode=function(){var e=this.finalArr.join(" "),t=document.createRange().createContextualFragment(e);return window.setTimeout(this.removeThis(),10),t},t.getTemplateString=function(){return this.finalArr.join(" ")},t.formatTemplate=function(e){return"string"==typeof e?e:e.text},t.addParams=function(t){var n=this;return t.replace(e.swapParamsForTagsRE(),function(e,t,r,i){var o=n.templateData[r];return ie.defaultTo("")(o)})},t.parseTheTmplLoop=function(t,n,r,i){var o=i,a=this.templateData[r];return!0===ie.isNil(a)||ie.isEmpty(a)?"":a.map(function(t){var n;return"string"==typeof t?(n=t,t=o.replace(e.swapParamsForTagsRE(),n)):t=function(t,n){return n.replace(e.swapParamsForTagsRE(),function(e,n,r){return t[r]})}(t,o),t}).join(" ")},e}();function ae(e){return e&&"object"==typeof e&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e)}function se(e,t){var n;return t&&!0===t.clone&&ae(e)?ue((n=e,Array.isArray(n)?[]:{}),e,t):e}function ce(e,t,n){var r=e.slice();return t.forEach(function(t,i){void 0===r[i]?r[i]=se(t,n):ae(t)?r[i]=ue(e[i],t,n):-1===e.indexOf(t)&&r.push(se(t,n))}),r}function ue(e,t,n){var r=Array.isArray(t),i=(n||{arrayMerge:ce}).arrayMerge||ce;return r?Array.isArray(e)?i(e,t,n):se(t,n):function(e,t,n){var r={};return ae(e)&&Object.keys(e).forEach(function(t){r[t]=se(e[t],n)}),Object.keys(t).forEach(function(i){ae(t[i])&&e[i]?r[i]=ue(e[i],t[i],n):r[i]=se(t[i],n)}),r}(e,t,n)}function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}ue.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce(function(e,n){return ue(e,n,t)})};var he=n(2),pe=function(){function e(e,t,n,r){void 0===e&&(e="div"),void 0===t&&(t={}),void 0===n&&(n=void 0),void 0===r&&(r=void 0),!0===he.is(String,t)&&(n=t,t={}),this.props=new Map,this.setProp("fragment",document.createDocumentFragment()),this.setProp("tagName",e),this.setProp("attrs",this.updateAttrs(t)),this.setProp("content",n),this.setProp("template",r),this.addMixins()}var t,n,r,i=e.prototype;return i.setProp=function(e,t){this.props.set(e,t)},i.getProp=function(e){return this.props.get(e)},i.setElAttrs=function(e,t){return this.getProp("attrs").forEach(function(t,n){"dataset"===n?he.forEachObjIndexed(function(t,n){e.dataset[n]=t},t):e.setAttribute(n,t)}),e},i.updateAttrs=function(e,t){var n=void 0!==t?t:new Map;return he.mapObjIndexed(function(e,t){return n.set(t,e)},e),n},i.addTemplate=function(e){var t=this,n=this.getProp("template");return void 0!==n?function(n){var r=t.getProp("content");r=he.is(Object,r)?r:{};var i=new oe(n,r).getTemplateNode();return e.appendChild(i),e}(n):function(e){return e}(e)},i.createElement=function(e){return void 0===e&&(e="div"),document.createElement(e)},i.addContent=function(e){var t=this.getProp("content");if(!0===he.is(String,t)){var n=document.createTextNode(t);e.appendChild(n)}return e},i.execute=function(){var e=he.pipe(this.createElement.bind(this),this.setElAttrs.bind(this),this.addTemplate.bind(this),this.addContent.bind(this))(this.getProp("tagName"));this.props.set("el",e)},i.render=function(){return this.execute(),this.getProp("el")},i.returnIfDefined=function(e,t){if(void 0!==t){var n=void 0===t;e[t]=!1===n?t:ue(e[va],t)}},i.updateprops=function(e){return this.returnIfDefined(this.props,e),this},i.updatepropsAndRun=function(e){return this.updateprops(e),this.execute(),this.getProp("fragment")},i.unmount=function(){void 0!==this.props&&(this.getProp("el").remove(),this.props.clear(),this.gc())},i.updateTag=function(e){void 0===e&&(e="div"),this.updateprops(e)},i.updateAttributes=function(e){void 0===e&&(e={}),this.updateprops(e)},i.updateTemplate=function(e){this.updateprops(e)},i.updateData=function(e){void 0===e&&(e={}),this.updateprops(e)},i.addTagAndRender=function(e){void 0===e&&(e="div"),this.updatepropsAndRun(e)},i.addAttrsibutesAndRender=function(e){void 0===e&&(e={}),this.updatepropsAndRun(e)},i.addTemplateAndRender=function(e){this.updatepropsAndRun(e)},i.addDataAndRender=function(e){void 0===e&&(e={}),this.updatepropsAndRun(e)},i.addMixins=function(){var e=re();this.gc=e.gc.bind(this)},t=e,(n=[{key:"el",get:function(){return this.props.get("el")}}])&&de(t.prototype,n),r&&de(t,r),e}(),le=function(e,t,n,r){return void 0===e&&(e=!1),void 0===t&&(t=1),void 0===n&&(n="ease"),void 0===r&&(r=!1),(!0===r?"opacity:0;":"")+"transition: opacity "+t+"s "+n+"; opacity: "+(!0===e?1:0)+";"};var fe=n(2),me=function(){function e(t){this.props.observableStreams=e.createDirectionalObservables()}return e.createDirectionalFiltersObject=function(){return{P:["parent"],C:["child"],PCI:["parent","internal","child"],CI:["child","internal"],PI:["parent","internal"],PC:["parent","child"]}},e.addDefaultDir=function(e){return fe.flip(fe.merge)({$dir:["internal"]},fe.clone(e))},e.addDownInternalDir=function(e,t){return void 0===t&&(t=["internal","down"]),fe.flip(fe.merge)(fe.clone(e),{$dir:t})},e.addChildAndInternalDir=function(e,t){return void 0===t&&(t=["child","down"]),fe.flip(fe.merge)(fe.clone(e),{$dir:t})},e.mapToDefaultDir=function(e){return this.addDefaultDir(e)},e.createDirectionalObservables=function(e,t,n){void 0===e&&(e=new O.Subject),void 0!==t&&void 0!==n&&(e.viewName=t,e.cid=n);var r=function(e){return fe.propSatisfies(function(t){return t.includes(e)},"$dir")},i=r("parent"),o=r("child"),a=r("internal"),s=function(e){return fe.merge({from$:e})},c=s("child"),u=s("internal"),d=s("parent"),h=e.pipe(Object(D.filter)(function(e){return void 0!==e&&void 0!==e.action})),p=e.pipe(Object(D.filter)(a),Object(D.map)(u)),l=e.pipe(Object(D.filter)(i),Object(D.map)(c)),f=e.pipe(Object(D.filter)(o),Object(D.map)(d)),m={parent:l,internal:p,child:f};return{raw$:h,toInternal$:p,toParent$:l,toChild$:f,completeAll:function(){fe.forEach(function(e){e.complete(),e.isStopped=!0},[h,p,l,f])},completeStream:function(e){void 0===e&&(e=[]);void 0!==e&&e.length>=1&&e.forEach(function(e){var t;void 0!==m[e]&&((t=m[e]).complete(),t.isStopped=!0)})}}},e}();function ve(e,t,n){return(ve=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Ee(i,n.prototype),i}).apply(null,arguments)}function Ee(e,t){return(Ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var be=n(2),ye=function(){function e(e,t,n,r){var i=this;void 0===t&&(t={}),void 0===n&&(n=""),void 0===r&&(r="theName"),this.addMixins(),this._state="INIT",this.cid=n,this.vsName=r,this.defaults={debug:!1,extendedHashMethods:{}},this.options=ue(this.defaults,t);this.addActionListeners().forEach(function(e){var t=e[0],n=e[1];i.options.extendedHashMethods[t]=function(e){return i[n](e)}}),this.options.hashMethods=this.setHashMethods(this.options.extendedHashMethods),this.sink$=e,this.sink$.subscribe(this.onSinkSubscribe.bind(this)),this.$dirs=me.createDirectionalFiltersObject(),this.addDefaultDir=me.addDefaultDir,this.sourceStreams=me.createDirectionalObservables(new O.Subject,this.vsName,this.cid),this._source$=this.sourceStreams.toInternal$}var t=e.prototype;return t.addActionListeners=function(){return[]},t.setHashMethods=function(e){var t=this;return void 0===e&&(e={}),ue({GARBAGE_COLLECT:function(e){return t.onGarbageCollect(e)},READY_FOR_GC:function(e){return t.onReadyForGC(e)},DISPOSE:function(e){return t.onDispose(e)},RENDER:function(e){return t.onRender(e)},RENDER_AND_ATTACH_TO_PARENT:function(e){return t.onRenderAndAttachToParent(e)},RENDER_AND_ATTACH_TO_DOM:function(e){return t.onRenderAndAttachToDom(e)},ATTACH_CHILD_TO_SELF:function(e){return t.onAttachChildToSelf(e)}},e)},t.createDomItem=function(){this.props=void 0!==this.props?this.props:{};var e=be.filter(function(e){return void 0!==e},be.pick(["id","className"],this.props));return new pe(this.props.tagName,e,this.props.data,this.props.template)},t.onDisposeCompleted=function(e){},t.animateInTween=function(e,t){!function(e,t){var n=1*window.getComputedStyle(e).opacity,r=le(!0,t,"ease",1===n);e.style.cssText+=r}(e,t)},t.animateOutTween=function(e,t,n){!function(e,t,n){var r=le(!1,t,"ease");e.style.cssText+=r,console.log(t," inline is ",r),e.addEventListener("transitionend",n,!1)}(e,t,n)},t.setAnimateIn=function(e){if(!0===e.animateIn){var t=void 0!==e.el?e.el:this.domItem.el;this.animateInTween(t,e.animateInTime)}},t.disposeMethod=function(e){var t=this,n=void 0!==e.el.el?e.el.el:e.el,r={action:"READY_FOR_GC",$dir:this.$dirs.PI,el:n},i=Object(O.bindCallback)(function(e,r){t.animateOutTween(n,e.animateOutTime,r)}),o=function(e){t._source$.next(r)};return(!0===e.animateOut?function(e){return i(e).subscribe(o),{action:"DISPOSING",$dir:t.$dirs.CI}}:function(){return{action:"DISPOSE_AND_READY_FOR_GC",$dir:t.$dirs.CI}})(e)},t.disposeMethod1=function(e){var t=this;return void 0!==e.animateOutClass?(function(){var n=void 0!==e.el.el?e.el.el:e.el,r={action:"READY_FOR_GC",$dir:t.$dirs.PI,el:n};e.el$.setClass(e.animateOutClass);O.Observable.fromEvent(n,"transitionend").filter(function(e){return e.target===n}).take(1).subscribe(function(){t._source$.next(r)})}(),{action:"DISPOSING",$dir:this.$dirs.CI}):{action:"DISPOSE_AND_READY_FOR_GC",$dir:t.$dirs.CI}},t.onDispose=function(e){return this.disposeMethod(e)},t.removeStream=function(){void 0!==this.sourceStreams&&this.sourceStreams.completeStream(["internal","child"])},t.onGarbageCollect9=function(e){var t="PageChildBox"===this.vsName?1e3:0;window.setTimeout(this.onGarbageCollectRun.bind(this),t)},t.onReadyForGC=function(e){this.removeStream()},t.onGarbageCollect=function(e){this.domItem.unmount(),void 0!==this.sourceStreams&&this.sourceStreams.completeStream(["parent"])},t.getSourceStream=function(){return this._source$},t.combineDomItems=function(e){var t=be.isNil(e.query)?e.node:e.query;("appendChild"===e.attachType?function(e,t){return e.appendChild(t)}:function(e,t){return e.insertBefore(t,e.firstChild)})(t,this.domItem.render()),this.setAnimateIn(e)},t.onAttachChildToSelf=function(e){var t=e.childRenderData;return this.combineDomItems(t),{action:"CHILD_ATTACHED",$dir:this.$dirs.PI}},t.onRenderAndAttachToParent=function(e){return this.onRender(e),this.combineDomItems(e),{action:"RENDERED_AND_ATTACHED_TO_PARENT",el:this.domItem.el,$dir:this.$dirs.PI}},t.renderDomItem=function(e){return this.domItem=ve(pe,e),this.domItem},t.onRender=function(e){var t,n=this;return{action:"RENDERED",el:(t=be.props(["tagName","domAttributes","data","template"],e),n.renderDomItem(t)),$dir:this.$dirs.I}},t.extendedMethods=function(e){},t.onRenderAndAttachToDom=function(e){var t,n=this;return e.attachData.el=(t=be.props(["tagName","domAttributes","data","template"],e),n.renderDomItem(t)),this.combineDomItems(e.attachData),{action:"RENDERED_AND_ATTACHED_TO_DOM",el:e.attachData.el.el,$dir:this.$dirs.CI}},t.onSinkSubscribe=function(e){var t,n=this,r=e.action,i=be.defaultTo(function(e){return n.extendedMethods(e)})(this.options.hashMethods[r])(e);void 0!==i&&(t=Object.freeze(i),n._source$.next(t))},t.addMixins=function(){var e=re();this.createId=e.createId,this.createpropsMap=e.createpropsMap,this.convertDomStringMapToObj=o,this.ifNilThenUpdate=s},e}(),Ne=n(2);function Se(){var e=this;setTimeout(function(){Ne.forEach(function(e){},e)},1)}n(2);var ge=function(){function e(e,t,n,r,i){void 0===r&&(r="subscribe"),void 0===i&&(i=!1),this.addMixins(),this.options={name:e,observable:t,data:n,action:r},this.getValidationChecks(e)}var t=e.prototype;return t.getValidationChecks=function(e){var t,n,r=this,i=window.Spyne.channels.map;return!0===i.has(e)?(n=N,r.onRunValidations(n)):(t="payload Needs a Valid Stream Name!",console.warn(t))},t.onRunValidations=function(e){X(e(),this.options).fold(this.onError.bind(this),this.onSuccess.bind(this))},t.onPayloadValidated=function(e){this.sendToDirectorStream(e)},t.sendToDirectorStream=function(e){window.Spyne.channels.getStream("DISPATCHER").next(e),this.gc()},t.onError=function(e){console.warn("payload failed due to:\n"+e.map(function(e){return"* "+e}).join("\n")),this.gc()},t.onSuccess=function(e){this.onPayloadValidated(e)},t.addMixins=function(){this.gc=Se},e}();function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ae=function(){function e(e,t,n,r,i,o){void 0===i&&(i={}),void 0===o&&(o=!0),this.addMixins(),this.options={name:e,STEP:t,type:n,viewId:r,data:i},this.getValidationChecks(t)}var t,n,r,i=e.prototype;return i.getValidationChecks=function(e){var t=this;return function(e,t,n){void 0===n&&(n=null);var r=e[t];return r?a(r):c(n)}({LOAD:S,RENDER:S,MOUNT:S,DISPOSE:g,UNMOUNT:S,GARBAGE_COLLECT:S,UPDATE:_},e,"lifestream payload Needs a Valid Stream Name!").fold(function(e){return console.warn(e)},function(e){return t.onRunValidations(e)})},i.onRunValidations=function(e){X(e(),this.options).fold(this.onError.bind(this),this.onSuccess.bind(this))},i.onPayloadValidated=function(e){return this._data=e,e},i.onError=function(e){console.error("payload failed due to:\n"+e.map(function(e){return"* "+e}).join("\n")),this.gc()},i.onSuccess=function(e){this.onPayloadValidated(e)},i.addMixins=function(){this.gc=Se},t=e,(n=[{key:"data",get:function(){return this._data}}])&&_e(t.prototype,n),r&&_e(t,r),e}(),Te=n(2);function Ce(){return{testFunc:function(e){console.log("stream mixin is ",e)},sendRoutePayload:function(e,t){return new ge("CHANNEL_ROUTE",e,t,"subscribe")},sendUIPayload:function(e,t){return new ge("CHANNEL_UI",e,t,"subscribe")},sendChannelPayload:function(e,t){var n=this,r=function(e){return Te.prop(e,n.props)},i={payload:t,channel:e,srcElement:{cid:r("cid"),el:r("el"),viewName:r("name")}};return new ge(e,new O.Observable.of(""),i,"subscribe")},sendLifeStreamPayload:function(e,t){return new ge("LIFESTREAM",e,t,"subscribe")},createLifeStreamPayload:function(e,t,n){void 0===t&&(t={}),void 0===n&&(n="parent");var r=this.props.name+": "+this.props.cid;return new Ae("LIFESTREAM",e,n,r,t).data}}}var Oe=n(2),De=function(){function e(e,t){this.context=e,this.enhancersMap=new Map,this.enhancersArr=t,this.initMap(),this.addAllEnhancerMethods()}var t=e.prototype;return t.initMap=function(){this.enhancersMap.set("ALL",[]);var e=u(this.context).allMethods;this.updateMap("LOCAL",e)},t.getEnhancersMap=function(){return this.enhancersMap},t.updateMap=function(e,t){var n=Oe.concat(this.enhancersMap.get("ALL"),t);this.enhancersMap.set(e,t),this.enhancersMap.set("ALL",n)},t.getMethodsArr=function(e){return this.enhancersMap.get(e)},t.createEnhancerMethodsObj=function(e){var t,n,r,i=this,o=function(e){return console.error('Spyne Error: The following enhancer method, "'+e+'", already exists and cannot be added to the '+a.name+" Enhancer!")},a=new e(this.context),s=a.getEnhancerMethods(),c=(t=s.allMethods,n=Oe.contains(Oe.__,i.getMethodsArr("ALL")),(r=Oe.filter(n,t)).forEach(o),r),u=Oe.dropWhile(Oe.contains(Oe.__,c));return s=Oe.map(u,s),this.updateMap(a.name,s.allMethods),s.enhancer=a,s.name=a.name,s},t.addAllEnhancerMethods=function(){var e=this;Oe.forEach(function(t){var n=e.createEnhancerMethodsObj(t);n.enhancer.bindParentViewStream(n,e.context)},this.enhancersArr)},e}(),Ie=n(2),we=function(){function e(e,t){this.addMixins(),this.props=e,this.broadcastFn=t,this.broadcaster(this.broadcastFn)}var t=e.prototype;return t.addDblClickEvt=function(e){return Object(O.fromEvent)(e,"dblclick").pipe(Object(D.map)(function(e){var t=Ie.clone(e);return t.typeOverRide="dblclick",t}))},t.broadcast=function(e){var t,n,r=this,i={UI:this.sendUIPayload,ROUTE:this.sendRoutePayload},a=e[0],s=e[1],c=e[2],u=this.props.el.querySelectorAll(a);if(u.length<=0){var d=this.props.el,h=function(e){e===d&&(u=[e])};(n=(null!==d.parentElement?d.parentElement:document).querySelectorAll(a)).forEach=Array.prototype.forEach,n.forEach(h)}var p=void 0!==c;void 0===u||u.length<=0?console.warn("Spyne Warning: The item "+a+", does not appear to exist!"):(u.forEach=Array.prototype.forEach,u.forEach(function(e){var n="dblClick"!==s?Object(O.fromEvent)(e,s,{preventDefault:function(){return!0}}):r.addDblClickEvt(e);t=e.dataset.channel;var a={};a.payload=o(e.dataset),a.payload=Ie.omit(["channel"],a.payload),a.channel=t,a.srcElement={},a.srcElement.cid=r.props.id,a.srcElement.isLocalEvent=p,a.srcElement.viewName=r.props.name,a.srcElement.srcEvent=s,a.srcElement.el=e,(void 0!==t?i[t]:i.UI)(n,a)}))},t.broadcaster=function(e){var t=this;e().forEach(function(e){return t.broadcast(e)})},t.addMixins=function(){var e=Ce();this.sendUIPayload=e.sendUIPayload,this.sendRoutePayload=e.sendRoutePayload,this.createLifeStreamPayload=e.createLifeStreamPayload},e}(),Re=n(2),Le=function(){function e(t,n){var r=Re.is(String,t)?e.filterSelector([t]):void 0,i=Re.is(Array,t)?e.filterSelector(t):void 0,o=Re.is(Object,n)?e.filterData(n):void 0,a=Re.reject(Re.isNil,[r,i,o]);return Re.allPass(a)}return e.filterData=function(e){return function(){if(Re.isEmpty(e))return Re.always(!1);var t=Re.compose(Re.values,Re.map(Re.type))(e);!0==Re.uniq(t).length>1&&console.warn("Spyne Warningd: The data values in ChannelActionFilters needs to be either all methods or all static values.  DATA: ",e);var n=!0===Re.all(Re.equals("Function"),t)?Re.where(e):Re.whereEq(e);return Re.compose(n,Re.defaultTo({}))}()},e.checkPayloadSelector=function(e,t){var n=Re.path(["el"],t),r=function(e){return e.isEqualNode(n)};if("object"!=typeof n)return!1;var i=Re.compose(Re.flatten,Re.map(function(e){var t=Re.flatten(document.querySelectorAll(e));return Re.map(r,t)}))(e);return!0!==Re.isEmpty(i)&&Re.any(Re.equals(!0),i)},e.filterSelector=function(t){var n=Re.reject(Re.isEmpty,t);return Re.curry(e.checkPayloadSelector)(n)},e}();function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Me=n(2),Ve=function(){function e(t,n){this.mainEl="string"==typeof t?document.querySelectorAll(t):t,this.queryStr=n,1===this.mainEl.length?this.mainEl=Me.head(this.mainEl):"NodeList"===this.mainEl.constructor.name&&(this.mainEl=e.createArrayFromNodeList(this.mainEl));var r=Me.either(Me.isNil,Me.isEmpty)(n);this._el=r?this.mainEl:this.getElFromQuery(this.mainEl,n),1===this._el.length?this._el=Me.head(this._el):"NodeList"===this.el.constructor.name&&(this._el=e.createArrayFromNodeList(this._el)),this.createMethods()}e.createArrayFromNodeList=function(e){return Me.reduce(function(e,t){return e.push(t),e},[],e)};var t,n,r,i=e.prototype;return i.createMethods=function(){this.addClass=this.mapToValue(function(e,t){void 0!==e&&void 0!==e.classList&&void 0!==t&&e.classList.add(t)}),this.removeClass=this.mapToValue(function(e,t){void 0!==e&&void 0!==e.classList&&void 0!==t&&e.classList.remove(t)}),this.setClass=this.mapToValue(function(e,t){return e.classList.value=t,e}),this.inlineCss=this.mapToValue(function(e,t){return e.style.cssText=t,e}),this.toggleClass=this.mapToValue(function(e,t,n){return void 0===n&&(n=!0),e.classList.toggle(t,n),e}),this.toggleEls=this.mapToValue(function(e,t,n){var r=e===n;return e.classList.toggle(t,r),e})},i.mapMethod=function(e){var t=this;return function(n){return t.elArr.map(e),t}},i.addAnimClass=function(e){var t=this,n=function(){return t.addClass(e)};return requestAnimationFrame(function(){setTimeout(n,0)}),this},i.mapToValue=function(e){var t=this;return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return t.elArr.map(function(t){return e.apply(void 0,[t,n].concat(i))}),t}},i.setClassOnBool=function(e,t){return void 0===e&&(e=""),void 0===t&&(t=!0),t?this.addClass(e):this.removeClass(e),this},i.setActiveItem=function(e,t){var n=document.querySelector(this.queryStr+e),r=Me.ifElse(function(e){return e===n},function(e){void 0!==e&&e.classList.add(t)},function(e){void 0!==e&&e.classList.remove(t)});this.elArr.map(r)},i.getElFromQuery=function(e,t){if(null!==e.querySelector(t))return e.querySelectorAll(t);var n=this._el.getAttribute("id");return console.warn('Spyne Warning: the element, "'+t+'" does not exist in this element, "'+n+'"!'),{el:void 0}},i.query=function(t){if(null!==this._el.querySelector(t))return new e(this._el,t);var n=this._el.getAttribute("id");return console.warn('Spyne Warning: the element, "'+t+'" does not exist in this element, "'+n+'"!'),{el:void 0}},i.getEl=function(){return this._el},i.unmount=function(){this._el=void 0,this.cList=void 0,this.inline=void 0},t=e,(n=[{key:"el",get:function(){return this._el}},{key:"elArr",get:function(){return"NodeList"===this._el.constructor.name?e.createArrayFromNodeList(this._el):[].concat(this._el)}}])&&Pe(t.prototype,n),r&&Pe(t,r),e}();function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var He=n(2),je=function(){function e(e){var t=this;void 0===e&&(e={}),this.checker=Math.random(),this.addMixins(),this.defaults=function(){var n=t.createId(),r=e.id?e.id:n;return{cid:n,id:r,tagName:"div",el:void 0,data:void 0,animateIn:!1,animateInTime:.5,animateOut:!1,animateOutTime:.5,sendLifecyleEvents:!1,hashId:"#"+r,viewClass:ye,extendedSourcesHashMethods:{},debug:!1,template:void 0,node:document.createDocumentFragment(),name:i(t)}},this._state={},this.$dirs=me.createDirectionalFiltersObject(),this.addDefaultDirection=me.addDefaultDir,this.addDownInternalDir=me.addDownInternalDir,this.props=ue(this.defaults(),e),this.sendLifecycleMethod=!0===this.props.sendLifecyleEvents?this.sendLifecycleMethodActive.bind(this):this.sendLifecycleMethodInactive.bind(this);var n=["id","class","dataset"];this.props.domAttributes=He.pick(n,this.props),this.loadEnhancers(),this.loadAllMethods(),this.props.action="LOADED",this.sink$=new O.Subject;var r=this.props.viewClass;this.view=new r(this.sink$,{},this.props.cid,this.constructor.name),this.sourceStreams=this.view.sourceStreams,this._rawSource$=this.view.getSourceStream(),this._rawSource$.viewName=this.props.name,this.sendEventsDownStream=this.sendEventsDownStreamFn,this.initViewStream(),this.checkIfElementAlreadyExists()}var t,n,a,c=e.prototype;return c.updatePropsToMatchEl=function(){var e=He.compose(He.toLower,He.either(He.prop("tagName"),He.always("")));this.props.tagName=e(this.props.el)},c.checkIfElementAlreadyExists=function(){var e=He.compose(He.lte(0),He.defaultTo(-1),He.prop("nodeType"));He.propSatisfies(He.allPass([function(e){return document.contains(e)},e]),"el")(this.props)&&(this.updatePropsToMatchEl(),this.postRender())},c.loadEnhancers=function(e){void 0===e&&(e=[]);var t=new De(this,e);this.props.enhancersMap=t.getEnhancersMap(),t=void 0},c.loadAllMethods=function(){var e=this,t=He.curry(this.onChannelMethodCall.bind(this));this.addActionListeners().forEach(function(n){var r=n[0],i=n[1],o=n[2];He.is(String,o)&&(o=Le(o)),e.props.extendedSourcesHashMethods[r]=t(i,o)}),this.props.hashSourceMethods=this.setSourceHashMethods(this.props.extendedSourcesHashMethods)},c.addActionListeners=function(){return[]},c.onChannelMethodCall=function(e,t,n){if(void 0!==n.$dir&&n.$dir.includes("child")&&!0!==this.deleted){var r=ue({},n);r.$dir=this.$dirs.C,this.sourceStreams.raw$.next(r)}!0===He.defaultTo(He.always(!0),t)(n.props())&&this[e](n)},c.setSourceHashMethods=function(e){var t=this;void 0===e&&(e={});var n={DISPOSING:function(e){return t.checkParentDispose(e)},DISPOSE:function(e){return t.disposeViewStreamChain(e)},RENDERED:function(e){return t.onRendered(e)},RENDERED_AND_ATTACHED_TO_DOM:function(e){return t.onRendered(e)},RENDERED_AND_ATTACHED_TO_PARENT:function(e){return t.onRendered(e)},READY_FOR_GC:function(e){return t.onReadyToGC(e)},NOTHING:function(){return{}}};return ue.all([{},n,e])},c.initViewStream=function(){var e=this;this._source$=this._rawSource$.pipe(Object(D.map)(function(t){return e.onMapViewSource(t)}),Object(D.takeWhile)(this.notGCSTATE)),this.initAutoMergeSourceStreams(),this.updateSourceSubscription(this._source$,!0)},c.notGCSTATE=function(e){return!e.action.includes("READY_FOR_GC")},c.eqGCSTATE=function(e){return!e.action.includes("READY_FOR_GC")},c.notCOMPLETED=function(e){return!e.action.includes("COMPLETED")},c.notGCCOMPLETE=function(e){return!e.action.includes("GC_COMPLETE")},c.testVal=function(e){console.log("TESTING VALL IS ",e)},c.addParentStream=function(e,t){var n=this;this.parent$=e.pipe(Object(D.filter)(function(e){return void 0!==e&&void 0!==e.action}),Object(D.map)(function(e){var t=ue({},e);return"DISPOSE_AND_READY_FOR_GC"===t.action&&(n.disposeViewStreamChain(t),t.action="READY_FOR_GC"),t}),Object(D.takeWhile)(this.notGCCOMPLETE)),this.updateSourceSubscription(this.parent$,!1,"PARENT"),this.renderAndAttachToParent(t)},c.addChildStream=function(e){var t=this,n=e.pipe(Object(D.filter)(function(e){return void 0!==e&&void 0!==e.action}),Object(D.tap)(function(e){return t.tracer("addChildStraem do ",e)}),Object(D.map)(function(e){return e}),Object(D.finalize)(function(e){return t.onChildCompleted(n.source)}));this.updateSourceSubscription(n,!0,"CHILD")},c.onChildDisposed=function(e){},c.onChildCompleted=function(e){var t,n=(t=e,He.pick(["viewName","cid"],function e(t){for(;void 0!==t.destination;)t=e(t.destination);return t}(t)));return this.tracer("onChildCompleted ",this.checker,e),this.onChildDisposed(n,e),n},c.initAutoMergeSourceStreams=function(){var e=this,t={next:this.onSubscribeToSourcesNext.bind(this),error:this.onSubscribeToSourcesError.bind(this),complete:this.onSubscribeToSourcesComplete.bind(this)},n=function(){0===(r-=1)&&(e.props.el$=void 0,e.uberSource$.complete(),e.autoSubscriber$.complete(),e.sink$.complete(),e.props=void 0,e.deleted=!0,e.tracer("completeAll",e.deleted,e.props))},r=0;this.uberSource$=new O.Subject;this.autoMergeSubject$=this.uberSource$.pipe(Object(D.mergeMap)(function(t){var i=t.observable.pipe(Object(D.filter)(function(e){return void 0!==e&&void 0!==e.action}),Object(D.map)(function(t){var n=ue({},t);return n.action=t.action,e.tracer("autoMergeSubject$",n),n}));return!1===t.autoClosesBool?i:(r+=1,i.pipe(Object(D.finalize)(n)))})),this.autoSubscriber$=this.autoMergeSubject$.pipe(Object(D.filter)(function(e){return void 0!==e&&void 0!==e.action})).subscribe(t)},c.updateSourceSubscription=function(e,t,n){void 0===t&&(t=!1);var r={observable:e,autoClosesBool:t,rel:n};this.tracer("updateSourceSubscription ",this.checker,r),this.uberSource$.next(r)},c.onSubscribeToSourcesNext=function(e){var t=this;void 0===e&&(e={});var n=He.defaultTo(function(e){return t.sendExtendedStreams(e)}),i=function(e,t){if(void 0!==e[t])return t;return r.compose(r.head,r.filter(r.compose(r.test(r.__,t),function(e){return new RegExp(e)})))(r.keys(e))}(this.props.hashSourceMethods,e.action);n(this.props.hashSourceMethods[i])(e),this.tracer("onSubscribeToSourcesNext",{payload:e})},c.onSubscribeToSourcesError=function(e){void 0===e&&(e=""),console.log("ALL ERROR  ",this.constructor.name,e)},c.onSubscribeToSourcesComplete=function(){this.tracer("onSubscribeToSourcesComplete","GARBAGE_COLLECT"),this.openSpigot("GARBAGE_COLLECT")},c.sendExtendedStreams=function(e){this.tracer("sendExtendedStreams",e),this.openSpigot(e.action,e)},c.renderAndAttachToParent=function(e){this.openSpigot("RENDER_AND_ATTACH_TO_PARENT",e)},c.renderView=function(){this.openSpigot("RENDER")},c.renderViewAndAttachToDom=function(e,t,n){var r={node:e,type:t,attachType:n};this.openSpigot("RENDER_AND_ATTACH_TO_DOM",{attachData:r})},c.attachChildToView=function(e){},c.checkParentDispose=function(e){"parent"===e.from$&&this.disposeViewStreamChain(e)},c.onBeforeDispose=function(){},c.disposeViewStreamChain=function(e){this.onBeforeDispose(),this.openSpigot("DISPOSE")},c.onChildDispose=function(e){},c.onParentDisposing=function(e){this.openSpigot("DISPOSE")},c.onReadyToGC=function(e){var t=void 0!==e.from$&&"internal"===e.from$;this.tracer("onReadyToGC",t,e)},c.sendEventsDownStreamFn=function(e,t){void 0===t&&(t={});var n=ue({action:t},e);n.$dir=this.$dirs.C,this.sourceStreams.raw$.next(n)},c.openSpigot=function(e,t){if(void 0===t&&(t={}),void 0!==this.props){this.props.action=e;var n=He.merge(this.props,t);this.sink$.next(Object.freeze(n))}},c.setAttachData=function(e,t){return{node:this.props.el,type:"ViewToDomMediator",attachType:e,query:this.props.el.querySelector(t)}},c.getParentEls=function(e,t){for(var n=function(e){return e.parentElement},r=0,i=e;r<t;)i=n(i),r++;return i},c.setAttachParentData=function(e,t,n){return{node:this.getParentEls(this.props.el,n),type:"ViewToDomMediator",attachType:e,query:this.props.el.parentElement.querySelector(t)}},c.onMapViewSource=function(e){return void 0===e&&(e={}),this.props=He.merge(this.props,e),e},c.exchangeViewsWithChild=function(e,t){this.addChildStream(e.sourceStreams.toParent$),e.addParentStream(this.sourceStreams.toChild$,t)},c.appendToDom=function(e){this.renderViewAndAttachToDom(e,"dom","appendChild")},c.prependToDom=function(e){this.renderViewAndAttachToDom(e,"dom","prependChild")},c.appendView=function(e,t){this.exchangeViewsWithChild(e,this.setAttachData("appendChild",t))},c.appendViewToParent=function(e,t,n){void 0===n&&(n=1),this.exchangeViewsWithChild(e,this.setAttachParentData("appendChild",t,n))},c.prependViewToParent=function(e,t,n){void 0===n&&(n=1),this.exchangeViewsWithChild(e,this.setAttachParentData("prependChild",t,n))},c.prependView=function(e,t){this.exchangeViewsWithChild(e,this.setAttachData("prependChild",t))},c.appendToNull=function(){var e=document.getElementById("spyne-null-views");this.renderViewAndAttachToDom(e,"dom","appendChild")},c.onRendered=function(e){"internal"===e.from$&&this.postRender()},c.postRender=function(){this.beforeAfterRender(),this.afterRender(),this.viewsStreamBroadcaster=new we(this.props,this.broadcastEvents)},c.beforeAfterRender=function(){var e;this.props.el$=(e=this.props.el,function(t){return void 0===t&&(t=""),new Ve(e,t)})},c.downStream=function(){},c.afterRender=function(){},c.broadcastEvents=function(){return[]},c.getChannel=function(e){var t=this;return He.ifElse(function(e){return l().includes(e)},function(e){return window.Spyne.channels.getStream(e).observer.pipe(Object(D.takeWhile)(function(e){return!0!==t.deleted}))},function(e){return console.warn("channel name "+e+" is not within "+l)})(e)},c.addChannel=function(e,t,n){var r=this;void 0===t&&(t=!1),void 0===n&&(n=!1);var i=!0===t?this.$dirs.CI:this.$dirs.I,o=He.path(["srcElement","isLocalEvent"]),a=He.path(["srcElement","cid"]),s=this.getChannel(e).pipe(Object(D.map)(function(e){var t=He.defaultTo({},He.clone(e));return ue({$dir:i},t)}),Object(D.filter)(function(e){var t=a(e);return!0!==o(e)||t===r.props.cid}));this.updateSourceSubscription(s,!1)},c.checkIfChannelExists=function(e){var t=void 0!==window.Spyne.channels.map.get(e);return!0!==t&&console.warn("SPYNE WARNING: The ChannelPayload from "+this.props.name+", has been sent to a channel, "+e+", that has not been registered!"),t},c.sendChannelPayload=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n="VIEWSTREAM_EVENT");var r={payload:t,action:n,srcElement:{}};if(r.srcElement.cid=He.path(["props","cid"],this),r.srcElement.id=He.path(["props","id"],this),r.srcElement.isLocalEvent=!1,r.srcElement.viewName=this.props.name,!0===this.checkIfChannelExists(e)){var i=Object(O.of)(r);return new ge(e,i,r)}},c.tracer=function(){this.sendLifecycleMethod.apply(this,arguments)},c.sendLifecycleMethodInactive=function(){},c.sendLifecycleMethodActive=function(e,t){He.path(["props","cid"],this),He.prop("action",t);var n="GARBAGE_COLLECT"===t;!0===He.where({from$:He.equals("internal"),action:He.equals("RENDERED_AND_ATTACHED_TO_PARENT")},t)?this.sendChannelPayload("CHANNEL_VIEWSTREAM_LIFECYCLE",{action:"CHANNEL_VIEWSTREAM_LIFECYCLE_RENDERED_EVENT"},"CHANNEL_VIEWSTREAM_LIFECYCLE_RENDERED_EVENT"):!0===n&&this.sendChannelPayload("CHANNEL_VIEWSTREAM_LIFECYCLE",{action:"CHANNEL_VIEWSTREAM_LIFECYCLE_REMOVED_EVENT"},"CHANNEL_VIEWSTREAM_LIFECYCLE_REMOVED_EVENT")},c.createActionFilter=function(e,t){return new Le(e,t)},c.isLocalEvent=function(e){return void 0!==He.path(["srcElement","el"],e)&&this.props.el.contains(e.srcElement.el)},c.addMixins=function(){var e=re();this.createId=e.createId,this.createpropsMap=e.createpropsMap,this.convertDomStringMapToObj=o,this.ifNilThenUpdate=s;var t=Ce();this.sendUIPayload=t.sendUIPayload,this.sendRoutePayload=t.sendRoutePayload,this.createLifeStreamPayload=t.createLifeStreamPayload},t=e,(n=[{key:"source$",get:function(){return this._source$}}])&&Fe(t.prototype,n),a&&Fe(t,a),e}(),We=n(2),xe=function(){function e(e,t){void 0===t&&(t=!0),this.parentViewStream=e,this.omittedMethods=["autoBinder","initAutoBinder","getEnhancerMethods","bindParentViewStream"],!0===t&&this.autoBinder()}var t=e.prototype;return t.initAutoBinder=function(){},t.getEnhancerMethods=function(){return u(this,this.omittedMethods)},t.bindParentViewStream=function(e,t){var n=this,r=function(e,r){void 0===r&&(r=!1);var i,o=!0===r?n.constructor:n;"function"===typeof o[e]&&(t[i=e]=o[i].bind(t))},i=We.curryN(2,r)(We.__,!0);We.forEach(i,e.staticMethods),We.forEach(r,e.methods)},t.autoBinder=function(){var e=this.getEnhancerMethods();this.bindParentViewStream(e,this.parentViewStream)},e}();function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $e=n(2),Ue=function(){function e(t,n,r){this._mapFn=e.setMapFn(t),this._url=e.setUrl(t),this._responseType=e.setResponseType(t),this._serverOptions=e.setServerOptions(t),this._subscriber=void 0!==n?n:function(e){return console.log("FETCH RETURNED ",e)},this.debug=void 0!==t.debug&&t.debug;var i={mapFn:this.mapFn,url:this.url,serverOptions:this.serverOptions,responseType:this.responseType,debug:this.debug};!0!==r&&e.startWindowFetch(i,this._subscriber)}var t,n,r;return e.startWindowFetch=function(e,t){var n=e.mapFn,r=e.url,i=e.serverOptions,o=e.responseType,a=!0===e.debug?function(e){return console.log("DEBUG FETCH :",e)}:function(){},s=Object(O.from)(window.fetch(r,i)).pipe(Object(D.tap)(a),Object(D.flatMap)(function(e){return Object(O.from)(e[o]())}),Object(D.map)(n),Object(D.publish)());s.connect(),s.subscribe(t)},e.setMapFn=function(e){return $e.compose($e.defaultTo(function(e){return e}),$e.prop("mapFn"))(e)},e.setUrl=function(e){var t=$e.prop("url",e);return void 0===t&&console.warn("SPYNE WARNING: URL is undefined for data channel"),t},e.setResponseType=function(e){return $e.defaultTo("json",$e.prop("responseType",e))},e.stringifyBodyIfItExists=function(e){return $e.when($e.propIs(Object,"body"),$e.compose($e.over($e.lensProp("body"),JSON.stringify)))(e)},e.updateMethodWhenBodyExists=function(e){var t=$e.has("body"),n=$e.propEq("method","GET"),r=$e.allPass([t,n]);return $e.when(r,$e.assoc("method","POST"))(e)},e.setServerOptions=function(t){var n=$e.pick(["header","body","mode","method"],t),r=$e.mergeDeepRight(e.baseOptions(),n);return r=e.updateMethodWhenBodyExists(r),r=e.stringifyBodyIfItExists(r)},e.baseOptions=function(){return{method:"GET",headers:{"Content-type":"application/json; charset=UTF-8"}}},t=e,(n=[{key:"mapFn",get:function(){return this._mapFn}},{key:"url",get:function(){return this._url}},{key:"serverOptions",get:function(){return this._serverOptions}},{key:"responseType",get:function(){return this._responseType}}])&&ke(t.prototype,n),r&&ke(t,r),e}();function Ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var qe=function(e){var t,n;function r(t,n){return void 0===n&&(n={}),n.sendLastPayload=!0,e.call(this,t,n)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i,o,a,s=r.prototype;return s.onStreamInitialized=function(){this.startFetch()},s.addRegisteredActions=function(){return["CHANNEL_DATA_EVENT",["CHANNEL_UPDATE_DATA_EVENT","onFetchUpdate"]]},s.startFetch=function(e,t){void 0===e&&(e={}),void 0===t&&(t=this.onFetchReturned.bind(this));var n=this.consolidateAllFetchProps(e);new Ue(n,t)},s.onFetchUpdate=function(e){var t=this.getPropsForFetch(e);this.startFetch(t)},s.onFetchReturned=function(e){var t=this.createChannelStreamItem(e);this.observer$.next(t)},s.createChannelStreamItem=function(e,t){return void 0===t&&(t="CHANNEL_DATA_EVENT"),new C(this.props.name,t,e)},s.getPropsForFetch=function(e){var t=R.path(["observableData","payload"],e);return R.pick(["mapFn","url","header","body","mode","method","responseType","debug"],t)},s.consolidateAllFetchProps=function(e,t){void 0===t&&(t=this.props);var n=R.pick(["mapFn","url","header","body","mode","method","responseType","debug"],t),r=R.reject(R.isNil);return R.compose(r,function(e,t){return R.mergeDeepRight(e,t)})(n,e)},i=r,(o=[{key:"observer",get:function(){return this.observer$}}])&&Ge(i.prototype,o),a&&Ge(i,a),r}(L);n.d(t,"SpyneApp",function(){return Be}),n.d(t,"ViewToDomMediator",function(){return ye}),n.d(t,"ChannelsBase",function(){return L}),n.d(t,"ChannelsBaseData",function(){return qe}),n.d(t,"ChannelsBaseController",function(){return ne}),n.d(t,"ChannelsPayload",function(){return ge}),n.d(t,"ChannelStreamItem",function(){return C}),n.d(t,"DomItem",function(){return pe}),n.d(t,"ViewStream",function(){return je}),n.d(t,"ViewStreamBroadcaster",function(){return we}),n.d(t,"SpyneTrait",function(){return xe}),n.d(t,"deepMerge",function(){return ue});var Be=function(){function e(e){var t=this;void 0===e&&(e={}),this.channels=new ne,this.VERSION="0.9.8",this.ViewStream=je,this.BasicView=ye,this.DomItem=pe,this.ViewStreamBroadcaster=we,this.ChannelsPayload=ge,this.ChannelsBaseController=ne,this.ChannelsBase=L,this.ChannelStreamItem=C,window.Spyne=this;void 0!==e&&(window.Spyne.config=ue({channels:{WINDOW:{mediqQueries:{},events:[],listenForResize:!0,listenForOrientation:!0,listenForScroll:!0,listenForMouseWheel:!1,debounceMSTimeForResize:200,debounceMSTimeForScroll:150},ROUTE:{type:"slash",isHash:!1,isHidden:!1,routes:{routePath:{routeName:"change"}}}}},e)),this.getChannelActions=function(e){return window.Spyne.channels.getChannelActions(e)},this.registerChannel=function(e){return t.channels.registerStream(e)},this.registerDataChannel=function(e){return t.channels.registerStream(e)};var n=new je({id:"spyne-null-views"});n.appendToDom(document.body),n.props.el.style.cssText="display:none; opacity:0; pointer-events:none;",this.channels.init()}return e.getChannelActions=function(e){return window.Spyne.channels.getChannelActions(e)},e.registerChannel=function(e){if(void 0!==window.Spyne)return window.Spyne.channels.registerStream(e);console.warn("Spyne has not been initialized")},e}();window.Spyne=Be}])});