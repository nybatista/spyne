!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("ramda"),require("rxjs")):"function"==typeof define&&define.amd?define("spyne",["ramda","rxjs"],t):"object"==typeof exports?exports.spyne=t(require("ramda"),require("rxjs")):e.spyne=t(e.R,e.Rx)}(window,function(e,t){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=33)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertDomStringMapToObj=t.subscribeFn=t.removeSlashes=t.ifNilThenUpdate=t.findInObj=t.fromNullable=t.left=t.right=t.pullParams=t.pullMainRoute=t.pullTranslateX=t.pullTranslateY=t.closest=t.pullHashAndSlashFromPath=t.pullSlashFromPath=t.pullTranslateYFromHeader=t.pullRouteInfo=t.isIOS=t.checkIfObjIsNotEmptyOrNil=t.findStrFromRegexArr=t.findStrOrRegexMatchStr=t.getAllMethodNames=void 0;var r=n(0);t.isIOS=function(){var e=window.navigator.userAgent.toLowerCase();return!0===/iphone|ipod|ipad/.test(e)};t.findStrFromRegexArr=function(e,t){if(void 0!==e[t])return t;var n=r.contains(t),o=r.compose(r.contains(!0),r.map(function(e){return r.test(new RegExp(e),t)}));return r.cond([[n,function(){return t}],[o,function(){return t}],[r.T,function(){}]])(e)};t.findStrOrRegexMatchStr=function(e,t){if(void 0!==e[t])return t;return r.compose(r.head,r.filter(r.compose(r.test(r.__,t),function(e){return new RegExp(e)})))(r.keys(e))};t.closest=function(e,t){var n,r=0,o=1e3;for(r in e){var i=Math.abs(t-e[r]);i<o&&(o=i,n=e[r])}return n};t.convertDomStringMapToObj=function(e){var t={};for(var n in e)t[n]=e[n];return t};var o={next:function(e){return console.log("next      "+e)},error:function(e){return console.log("error     "+e)},complete:function(e){return console.log("complete  "+e)}};t.subscribeFn=o;var i=function e(t){return{map:function(n){return e(n(t))},fold:function(e,n){return n(t)},inspect:function(){return"right("+t+")"}}};t.right=i;t.ifNilThenUpdate=function(e,t){return r.isNil(e)?t:e};var a=function e(t){return{map:function(n){return e(t)},fold:function(e,n){return e(t)},inspect:function(){return"left("+t+")"}}};t.left=a;t.checkIfObjIsNotEmptyOrNil=function(e){var t=r.compose(r.complement(r.isEmpty),r.head,r.values),n=r.compose(r.complement(r.isNil),r.head,r.values);return r.allPass([t,n])(e)};t.fromNullable=function(e){return null!==e?i(e):a(null)};t.findInObj=function(e,t,n){void 0===n&&(n=null);var r=e[t];return r?i(r):a(n)};t.pullRouteInfo=function(){var e=u(window.location.hash);return{routeId:c(e),params:d(e)}};t.getAllMethodNames=function(e,t){void 0===e&&(e=void 0),void 0===t&&(t=[]);t=r.concat(["length","name","prototype","constructor"],t);var n=r.compose(r.without(t),r.uniq),o=n(Object.getOwnPropertyNames(e.constructor.prototype)),i=n(function(e,t){return void 0===e&&(e=void 0),void 0===t&&(t=[]),Object.getOwnPropertyNames(e)}(e.constructor));return{methods:o,staticMethods:i,allMethods:r.concat(o,i)}};t.removeSlashes=function(e){return e.replace(/^(\/)(.*)/g,"$2")};var s=/^(\/?)(\w*)(\/?)(.*)/g,u=function(e){return e.replace(/^(#\/?)(.*)/,"$2")};t.pullHashAndSlashFromPath=u;t.pullSlashFromPath=function(e){return e.replace(/^(\/?)(.*)/,"$2")};var c=function(e){return e.replace(s,"$2")};t.pullMainRoute=c;var d=function(e){return e.replace(s,"$4")};t.pullParams=d;t.pullTranslateX=function(e){return e.replace(/^(matrix)(.*\d*,)(.*\d*,)(.*\d*,)(.*\d*,)(.*\d*)(,.*)/,"$6")};t.pullTranslateY=function(e){return e.replace(/^(matrix)(.*\d*,)(.*\d*,)(.*\d*,)(.*\d*,)(.*\d*,)(.*\d)(.*)/,"$7")};t.pullTranslateYFromHeader=function(e){return e.replace(/^(transform: matrix)(.*\d*,)(.*\d*,)(.*\d*,)(.*\d*,)(.*\d*)(\).*;)/,"$6")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelsBase=void 0;var r=n(4),o=n(8);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=n(1),s=n(0),u=function(){function e(e){var t=this;void 0===e&&(e={}),this.addMixins(),this.getRegisteredActionsArr.bind(this),this.createChannelActionsObj();var n=new a.Subject;this.props=Object.assign({},{name:"observer"},e),this.observer$=this.props.observer=n,this.streamsController=window.Spyne.channels,this.streamsController.getStream("DISPATCHER").subscribe(function(e){return t.onIncomingObservable(e)})}var t,n,u,c=e.prototype;return c.setTrace=function(e){},c.createChannelActionsObj=function(){var e=this.getRegisteredActionsArr(),t=s.mergeAll(s.chain(function(e){return s.objOf(e,e)},e));this.channelActions=t},c.getRegisteredActionsArr=function(){return[]},c.onIncomingObservable=function(e){var t=this,n=function(t){return{observableData:e.data,observableEvent:t}};return!0===s.equals(e.name,this.props.name)?function(e){return e.observable.map(n).subscribe(t.onIncomingObserverableData.bind(t))}(e):void 0},c.onIncomingObserverableData=function(e){},c.sendStreamItem=function(e,t,n,r,i){void 0===i&&(i=this.observer$);var a=new o.ChannelStreamItem(this.props.name,e,t,n,r);i.next(Object.freeze(a))},c.getChannel=function(e){var t=this;return s.ifElse(function(e){return(0,r.registeredStreamNames)().includes(e)},function(e){return t.streamsController.getStream(e).observer},function(e){return console.warn("channel name "+e+" is not within "+r.registeredStreamNames)})(e)},c.addMixins=function(){},t=e,(n=[{key:"observer",get:function(){return this.observer$}}])&&i(t.prototype,n),u&&i(t,u),e}();t.ChannelsBase=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamsConfig=t.registeredStreamNames=t.lifestreamValidations=t.routeValidations=t.uiValidations=t.stepValidations=t.stepUpdateValidations=t.stepDisposeValidations=void 0;var r=n(0),o=n(1),i=function(){return{includes:function(){return void 0!==window.Spyne?Array.from(window.Spyne.channels.map.keys()):["ROUTE","UI","DOM","DISPATCHER"]}}};t.registeredStreamNames=i;var a=["LOAD","RENDER","MOUNT","UNMOUNT","DISPOSE","GARBAGE_COLLECT","UPDATE"],s=["parent","self","child","children","view"],u=["Observable","BehaviorSubject","Subject","Observer","Subscriber","FromEventObservable"],c=["subscribe","combineLatest"],d=[{error:"need to match a valid name within "+u,predicate:function(e){return i().includes(e.name)}},{error:"param 'observable' must contain a valid Rx.Observable",predicate:function(e){return void 0!==e.observable.subscribe}},{error:"param action must be a registered action",predicate:function(e){return c.includes(e.action)}}],l=[{error:"needs cid number in srcElement",predicate:r.compose(r.is(String),r.path(["data","srcElement","cid"]))},{error:"needs a viewName in srcElement",predicate:r.compose(r.is(String),r.path(["data","srcElement","viewName"]))}];t.uiValidations=function(){return[].concat(d).concat(l)};var h=[{error:"need to match a valid name within "+u,predicate:function(e){return i().includes(e.name)}},{error:"needs one of the following step strings: "+a,predicate:function(e){return a.includes(e.STEP)}},{error:"type needs to one of the following: "+s,predicate:function(e){return s.includes(e.type)}},{error:"viewId needs to be added ",predicate:function(e){return void 0!==e.viewId}}];t.stepValidations=function(){return[].concat(h)};t.stepDisposeValidations=function(){return[{error:"DISPOSE STEP requires a disposeItem param in the data object",predicate:function(e){return"DISPOSE"===e.STEP&&void 0!==e.data.disposeItems}}].concat(h)};t.stepUpdateValidations=function(){var e=[{error:"UPDATE STEP requires a data object ",predicate:function(e){return"UPDATE"===e.STEP&&void 0!==e.data}}];return e.concat(h)};t.lifestreamValidations=function(){return h.concat(d).concat(l)};t.routeValidations=function(){return[].concat(d).concat(l)};t.StreamsConfig=function(){var e=[{error:"param 'name' must be of a registered type",predicate:function(e){return i().includes(e.name)}},{error:"param 'observable' must contain a valid Rx.Observable",predicate:function(e){return u.includes((0,e.observable)().constructor.name)}},{error:"param action must be a registered action",predicate:function(e){return c.includes(e.action)}}];return{streams:[{init:{name:"DISPATCHER",observable:function(){return new o.Subject},action:"subscribe"},structure:{type:String,observable:o.Observable||o.Subject,action:String},validations:e},{init:{name:"UBU",observable:function(){return new o.Subject},action:"subscribe"},structure:{type:String,observable:o.Observable||o.Subject,action:String},validations:e}]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelsPayload=void 0;var r=n(4),o=n(7),i=n(10),a=n(2),s=function(){function e(e,t,n,r,o){void 0===r&&(r="subscribe"),void 0===o&&(o=!1),this.addMixins(),this.options={name:e,observable:t,data:n,action:r},this.getValidationChecks(e)}var t=e.prototype;return t.getValidationChecks=function(e){var t=this,n={UI:r.uiValidations,ROUTE:r.routeValidations,LIFESTREAM:r.lifestreamValidations};return(0,a.findInObj)(n,e,"payload Needs a Valid Stream Name!").fold(function(e){return console.warn(e)},function(e){return t.onRunValidations(e)})},t.onRunValidations=function(e){(0,o.validate)(e(),this.options).fold(this.onError.bind(this),this.onSuccess.bind(this))},t.onPayloadValidated=function(e){this.sendToDirectorStream(e)},t.sendToDirectorStream=function(e){window.Spyne.channels.getStream("DISPATCHER").next(e),this.gc()},t.onError=function(e){console.warn("payload failed due to:\n"+e.map(function(e){return"* "+e}).join("\n")),this.gc()},t.onSuccess=function(e){this.onPayloadValidated(e)},t.addMixins=function(){this.gc=i.gc},e}();t.ChannelsPayload=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.baseCoreMixins=function(){return{createpropsMap:function(){var e=new WeakMap,t={cid:this.props.cid};return e.set(t,this.props),{key:t,weakMap:e}},gc:function(){for(var e in this)delete this[e]},createId:function(){var e=Math.floor(1e7*Math.random(1e7));return"cid-"+e},setTraceFunc:function(e){return!0===e?console.log:function(){}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validate=void 0;var r,o=(r=n(25))&&r.__esModule?r:{default:r},i=n(0);var a=o.default.Success,s=o.default.Failure,u=(0,i.curry)(function(e,t){var n=a((0,i.curryN)((0,i.length)(e),(0,i.always)(t)));return(0,i.reduce)(function(e,n){return e.ap(n.predicate(t)?a(t):s([n.error]))},n,e)});t.validate=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelStreamItem=void 0;var r=n(0),o=function(){function e(t,n,r,o,i){var a=t,s={channel:a,action:n,channelPayload:r,srcElement:o,event:i},u=window.Spyne.getChannelActions(a);return e.validateAction(n,a,u),"ROUTE"===a&&(s.location=e.getLocationData()),s}return e.validateAction=function(e,t,n){var o=r.contains(e,n);return!1===o&&void 0!==window.Spyne&&console.warn("warning: Action: '"+e+"' is not registered within the "+t+" channel!"),o},e.getLocationData=function(){return r.pickAll(["href","origin","protocol","host","hostname","port","pathname","search","hash"],window.location)},e.getStreamItem=function(){},e.getMouseEventKeys=function(){return["altKey","bubbles","cancelBubble","cancelable","clientX","clientY","composed","ctrlKey","currentTarget","defaultPrevented","detail","eventPhase","fromElement","isTrusted","layerX","layerY","metaKey","movementX","movementY","offsetX","offsetY","pageX","pageY","path","relatedTarget","returnValue","screenX","screenY","shiftKey","sourceCapabilities","srcElement","target","timeStamp","toElement","type","view","which","x","y"]},e}();t.ChannelStreamItem=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewStreamBroadcaster=void 0;var r=n(11),o=n(2),i=n(1),a=n(0),s=function(){function e(e,t){this.addMixins(),this.props=e,this.broadcastFn=t,this.broadcaster(this.broadcastFn)}var t=e.prototype;return t.addDblClickEvt=function(e){var t=i.Observable.fromEvent(e,"click");return t.buffer(t.debounceTime(250)).filter(function(e){return 2===e.length}).map(function(e){return e[0]})},t.broadcast=function(e){var t,n=this,r={UI:this.sendUIPayload,ROUTE:this.sendRoutePayload},s=e[0],u=e[1],c=e[2],d=e[3],l=this.props.el.querySelectorAll(s),h=function(e){var s="dblClick"!==u?i.Observable.fromEvent(e,u):n.addDblClickEvt(e);t=(0,o.ifNilThenUpdate)(c,e.dataset.channel),(d={}).payload=(0,o.convertDomStringMapToObj)(e.dataset),d.payload=a.omit(["channel"],d.payload),d.channel=t,d.srcElement={},d.srcElement.cid=n.props.id,d.srcElement.viewName=n.props.name,d.srcElement.event=u,d.srcElement.el=e,(void 0!==t?r[t]:r.UI)(s,d)};void 0===l||l.length<=0?h(l=this.props.el):(l.forEach=Array.prototype.forEach,l.forEach(h))},t.broadcaster=function(e){var t=this;e().forEach(function(e){return t.broadcast(e)})},t.addMixins=function(){var e=(0,r.baseStreamsMixins)();this.sendUIPayload=e.sendUIPayload,this.sendRoutePayload=e.sendRoutePayload,this.createLifeStreamPayload=e.createLifeStreamPayload},e}();t.ViewStreamBroadcaster=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gc=function(){var e=this;setTimeout(function(){r.forEach(function(e){return},e)},1)};var r=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.baseStreamsMixins=function(){return{testFunc:function(e){console.log("stream mixin is ",e)},sendRoutePayload:function(e,t){return new r.ChannelsPayload("ROUTE",e,t,"subscribe")},sendUIPayload:function(e,t){return new r.ChannelsPayload("UI",e,t,"subscribe")},sendChannelPayload:function(e,t){var n=this,o=function(e){return i.prop(e,n.props)},s=e,u={cid:o("cid"),el:o("el"),viewName:o("name")},c={payload:t,channel:s,srcElement:u};return new r.ChannelsPayload(e,new a.Observable.of(""),c,"subscribe")},sendLifeStreamPayload:function(e,t){return new r.ChannelsPayload("LIFESTREAM",e,t,"subscribe")},createLifeStreamPayload:function(e,t,n){void 0===t&&(t={}),void 0===n&&(n="parent");var r=this.props.name+": "+this.props.cid;return new o.LifestreamPayload("LIFESTREAM",e,n,r,t).data}}};var r=n(5),o=n(20),i=n(0),a=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LifecyleObservables=void 0;var r=n(1),o=n(0),i=function(){function e(t){this.props.observableStreams=e.createDirectionalObservables()}return e.createDirectionalFiltersObject=function(){return{P:["parent"],C:["child"],PCI:["parent","internal","child"],CI:["child","internal"],PI:["parent","internal"],PC:["parent","child"]}},e.addDefaultDir=function(e){return o.flip(o.merge)({$dir:["internal"]},o.clone(e))},e.addDownInternalDir=function(e,t){return void 0===t&&(t=["internal","down"]),o.flip(o.merge)(o.clone(e),{$dir:t})},e.addChildAndInternalDir=function(e,t){return void 0===t&&(t=["child","down"]),o.flip(o.merge)(o.clone(e),{$dir:t})},e.mapToDefaultDir=function(e){return this.addDefaultDir(e)},e.createDirectionalObservables=function(e){void 0===e&&(e=new r.Subject);var t=function(e){return o.propSatisfies(function(t){return t.includes(e)},"$dir")},n=t("parent"),i=t("child"),a=t("internal"),s=function(e){return o.merge({from$:e})},u=s("child"),c=s("internal"),d=s("parent"),l=e.filter(function(e){return void 0!==e&&void 0!==e.action}),h=e.filter(a).map(c),p=e.filter(n).map(u),f=e.filter(i).map(d),m={parent:p,internal:h,child:f};return{raw$:l,toInternal$:h,toParent$:p,toChild$:f,completeAll:function(){o.forEach(function(e){e.complete(),e.isStopped=!0},[l,h,p,f])},completeStream:function(e){void 0===e&&(e=[]);void 0!==e&&e.length>=1&&e.forEach(function(e){var t;void 0!==m[e]&&((t=m[e]).complete(),t.isStopped=!0)})}}},e}();t.LifecyleObservables=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewToDomMediator=void 0;var r=n(6),o=n(14),i=n(2),a=n(22),s=n(12),u=n(1),c=n(0),d=function(){function e(e,t,n,r){var o=this;void 0===t&&(t={}),void 0===n&&(n=""),void 0===r&&(r="theName"),this.addMixins(),this._state="INIT",this.cid=n,this.vsName=r,this.defaults={debug:!1,extendedHashMethods:{}},this.options=Object.assign({},this.defaults,t);this.addActionMethods().forEach(function(e){var t=e[0],n=e[1];o.options.extendedHashMethods[t]=function(e){return o[n](e)}}),this.options.hashMethods=this.setHashMethods(this.options.extendedHashMethods),this.sink$=e,this.sink$.subscribe(this.onSinkSubscribe.bind(this)),this.$dirs=s.LifecyleObservables.createDirectionalFiltersObject(),this.addDefaultDir=s.LifecyleObservables.addDefaultDir,this.sourceStreams=s.LifecyleObservables.createDirectionalObservables(),this._source$=this.sourceStreams.toInternal$}var t=e.prototype;return t.addActionMethods=function(){return[]},t.setHashMethods=function(e){var t=this;void 0===e&&(e={});var n={GARBAGE_COLLECT:function(e){return t.onGarbageCollect(e)},READY_FOR_GC:function(e){return t.onReadyForGC(e)},DISPOSE:function(e){return t.onDispose(e)},RENDER:function(e){return t.onRender(e)},RENDER_AND_ATTACH_TO_PARENT:function(e){return t.onRenderAndAttachToParent(e)},RENDER_AND_ATTACH_TO_DOM:function(e){return t.onRenderAndAttachToDom(e)},ATTACH_CHILD_TO_SELF:function(e){return t.onAttachChildToSelf(e)}};return Object.assign({},n,e)},t.createDomItem=function(){this.props=void 0!==this.props?this.props:{};var e=c.filter(function(e){return void 0!==e},c.pick(["id","className"],this.props));return new o.DomItem(this.props.tagName,e,this.props.data,this.props.template)},t.onDisposeCompleted=function(e){},t.animateInTween=function(e,t){(0,a.fadein)(e,t)},t.animateOutTween=function(e,t,n){(0,a.fadeout)(e,t,n)},t.setAnimateIn=function(e){if(!0===e.animateIn){var t=void 0!==e.el?e.el:this.domItem.el;this.animateInTween(t,e.animateOutTime)}},t.disposeMethodOld=function(e){var t=this,n=u.Observable.bindCallback(function(e,n){var r=void 0!==e.el.el?e.el.el:e.el;t.animateOutTween(r,e.animateOutTime,n)}),r=function(e){t._source$.next({action:"READY_FOR_GC",$dir:t.$dirs.I})};return(!0===e.animateOut?function(e){return n(e).subscribe(r),{action:"DISPOSING",$dir:t.$dirs.CI}}:function(){return{action:"DISPOSE_AND_READY_FOR_GC",$dir:t.$dirs.PCI}})(e)},t.disposeMethod=function(e){var t=this;return void 0!==e.animateOutClass?(function(){var n=void 0!==e.el.el?e.el.el:e.el,r={action:"READY_FOR_GC",$dir:t.$dirs.PI,el:n};e.el$.setClass(e.animateOutClass);u.Observable.fromEvent(n,"transitionend").filter(function(e){return e.target===n}).take(1).subscribe(function(){t._source$.next(r)})}(),{action:"DISPOSING",$dir:this.$dirs.CI}):{action:"DISPOSE_AND_READY_FOR_GC",$dir:t.$dirs.PCI}},t.onDispose=function(e){return this.disposeMethod(e)},t.removeStream=function(){void 0!==this.sourceStreams&&this.sourceStreams.completeStream(["internal","child"])},t.onGarbageCollect9=function(e){var t="PageChildBox"===this.vsName?1e3:0;window.setTimeout(this.onGarbageCollectRun.bind(this),t)},t.onReadyForGC=function(e){this.removeStream()},t.onGarbageCollect=function(e){void 0!==this.sourceStreams&&this.sourceStreams.completeStream(["parent"]),this.domItem.unmount()},t.getSourceStream=function(){return this._source$},t.combineDomItems=function(e){var t=c.isNil(e.query)?e.node:e.query;("appendChild"===e.attachType?function(e,t){return e.appendChild(t)}:function(e,t){return e.insertBefore(t,e.firstChild)})(t,this.domItem.render()),this.setAnimateIn(e)},t.onAttachChildToSelf=function(e){var t=e.childRenderData;return this.combineDomItems(t),{action:"CHILD_ATTACHED",$dir:this.$dirs.PI}},t.onRenderAndAttachToParent=function(e){return this.onRender(e),this.combineDomItems(e),{action:"RENDERED_AND_ATTACHED_TO_PARENT",el:this.domItem.el,$dir:this.$dirs.PI}},t.renderDomItem=function(e){return this.domItem=new(Function.prototype.bind.apply(o.DomItem,[null].concat(e))),this.domItem},t.onRender=function(e){var t,n=this;return{action:"RENDERED",el:(t=c.props(["tagName","domAttributes","data","template"],e),n.renderDomItem(t)),$dir:this.$dirs.I}},t.extendedMethods=function(e){},t.onRenderAndAttachToDom=function(e){var t,n=this;return e.attachData.el=(t=c.props(["tagName","domAttributes","data","template"],e),n.renderDomItem(t)),this.combineDomItems(e.attachData),{action:"RENDERED_AND_ATTACHED_TO_DOM",el:e.attachData.el.el,$dir:this.$dirs.CI}},t.onSinkSubscribe=function(e){var t,n=this,r=e.action,o=c.defaultTo(function(e){return n.extendedMethods(e)})(this.options.hashMethods[r])(e);void 0!==o&&(t=Object.freeze(o),n._source$.next(t))},t.addMixins=function(){var e=(0,r.baseCoreMixins)();this.createId=e.createId,this.createpropsMap=e.createpropsMap,this.convertDomStringMapToObj=i.convertDomStringMapToObj,this.ifNilThenUpdate=i.ifNilThenUpdate},e}();t.ViewToDomMediator=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DomItem=void 0;var r=n(6),o=n(23);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=n(0),s=function(){function e(e,t,n,r){void 0===e&&(e="div"),void 0===t&&(t={}),void 0===n&&(n=void 0),void 0===r&&(r=void 0),!0===a.is(String,t)&&(n=t,t={}),this.props=new Map,this.setProp("fragment",document.createDocumentFragment()),this.setProp("tagName",e),this.setProp("attrs",this.updateAttrs(t)),this.setProp("content",n),this.setProp("template",r),this.addMixins()}var t,n,s,u=e.prototype;return u.setProp=function(e,t){this.props.set(e,t)},u.getProp=function(e){return this.props.get(e)},u.setElAttrs=function(e,t){return this.getProp("attrs").forEach(function(t,n){"dataset"===n?a.forEachObjIndexed(function(t,n){e.dataset[n]=t},t):e.setAttribute(n,t)}),e},u.updateAttrs=function(e,t){var n=void 0!==t?t:new Map;return a.mapObjIndexed(function(e,t){return n.set(t,e)},e),n},u.addTemplate=function(e){var t=this,n=this.getProp("template");return void 0!==n?function(n){var r=t.getProp("content");r=a.is(Object,r)?r:{};var i=new o.DomTemplateRenderer(n,r).getTemplateNode();return e.appendChild(i),e}(n):function(e){return e}(e)},u.createElement=function(e){return void 0===e&&(e="div"),document.createElement(e)},u.addContent=function(e){var t=this.getProp("content");if(!0===a.is(String,t)){var n=document.createTextNode(t);e.appendChild(n)}return e},u.execute=function(){var e=a.pipe(this.createElement.bind(this),this.setElAttrs.bind(this),this.addTemplate.bind(this),this.addContent.bind(this))(this.getProp("tagName"));this.props.set("el",e)},u.render=function(){return this.execute(),this.getProp("el")},u.returnIfDefined=function(e,t){if(void 0!==t){var n=void 0===t;e[t]=!1===n?t:Object.assign(e[t],t)}},u.updateprops=function(e){return this.returnIfDefined(this.props,e),this},u.updatepropsAndRun=function(e){return this.updateprops(e),this.execute(),this.getProp("fragment")},u.unmount=function(){void 0!==this.props&&(this.getProp("el").remove(),this.props.clear(),this.gc())},u.updateTag=function(e){void 0===e&&(e="div"),this.updateprops(e)},u.updateAttributes=function(e){void 0===e&&(e={}),this.updateprops(e)},u.updateTemplate=function(e){this.updateprops(e)},u.updateData=function(e){void 0===e&&(e={}),this.updateprops(e)},u.addTagAndRender=function(e){void 0===e&&(e="div"),this.updatepropsAndRun(e)},u.addAttrsibutesAndRender=function(e){void 0===e&&(e={}),this.updatepropsAndRun(e)},u.addTemplateAndRender=function(e){this.updatepropsAndRun(e)},u.addDataAndRender=function(e){void 0===e&&(e={}),this.updatepropsAndRun(e)},u.addMixins=function(){var e=(0,r.baseCoreMixins)();this.gc=e.gc.bind(this)},t=e,(n=[{key:"el",get:function(){return this.props.get("el")}}])&&i(t.prototype,n),s&&i(t,s),e}();t.DomItem=s},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return e&&"object"===r(e)&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e)}function i(e,t){var n;return t&&!0===t.clone&&o(e)?s((n=e,Array.isArray(n)?[]:{}),e,t):e}function a(e,t,n){var r=e.slice();return t.forEach(function(t,a){void 0===r[a]?r[a]=i(t,n):o(t)?r[a]=s(e[a],t,n):-1===e.indexOf(t)&&r.push(i(t,n))}),r}function s(e,t,n){var r=Array.isArray(t),u=(n||{arrayMerge:a}).arrayMerge||a;return r?Array.isArray(e)?u(e,t,n):i(t,n):function(e,t,n){var r={};return o(e)&&Object.keys(e).forEach(function(t){r[t]=i(e[t],n)}),Object.keys(t).forEach(function(a){o(t[a])&&e[a]?r[a]=s(e[a],t[a],n):r[a]=i(t[a],n)}),r}(e,t,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.deepMerge=s,s.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce(function(e,n){return s(e,n,t)})}},function(e,t){!function(e){"use strict";if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=function(e){return e&&DataView.prototype.isPrototypeOf(e)},o=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};d.prototype.append=function(e,t){e=s(e),t=u(t);var n=this.map[e];this.map[e]=n?n+","+t:t},d.prototype.delete=function(e){delete this.map[s(e)]},d.prototype.get=function(e){return e=s(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(s(e))},d.prototype.set=function(e,t){this.map[s(e)]=u(t)},d.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},d.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),c(e)},d.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),c(e)},d.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),c(e)},t.iterable&&(d.prototype[Symbol.iterator]=d.prototype.entries);var i=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},m.call(v.prototype),m.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},y.error=function(){var e=new y(null,{status:0,statusText:""});return e.type="error",e};var a=[301,302,303,307,308];y.redirect=function(e,t){if(-1===a.indexOf(t))throw new RangeError("Invalid status code");return new y(null,{status:t,headers:{location:e}})},e.Headers=d,e.Request=v,e.Response=y,e.fetch=function(e,n){return new Promise(function(r,o){var i=new v(e,n),a=new XMLHttpRequest;a.onload=function(){var e,t,n={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new d,e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();t.append(r,o)}}),t)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var o="response"in a?a.response:a.responseText;r(new y(o,n))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.open(i.method,i.url,!0),"include"===i.credentials&&(a.withCredentials=!0),"responseType"in a&&t.blob&&(a.responseType="blob"),i.headers.forEach(function(e,t){a.setRequestHeader(t,e)}),a.send(void 0===i._bodyInit?null:i._bodyInit)})},e.fetch.polyfill=!0}function s(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function u(e){return"string"!=typeof e&&(e=String(e)),e}function c(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(n[Symbol.iterator]=function(){return n}),n}function d(e){this.map={},e instanceof d?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function l(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function h(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function p(e){var t=new FileReader,n=h(t);return t.readAsArrayBuffer(e),n}function f(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&r(e))this._bodyArrayBuffer=f(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!o(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=f(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}),this.text=function(){var e,t,n,r=l(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=h(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}function v(e,t){var n,r,o=(t=t||{}).body;if(e instanceof v){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new d(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),i.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function b(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}}),t}function y(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelsBaseData=void 0;var r,o=(r=n(1))&&r.__esModule?r:{default:r},i=n(3),a=n(8);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(16);var u=function(e){var t,n;function r(t){var n;return void 0===t&&(t={}),(n=e.call(this,t)||this).props=t,n.observer$=new o.default.AsyncSubject,n.fetchData(),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i,u,c,d=r.prototype;return d.getRegisteredActionsArr=function(){return["CHANNEL_DATA_EVENT"]},d.fetchData=function(){var e=this,t=void 0!==this.props.map?this.props.map:function(e){return e};o.default.Observable.fromPromise(window.fetch(this.props.dataUrl)).flatMap(function(e){return o.default.Observable.fromPromise(e.json())}).map(t).map(function(t){return new a.ChannelStreamItem(e.props.name,"CHANNEL_DATA_EVENT",t)}).multicast(this.observer$).connect()},i=r,(u=[{key:"observer",get:function(){return this.observer$}}])&&s(i.prototype,u),c&&s(i,c),r}(i.ChannelsBase);t.ChannelsBaseData=u},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.DomItemSelectors=void 0;var o=n(0),i=function(){function e(e,t){this.el=void 0!==t?e.querySelectorAll(t):e,this.queryStr=t,1===this.el.length?this.el=o.head(this.el):"NodeList"===this.el.constructor.name&&(this.el=this.el.concat()),this.cList=this.el.classList,this.elProps=new Map,this.createMethods()}var t,n,i,a=e.prototype;return a.createMethods=function(){this.addClass=this.mapToValue(function(e,t){return e.classList.add(t)}),this.removeClass=this.mapToValue(function(e,t){return e.classList.remove(t)}),this.setClass=this.mapToValue(function(e,t){return e.classList.value=t,e}),this.inlineCss=this.mapToValue(function(e,t){return e.style.cssText=t,e})},a.mapMethod=function(e){var t=this;return function(n){return t.elArr.map(e),t}},a.addAnimClass=function(e){var t=this,n=function(){return t.addClass(e)};return requestAnimationFrame(function(){setTimeout(n,0)}),this},a.mapToValue=function(e){var t=this;return function(n){return t.elArr.map(function(t){return e(t,n)}),t}},a.setClassOnBool=function(e,t){return void 0===e&&(e=""),void 0===t&&(t=!0),t?this.addClass(e):this.removeClass(e),this},a.setActiveItem=function(e,t){var n=document.querySelector(this.queryStr+e),r=o.ifElse(function(e){return e===n},function(e){e.classList.add(t)},function(e){e.classList.remove(t)});this.elArr.map(r)},a.query=function(t){return new e(this.el,t)},a.getEl=function(){return this.el},a.getBoxEl=function(){return[].concat(this.el)},a.unmount=function(){this.el=void 0,this.cList=void 0,this.inline=void 0},t=e,(n=[{key:"elArr",get:function(){return"NodeList"===this.el.constructor.name?this.el.concat():[].concat(this.el)}}])&&r(t.prototype,n),i&&r(t,i),e}();t.DomItemSelectors=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewStreamEnhancerLoader=void 0;var r=n(2),o=n(0),i=function(){function e(e,t){this.context=e,this.enhancersMap=new Map,this.enhancersArr=t,this.initMap(),this.addAllEnhancerMethods()}var t=e.prototype;return t.initMap=function(){this.enhancersMap.set("ALL",[]);var e=(0,r.getAllMethodNames)(this.context).allMethods;this.updateMap("LOCAL",e)},t.getEnhancersMap=function(){return this.enhancersMap},t.updateMap=function(e,t){var n=o.concat(this.enhancersMap.get("ALL"),t);this.enhancersMap.set(e,t),this.enhancersMap.set("ALL",n)},t.getMethodsArr=function(e){return this.enhancersMap.get(e)},t.createEnhancerMethodsObj=function(e){var t,n,r,i=this,a=function(e){return console.error('Spyne Error: The following enhancer method, "'+e+'", already exists and cannot be added to the '+s.name+" Enhancer!")},s=new e(this.context),u=s.getEnhancerMethods(),c=(t=u.allMethods,n=o.contains(o.__,i.getMethodsArr("ALL")),(r=o.filter(n,t)).forEach(a),r),d=o.dropWhile(o.contains(o.__,c));return u=o.map(d,u),this.updateMap(s.name,u.allMethods),u.enhancer=s,u.name=s.name,u},t.addAllEnhancerMethods=function(){var e=this;o.forEach(function(t){var n=e.createEnhancerMethodsObj(t);n.enhancer.bindParentViewStream(n,e.context)},this.enhancersArr)},e}();t.ViewStreamEnhancerLoader=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LifestreamPayload=void 0;var r=n(4),o=n(7),i=n(10),a=n(2);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(e,t,n,r,o,i){void 0===o&&(o={}),void 0===i&&(i=!0),this.addMixins(),this.options={name:e,STEP:t,type:n,viewId:r,data:o},this.getValidationChecks(t)}var t,n,u,c=e.prototype;return c.getValidationChecks=function(e){var t=this,n={LOAD:r.stepValidations,RENDER:r.stepValidations,MOUNT:r.stepValidations,DISPOSE:r.stepDisposeValidations,UNMOUNT:r.stepValidations,GARBAGE_COLLECT:r.stepValidations,UPDATE:r.stepUpdateValidations};return(0,a.findInObj)(n,e,"lifestream payload Needs a Valid Stream Name!").fold(function(e){return console.warn(e)},function(e){return t.onRunValidations(e)})},c.onRunValidations=function(e){(0,o.validate)(e(),this.options).fold(this.onError.bind(this),this.onSuccess.bind(this))},c.onPayloadValidated=function(e){return this._data=e,e},c.onError=function(e){console.error("payload failed due to:\n"+e.map(function(e){return"* "+e}).join("\n")),this.gc()},c.onSuccess=function(e){this.onPayloadValidated(e)},c.addMixins=function(){this.gc=i.gc},t=e,(n=[{key:"data",get:function(){return this._data}}])&&s(t.prototype,n),u&&s(t,u),e}();t.LifestreamPayload=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewStream=void 0;var r=n(6),o=n(11),i=n(2),a=n(13),s=n(19),u=n(4),c=n(9),d=n(5),l=n(12),h=n(18);function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=n(1),m=n(0),v=function(){function e(e){var t=this;void 0===e&&(e={}),this.checker=Math.random(),this.addMixins(),this.defaults=function(){var n=t.createId(),r=e.id?e.id:n;return{cid:n,id:r,tagName:"div",el:void 0,data:void 0,animateIn:!1,animateInTime:.5,animateOut:!1,animateOutTime:.5,hashId:"#"+r,viewClass:a.ViewToDomMediator,extendedSourcesHashMethods:{},debug:!1,template:void 0,node:document.createDocumentFragment(),name:t.constructor.name}},this._state={},this.$dirs=l.LifecyleObservables.createDirectionalFiltersObject(),this.addDefaultDirection=l.LifecyleObservables.addDefaultDir,this.addDownInternalDir=l.LifecyleObservables.addDownInternalDir,this.props=Object.assign({},this.defaults(),e),this.props.domAttributes=m.pick(["id","class","dataset"],this.props),this.loadEnhancers(),this.loadAllMethods(),this.props.action="LOADED",this.sink$=new f.Subject;var n=this.props.viewClass;this.view=new n(this.sink$,{},this.checker,this.constructor.name),this.sourceStreams=this.view.sourceStreams,this._rawSource$=this.view.getSourceStream(),this._rawSource$.viewName=this.props.name,this.sendEventsDownStream=this.sendEventsDownStreamFn,this.init(),this.checkIfElementAlreadyExists()}var t,n,v,b=e.prototype;return b.checkIfElementAlreadyExists=function(){m.propSatisfies(m.allPass([function(e){return document.body.contains(e)},function(e){return void 0!==e&&void 0!==e.tagName}]),"el")(this.props)&&this.postRender()},b.loadEnhancers=function(e){void 0===e&&(e=[]);var t=new s.ViewStreamEnhancerLoader(this,e);this.props.enhancersMap=t.getEnhancersMap(),t=void 0},b.loadAllMethods=function(){var e=this,t=m.curry(this.onChannelMethodCall.bind(this));this.addActionMethods().forEach(function(n){var r=n[0],o=n[1],i=n[2],a=m.defaultTo("LOCAL");e.props.extendedSourcesHashMethods[r]=t(o,a(i))}),this.props.hashSourceMethods=this.setSourceHashMethods(this.props.extendedSourcesHashMethods)},b.addActionMethods=function(){return[]},b.onChannelMethodCall=function(e,t,n){if(void 0!==n.$dir&&n.$dir.includes("child")&&!0!==this.deleted){var r=Object.assign({},n);r.$dir=this.$dirs.C,this.sourceStreams.raw$.next(r)}var o=this.props.enhancersMap.get(t);!1===m.contains(e,o)?console.warn('Spyne Warning: The method, "'+e+'", does not appear to exist in '+t+" file! "):this[e](n)},b.setSourceHashMethods=function(e){var t=this;void 0===e&&(e={});var n={DISPOSING:function(e){return t.checkParentDispose(e)},DISPOSE:function(e){return t.onDispose(e)},RENDERED:function(e){return t.onRendered(e)},RENDERED_AND_ATTACHED_TO_DOM:function(e){return t.onRendered(e)},RENDERED_AND_ATTACHED_TO_PARENT:function(e){return t.onRendered(e)},READY_FOR_GC:function(e){return t.onReadyToGC(e)},NOTHING:function(){return{}}};return Object.assign({},n,e)},b.init=function(){var e=this;this._source$=this._rawSource$.map(function(t){return e.onMapViewSource(t)}).takeWhile(this.notGCSTATE),this.initAutoMergeSourceStreams(),this.updateSourceSubscription(this._source$,!0)},b.notGCSTATE=function(e){return!e.action.includes("READY_FOR_GC")},b.eqGCSTATE=function(e){return!e.action.includes("READY_FOR_GC")},b.notCOMPLETED=function(e){return!e.action.includes("COMPLETED")},b.notGCCOMPLETE=function(e){return!e.action.includes("GC_COMPLETE")},b.testVal=function(e){console.log("TESTING VALL IS ",e)},b.addParentStream=function(e,t){var n=this;this.parent$=e.filter(function(e){return void 0!==e&&void 0!==e.action}).map(function(e){var t=Object.assign({},e);return"DISPOSE_AND_READY_FOR_GC"===t.action&&(n.onDispose(t),t.action="READY_FOR_GC"),t}).takeWhile(this.notGCCOMPLETE),this.updateSourceSubscription(this.parent$,!1,"PARENT"),this.renderAndAttachToParent(t)},b.addChildStream=function(e){var t=this,n=e.filter(function(e){return void 0!==e&&void 0!==e.action}).do(function(e){return t.tracer("addChildStraem do ",e)}).map(function(e){return e}).finally(function(e){return t.onChildCompleted(n.source)});this.updateSourceSubscription(n,!0,"CHILD")},b.onChildCompleted=function(e){return this.tracer("onChildCompleted ",this.checker,e),function e(t){for(;void 0!==t.destination;)t=e(t.destination);return t}(e).viewName},b.initAutoMergeSourceStreams=function(){var e=this,t={next:this.onSubscribeToSourcesNext.bind(this),error:this.onSubscribeToSourcesError.bind(this),complete:this.onSubscribeToSourcesComplete.bind(this)},n=function(){0===(r-=1)&&(e.uberSource$.complete(),e.autoSubscriber$.complete(),e.sink$.complete(),e.props.el$.unmount(),e.props=void 0,e.deleted=!0,e.tracer("completeAll",e.deleted,e.props))},r=0;this.uberSource$=new f.Subject;this.autoMergeSubject$=this.uberSource$.mergeMap(function(t){var o=t.observable.filter(function(e){return void 0!==e&&void 0!==e.action}).map(function(t){var n=Object.assign({},t);return n.action=t.action,e.tracer("autoMergeSubject$",n),n});return!1===t.autoClosesBool?o:(r+=1,o.finally(n))}),this.autoSubscriber$=this.autoMergeSubject$.filter(function(e){return void 0!==e&&void 0!==e.action}).subscribe(t)},b.updateSourceSubscription=function(e,t,n){void 0===t&&(t=!1);var r={observable:e,autoClosesBool:t,rel:n};this.tracer("updateSourceSubscription ",this.checker,r),this.uberSource$.next(r)},b.onSubscribeToSourcesNext=function(e){var t=this;void 0===e&&(e={});var n=m.defaultTo(function(e){return t.sendExtendedStreams(e)}),r=(0,i.findStrOrRegexMatchStr)(this.props.hashSourceMethods,e.action);n(this.props.hashSourceMethods[r])(e),this.tracer("onSubscribeToSourcesNext",{payload:e})},b.onSubscribeToSourcesError=function(e){void 0===e&&(e=""),console.log("ALL ERROR  ",this.constructor.name,e)},b.onSubscribeToSourcesComplete=function(){this.tracer("onSubscribeToSourcesComplete","GARBAGE_COLLECT"),this.openSpigot("GARBAGE_COLLECT")},b.sendExtendedStreams=function(e){this.tracer("sendExtendedStreams",e),this.openSpigot(e.action,e)},b.renderAndAttachToParent=function(e){this.openSpigot("RENDER_AND_ATTACH_TO_PARENT",e)},b.renderView=function(){this.openSpigot("RENDER")},b.renderViewAndAttachToDom=function(e,t,n){var r={node:e,type:t,attachType:n};this.openSpigot("RENDER_AND_ATTACH_TO_DOM",{attachData:r})},b.attachChildToView=function(e){},b.checkParentDispose=function(e){"parent"===e.from$&&this.onDispose(e)},b.onDispose=function(e){this.openSpigot("DISPOSE")},b.onChildDispose=function(e){},b.onParentDisposing=function(e){this.openSpigot("DISPOSE")},b.onReadyToGC=function(e){var t=void 0!==e.from$&&"internal"===e.from$;this.tracer("onReadyToGC",t,e)},b.sendEventsDownStreamFn=function(e,t){void 0===t&&(t={});var n=Object.assign({action:t},e);n.$dir=this.$dirs.C,this.sourceStreams.raw$.next(n)},b.openSpigot=function(e,t){if(void 0===t&&(t={}),void 0!==this.props){this.props.action=e;var n=m.merge(this.props,t);this.sink$.next(Object.freeze(n))}},b.setAttachData=function(e,t){return{node:this.props.el,type:"ViewToDomMediator",attachType:e,query:this.props.el.querySelector(t)}},b.getParentEls=function(e,t){for(var n=function(e){return e.parentElement},r=0,o=e;r<t;)o=n(o),r++;return o},b.setAttachParentData=function(e,t,n){return{node:this.getParentEls(this.props.el,n),type:"ViewToDomMediator",attachType:e,query:this.props.el.parentElement.querySelector(t)}},b.onMapViewSource=function(e){return void 0===e&&(e={}),this.props=m.merge(this.props,e),e},b.exchangeViewsWithChild=function(e,t){this.addChildStream(e.sourceStreams.toParent$),e.addParentStream(this.sourceStreams.toChild$,t)},b.appendToDom=function(e){this.renderViewAndAttachToDom(e,"dom","appendChild")},b.prependToDom=function(e){this.renderViewAndAttachToDom(e,"dom","prependChild")},b.appendView=function(e,t){this.exchangeViewsWithChild(e,this.setAttachData("appendChild",t))},b.appendViewToParent=function(e,t,n){void 0===n&&(n=1),this.exchangeViewsWithChild(e,this.setAttachParentData("appendChild",t,n))},b.prependViewToParent=function(e,t,n){void 0===n&&(n=1),this.exchangeViewsWithChild(e,this.setAttachParentData("prependChild",t,n))},b.prependView=function(e,t){this.exchangeViewsWithChild(e,this.setAttachData("prependChild",t))},b.onRendered=function(e){"internal"===e.from$&&this.postRender()},b.postRender=function(){this.beforeAfterRender(),this.afterRender(),this.viewsStreamBroadcaster=new c.ViewStreamBroadcaster(this.props,this.broadcastEvents)},b.beforeAfterRender=function(){this.props.el$=new h.DomItemSelectors(this.props.el)},b.downStream=function(){},b.afterRender=function(){},b.broadcastEvents=function(){return[]},b.getChannel=function(e){var t=this;return m.ifElse(function(e){return(0,u.registeredStreamNames)().includes(e)},function(e){return window.Spyne.channels.getStream(e).observer.takeWhile(function(e){return!0!==t.deleted})},function(e){return console.warn("channel name "+e+" is not within "+u.registeredStreamNames)})(e)},b.addChannel=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=!0===t?this.$dirs.CI:this.$dirs.I,o=this.getChannel(e).map(function(e){return Object.assign({$dir:r},m.clone(e))});this.updateSourceSubscription(o,!1)},b.sendChannelPayload=function(e,t,n){void 0===t&&(t="DEFAULT_EVENT"),void 0===n&&(n={});var r={cid:this.props.cid,viewName:this.props.name,payload:n,action:t},o=f.Observable.of(r);return new d.ChannelsPayload(e,o,r)},b.tracer=function(){},b.isLocalEvent=function(e){return void 0!==m.path(["srcElement","el"],e)&&this.props.el.contains(e.srcElement.el)},b.addMixins=function(){var e=(0,r.baseCoreMixins)();this.createId=e.createId,this.createpropsMap=e.createpropsMap,this.convertDomStringMapToObj=i.convertDomStringMapToObj,this.ifNilThenUpdate=i.ifNilThenUpdate;var t=(0,o.baseStreamsMixins)();this.sendUIPayload=t.sendUIPayload,this.sendRoutePayload=t.sendRoutePayload,this.sendChannelPayload=t.sendChannelPayload.bind(this),this.createLifeStreamPayload=t.createLifeStreamPayload},t=e,(n=[{key:"source$",get:function(){return this._source$}}])&&p(t.prototype,n),v&&p(t,v),e}();t.ViewStream=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fadein=function(e,t){var n=1*window.getComputedStyle(e).opacity,o=r(!0,t,"ease",1===n);e.style.cssText+=o},t.fadeout=function(e,t,n){var o=r(!1,t,"ease");e.style.cssText+=o,console.log(t," inline is ",o),e.addEventListener("transitionend",n,!1)};var r=function(e,t,n,r){return void 0===e&&(e=!1),void 0===t&&(t=1),void 0===n&&(n="ease"),void 0===r&&(r=!1),(!0===r?"opacity:0;":"")+"transition: opacity "+t+"s "+n+"; opacity: "+(!0===e?1:0)+";"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DomTemplateRenderer=void 0;var r=n(0),o=function(){function e(t,n){var o=this;this.template=this.formatTemplate(t),this.templateData=n;var i=e.getStringArray(this.template),a=this.template.match(e.findTmplLoopsRE());a=null===a?[]:a;var s=r.contains(r.__,a),u=r.ifElse(s,function(t,n){return t.replace(e.parseTmplLoopsRE(),o.parseTheTmplLoop.bind(o))},this.addParams.bind(this));this.finalArr=i.map(u)}e.getStringArray=function(t){var n=t.split(e.findTmplLoopsRE()),o=/^([\\n\s\W]+)$/;return r.reject(function(e){return e.match(o)},n)},e.findTmplLoopsRE=function(){return/({{#\w+}}[\w\n\s\W]+?{{\/\w+}})/gm},e.parseTmplLoopsRE=function(){return/({{#(\w+)}})([\w\n\s\W]+?)({{\/\2}})/gm},e.swapParamsForTagsRE=function(){return/({{)(.*?)(}})/gm};var t=e.prototype;return t.removeThis=function(){this.finalArr=void 0,this.templateData=void 0,this.template=void 0},t.getTemplateNode=function(){var e=this.finalArr.join(" "),t=document.createRange().createContextualFragment(e);return window.setTimeout(this.removeThis(),10),t},t.getTemplateString=function(){return this.finalArr.join(" ")},t.formatTemplate=function(e){return"string"==typeof e?e:e.text},t.addParams=function(t){var n=this;return t.replace(e.swapParamsForTagsRE(),function(e,t,o,i){var a=n.templateData[o];return r.defaultTo("")(a)})},t.parseTheTmplLoop=function(t,n,r,o){var i=o;return this.templateData[r].map(function(t){var n;return"string"==typeof t?(n=t,t=i.replace(e.swapParamsForTagsRE(),n)):t=function(t,n){return n.replace(e.swapParamsForTagsRE(),function(e,n,r){return t[r]})}(t,i),t}).join(" ")},e}();t.DomTemplateRenderer=o},function(e,t){e.exports=i;var n=Object.create,r=function(){throw new Error("Not implemented.")},o=function(){return this};function i(){}function a(e){this.value=e}function s(e){this.value=e}a.prototype=n(i.prototype),s.prototype=n(i.prototype),i.Failure=function(e){return new a(e)},i.prototype.Failure=i.Failure,i.Success=function(e){return new s(e)},i.prototype.Success=i.Success,i.fromNullable=function(e){return null!=e?new s(e):new a(e)},i.prototype.fromNullable=i.fromNullable,i.fromEither=function(e){return e.fold(i.Failure,i.Success)},i.prototype.isFailure=!1,a.prototype.isFailure=!0,i.prototype.isSuccess=!1,s.prototype.isSuccess=!0,i.of=function(e){return new s(e)},i.prototype.of=i.of,i.prototype.ap=r,a.prototype.ap=function(e){return e.isFailure?this.Failure(this.value.concat(e.value)):this},s.prototype.ap=function(e){return e.isFailure?e:e.map(this.value)},i.prototype.map=r,a.prototype.map=o,s.prototype.map=function(e){return this.of(e(this.value))},i.prototype.toString=r,a.prototype.toString=function(){return"Validation.Failure("+this.value+")"},s.prototype.toString=function(){return"Validation.Success("+this.value+")"},i.prototype.isEqual=r,a.prototype.isEqual=function(e){return e.isFailure&&e.value===this.value},s.prototype.isEqual=function(e){return e.isSuccess&&e.value===this.value},i.prototype.get=r,a.prototype.get=function(){throw new TypeError("Can't extract the value of a Failure(a).")},s.prototype.get=function(){return this.value},i.prototype.getOrElse=r,a.prototype.getOrElse=function(e){return e},s.prototype.getOrElse=function(e){return this.value},i.prototype.orElse=r,s.prototype.orElse=o,a.prototype.orElse=function(e){return e(this.value)},i.prototype.merge=function(){return this.value},i.prototype.fold=r,a.prototype.fold=function(e,t){return e(this.value)},s.prototype.fold=function(e,t){return t(this.value)},i.prototype.cata=r,a.prototype.cata=function(e){return e.Failure(this.value)},s.prototype.cata=function(e){return e.Success(this.value)},i.prototype.swap=r,a.prototype.swap=function(){return this.Success(this.value)},s.prototype.swap=function(){return this.Failure(this.value)},i.prototype.bimap=r,a.prototype.bimap=function(e,t){return this.Failure(e(this.value))},s.prototype.bimap=function(e,t){return this.Success(t(this.value))},i.prototype.failureMap=r,s.prototype.failureMap=o,a.prototype.failureMap=function(e){return this.Failure(e(this.value))},i.prototype.leftMap=i.prototype.failureMap,s.prototype.leftMap=s.prototype.failureMap,a.prototype.leftMap=a.prototype.failureMap},function(e,t,n){e.exports=n(24)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelUtilsDom=void 0;var r=n(1),o=n(0),i=function(){function e(){this.createDomObservableFromEvent=e.createDomObservableFromEvent.bind(this)}return e.createDomObservableFromEvent=function(e,t,n){void 0===n&&(n=!0);return r.Observable.fromEventPattern(function(t){return window.addEventListener(e,t,{passive:n})},function(){window[e]=function(){}}).map(t)},e.createMediaQuery=function(e){var t=window.matchMedia(e);return this.checkIfValidMediaQuery(t,e),t},e.checkIfValidMediaQuery=function(e,t){var n=function(e){return e.replace(/\s+/gm,"")},r="MediaQueryList"===e.constructor.name&&n(e.media)===n(t);return!1===r&&function(t){console.warn('Spyne Warning: the following query string, "'+t+'", does not match "'+e.media+'" and may not be a valid Media Query item!')}(t),r},e.createMediaQueryHandler=function(e,t){var n=function(e){return function(t){return t.mediaQueryName=e,t}}(t),o=new function(e){return{addHandler:function(t){e.onchange=t},removeHandler:function(t){e.onchange=function(){}}}}(e);return new r.Observable.fromEventPattern(o.addHandler,o.removeHandler).map(n)},e.createMergedObsFromObj=function(t){var n=t.mediqQueries,r=[];return o.mapObjIndexed(function(t,n,o){var i=e.createMediaQuery(t);r.push(e.createMediaQueryHandler(i,n))},n),r},e}();t.ChannelUtilsDom=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelDOM=void 0;var r=n(3),o=n(2),i=n(26);var a=n(0),s=n(1),u=function(e){var t,n;function r(){var t;return(t=e.call(this)||this).bindStaticMethods(),t.observer$=new s.Subject,t.props.name="DOM",t}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var u=r.prototype;return u.init=function(){var e,t=this;this.domChannelConfig=window.Spyne.config.channels.DOM,this.currentScrollY=window.scrollY;var n=this.getActiveObservables();(e=s.Observable).merge.apply(e,n).subscribe(function(e){var n=e.action,r=e.channelPayload,o=e.srcElement,i=e.event;t.sendStreamItem(n,r,o,i)})},r.getScrollMapFn=function(e){var t=this.channelActions.CHANNEL_DOM_SCROLL_EVENT,n=window.scrollY,r=this.currentScrollY-n,o=r>=0?"up":"down";return this.currentScrollY=n,{action:t,channelPayload:{scrollY:n,scrollDistance:r,scrollDir:o},srcElement:e.srcElement,scrollDistance:r,event:e}},r.getMouseWheelMapFn=function(e){return{action:this.channelActions.CHANNEL_DOM_MOUSEWHEEL_EVENT,channelPayload:{scrollDir:e.deltaY<=0?"up":"down",deltaX:e.deltaX,deltaY:e.deltaY,deltaZ:e.deltaZ},srcElement:e.srcElement,event:e}},r.getResizeMapFn=function(e){return{action:this.channelActions.CHANNEL_DOM_RESIZE_EVENT,channelPayload:a.pick(["innerWidth","innerHeight","outerWidth","outerHeight"],window),srcElement:e.srcElement,event:e}},r.getOrientationMapFn=function(e){var t=this.channelActions.CHANNEL_DOM_ORIENTATION_EVENT,n=window.matchMedia("(orientation: portrait)").matches,r=a.pick(["innerWidth","innerHeight","outerWidth","outerHeight"],window);return r.orientation=!0===n?"portrait":"landscape",{action:t,channelPayload:r,srcElement:e.srcElement,event:e}},u.getMediaQueryMapFn=function(e){return{action:this.channelActions.CHANNEL_DOM_MEDIA_QUERY_EVENT,channelPayload:a.pick(["matches","media","mediaQueryName"],e),srcElement:e.srcElement,event:e}},u.createMouseWheelObservable=function(e){var t=e.debounceMSTimeForScroll;return i.ChannelUtilsDom.createDomObservableFromEvent("mousewheel",r.getMouseWheelMapFn.bind(this)).debounceTime(t)},u.createScrollObservable=function(e){var t=e.debounceMSTimeForScroll;return i.ChannelUtilsDom.createDomObservableFromEvent("scroll",r.getScrollMapFn.bind(this)).debounceTime(t).skipWhile(function(e){return 0===e.scrollDistance})},u.createOrientationObservable=function(e){return i.ChannelUtilsDom.createDomObservableFromEvent("orientationchange",r.getOrientationMapFn.bind(this))},u.createResizeObservable=function(e){var t=e.debounceMSTimeForResize;return i.ChannelUtilsDom.createDomObservableFromEvent("resize",r.getResizeMapFn.bind(this)).debounceTime(t)},u.getActiveObservables=function(e){void 0===e&&(e=this.domChannelConfig);var t=[];e.listenForMediaQueries=(0,o.checkIfObjIsNotEmptyOrNil)(e.mediqQueries);var n={listenForResize:this.createResizeObservable.bind(this),listenForOrientation:this.createOrientationObservable.bind(this),listenForScroll:this.createScrollObservable.bind(this),listenForMouseWheel:this.createMouseWheelObservable.bind(this)};return a.mapObjIndexed(function(n,r,o){e[r]&&t.push(n(e))},n),this.checkForMediaQueries(e.listenForMediaQueries),t},u.checkForMediaQueries=function(e){var t=this;!0===e&&this.getMediaQueryObservable(this.domChannelConfig).subscribe(function(e){var n=e.action,r=e.channelPayload,o=e.srcElement,i=e.event;t.sendStreamItem(n,r,o,i,t.observer$)})},u.getMediaQueryObservable=function(e){var t,n=this.createMergedObsFromObj(e);return(t=s.Observable).merge.apply(t,n).map(this.getMediaQueryMapFn.bind(this))},u.getRegisteredActionsArr=function(){return["CHANNEL_DOM_SCROLL_EVENT","CHANNEL_DOM_MOUSEWHEEL_EVENT","CHANNEL_DOM_MEDIA_QUERY_EVENT","CHANNEL_DOM_RESIZE_EVENT","CHANNEL_DOM_ORIENTATION_EVENT"]},u.bindStaticMethods=function(){this.createMediaQueryHandler=i.ChannelUtilsDom.createMediaQueryHandler.bind(this),this.createMergedObsFromObj=i.ChannelUtilsDom.createMergedObsFromObj.bind(this)},r}(r.ChannelsBase);t.ChannelDOM=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelUI=void 0;var r=n(3);var o=n(0),i=n(1),a=function(e){var t,n;function r(){var t;return(t=e.call(this)||this).props.name="UI",t.keyEventsLoaded=!1,t.keyCodeArr=[],t}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=r.prototype;return a.getRegisteredActionsArr=function(){return["CHANNEL_UI_EVENT","CHANNEL_UI_BLUR_EVENT","CHANNEL_UI_CLICK_EVENT","CHANNEL_UI_DBLCLICK_EVENT","CHANNEL_UI_FOCUS_EVENT","CHANNEL_UI_FOCUSIN_EVENT","CHANNEL_UI_FOCUSOUT_EVENT","CHANNEL_UI_INPUT_EVENT","CHANNEL_UI_KEYDOWN_EVENT","CHANNEL_UI_KEYPRESS_EVENT","CHANNEL_UI_KEYUP_EVENT","CHANNEL_UI_MOUSEDOWN_EVENT","CHANNEL_UI_MOUSEENTER_EVENT","CHANNEL_UI_MOUSELEAVE_EVENT","CHANNEL_UI_MOUSEMOVE_EVENT","CHANNEL_UI_MOUSEOUT_EVENT","CHANNEL_UI_MOUSEOVER_EVENT","CHANNEL_UI_MOUSEUP_EVENT","CHANNEL_UI_SELECT_EVENT"]},a.loadKeyStream=function(){var e=this,t=i.Observable.fromEvent(document,"keyup");this.keyPresses$=t.groupBy(function(e){return e.keyCode}).mergeAll().filter(function(t){return e.keyCodeArr.indexOf(t.keyCode)>=0}).repeat().subscribe(this.onKeyPressed.bind(this))},a.addKeyEvent=function(e){!1===this.keyEventsLoaded&&this.loadKeyStream(),this.keyEventsLoaded=!0,this.registerKey(e)},a.registerKey=function(e){this.keyCodeArr.push(e)},a.onKeyPressed=function(e){console.log("key is ",e)},a.onIncomingObservable=function(e){var t=this,n=function(t){return{observableData:e.data,uiEvent:t}};return!0===o.equals(e.name,this.props.name)?function(e){return e.observable.map(n).subscribe(t.onUIEvent.bind(t))}(e):void 0},a.getActionState=function(e){return void 0!==e.uiEvent.type?"CHANNEL_UI_"+String(e.uiEvent.type).toUpperCase()+"_EVENT":"CHANNEL_UI"},a.onUIEvent=function(e){e.action=this.getActionState(e);var t=this.getActionState(e),n=e.observableData,r=n.payload,o=n.srcElement,i=e.uiEvent;this.sendStreamItem(t,r,o,i)},r}(r.ChannelsBase);t.ChannelUI=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RouteUtils=void 0;var r=n(0),o=n(1),i=function(){function e(){this.createPopStateStream=e.createPopStateStream.bind(this)}return e.createPopStateStream=function(e){o.Observable.fromEventPattern(function(e){window.onpopstate=e},function(){window.onpopstate=function(){}}).subscribe(e)},e.getLastArrVal=function(e){var t;return t=e,void 0!==r.last(t)?r.last(t):""},e.getRouteArrData=function(t,n){var o=r.filter(r.contains(r.__,t),n);return{routedParamsArr:o,routedParam:e.getLastArrVal(o)}},e.flattenConfigObject=function(e){return r.values(r.fromPairs(function e(t){return r.chain(function(t){var n=t[0],o=t[1];return"[object Object]"===Object.prototype.toString.call(o)?r.map(function(e){var t=e[0],r=e[1];return[n+"."+t,r]},e(o)):[[n,o]]},r.toPairs(t))}(e)))},e.getLocationData=function(){return r.pickAll(["href","origin","protocol","host","hostname","port","pathname","search","hash"],window.location)},e}();t.RouteUtils=i},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.URLUtils=void 0;var o=n(0),i=function(){function e(){this.checkIfObjIsNotEmptyOrNil=e.checkIfObjIsNotEmptyOrNil.bind(this)}return e.checkIfObjIsNotEmptyOrNil=function(e){var t=o.compose(o.complement(o.isEmpty),o.head,o.values),n=o.compose(o.complement(o.isNil),o.head,o.values);return o.allPass([t,n])(e)},e.checkIfParamValueMatchesRegex=function(e,t){var n=o.reject(o.equals("keyword")),r=o.compose(n,o.keys),i=o.compose(o.find(function(t){return o.test(new RegExp(t),e)}),r)(t);return o.is(String,i)&&(t=o.assoc(e,o.prop(i,t),t)),t},e.getLocationStrByType=function(e,t){void 0===t&&(t=!1);var n={slash:"pathname",query:"search",hash:"hash"}[!0===t?"hash":e];return o.prop(n,window.location).replace(/^(\/)?(#)?(\/)?(.*)$/,"$4")},e.createRouteArrayFromParams=function(e,t,n,i){var a=this;void 0===n&&(n="slash");var s=[];return function t(n){var u={},c=n.keyword,d=void 0!==e[c]?e[c]:o.prop(c,i),l=r(n[d]);"string"===l?d=n[d]:"undefined"===l&&(n=a.checkIfParamValueMatchesRegex(d,n)),u[c]=d,a.checkIfObjIsNotEmptyOrNil(u)&&s.push(u);var h=o.is(Object,n),p=o.has(d,n),f=o.has("route",n);if(!0===(p&&h)){var m=n[d];o.has("route",m)&&t(m.route)}else!0===f&&void 0!==d&&t(n.route)}(t),s},e.createSlashString=function(e){var t=o.reject(o.isNil),n=o.when(o.complement(o.isNil,o.__),o.join("/"));return o.compose(n,t,o.flatten,o.map(o.values))(e)},e.createQueryString=function(e){var t=o.reject(o.isNil),n=this.checkIfObjIsNotEmptyOrNil,r=o.compose(o.join("="),o.flatten,o.toPairs),i=o.ifElse(n,r,o.always(void 0)),a=o.map(i),s=o.when(o.complement(o.isEmpty),o.concat("?"));return o.compose(s,o.join("&"),t,a)(e)},e.convertParamsToRoute=function(e,t,n,r){void 0===t&&(t=window.Spyne.config.channels.ROUTE);var o=void 0!==n?n:t.type,i=t.isHash,a=t.routes.route,s=void 0!==r?r:this.getLocationStrByType(o,i),u=this.convertRouteToParams(s,t,o).params,c=this.createRouteArrayFromParams(e,a,o,u);return"query"===o?this.createQueryString(c):this.createSlashString(c)},e.checkIfValueShouldMapToParam=function(e,t){var n=o.invert(e),r=o.compose(o.is(String),o.head,o.defaultTo([]),o.prop(t)),i=o.compose(o.head,o.prop(t));return o.ifElse(r,i,o.always(t))(n)},e.createArrFromSlashStr=function(e){return e.replace(/^([/])?(.*)$/,"$2").split("/")},e.convertSlashRouteStrToParamsObj=function(e,t){var n=this,r=t,i=this.createArrFromSlashStr(t),a=[],s=[],u=e;o.reduce(function(e,t){var r=n.checkIfValueShouldMapToParam(u,t);void 0!==(u=n.checkIfParamValueMatchesRegex(t,u))&&(a.push(u.keyword),s.push(r));var i=[t,"route"],c=o.path(i,u),d=o.path(["route"],u);void 0!==c?u=c:void 0!==d&&(u=d)},0,i);var c=o.zipObj(a,s),d=this.getLastArrVal(a);return{routedParamsArr:a,routedParam:d,params:c,routeStr:r}},e.getLastArrVal=function(e){var t;return t=e,void 0!==o.last(t)?o.last(t):""},e.createDefaultParamFromEmptyStr=function(e,t){var n={};return n[e.keyword]=this.checkIfValueShouldMapToParam(e,t),n},e.convertQueryStrToParams=function(e,t){var n=t,r=t.replace(/^([?])?(.*)$/,"$2"),i=o.compose(o.map(o.split("=")),o.split("&"))(r),a=o.fromPairs(i),s=o.map(o.head,i);return!0===o.isEmpty(t)&&(a=this.createDefaultParamFromEmptyStr(e,t),s=o.keys(a)),{routedParamsArr:s,routedParam:this.getLastArrVal(s),params:a,routeStr:n}},e.convertRouteToParams=function(e,t,n){if(void 0===t)return{};var r=void 0!==n?n:t.type,o=t.routes.route;return"query"===r?this.convertQueryStrToParams(o,e):this.convertSlashRouteStrToParamsObj(o,e)},e}();t.URLUtils=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelRoute=void 0;var r=n(3),o=n(30),i=n(29);var a=n(1),s=n(0),u=function(e){var t,n;function r(){var t;return(t=e.call(this)||this).createChannelActionsObj(),t.props.name="ROUTE",t.routeConfigJson=t.getRouteConfig(),t.bindStaticMethods(),t.navToStream$=new a.BehaviorSubject,t.observer$=t.navToStream$.map(function(e){return t.onMapNext(e)}),t}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var u=r.prototype;return u.init=function(){this.initStream()},u.createChannelActionsObj=function(){var e=this.getRegisteredActionsArr(),t=s.mergeAll(s.chain(function(e){return s.objOf(e,e)},e));this.channelActions=t},u.getRegisteredActionsArr=function(){return["CHANNEL_ROUTE_DEEPLINK_EVENT","CHANNEL_ROUTE_CHANGE_EVENT"]},u.getRouteConfig=function(){var e=window.Spyne.config,t=s.path(["channels","ROUTE"],e);"query"===t.type&&(t.isHash=!1);var n=i.RouteUtils.flattenConfigObject(t.routes);return t.paramsArr=n,t},u.initStream=function(){this.firstLoadStream$=new a.BehaviorSubject(this.onIncomingDomEvent(void 0,this.routeConfigJson,"CHANNEL_ROUTE_DEEPLINK_EVENT")),i.RouteUtils.createPopStateStream(this.onIncomingDomEvent.bind(this)),this.observer$=a.Observable.merge(this.firstLoadStream$,this.navToStream$)},u.onMapNext=function(e,t){return void 0===t&&(t=!1),e.action="CHANNEL_ROUTE_CHANGE_EVENT",e},r.onIncomingDomEvent=function(e,t,n){void 0===t&&(t=this.routeConfigJson);var r=void 0!==n?n:this.channelActions.CHANNEL_ROUTE_CHANGE_EVENT,o=this.getDataFromString(t);this.sendStreamItem(r,o,void 0,void 0,this.navToStream$)},u.onIncomingObserverableData=function(e){var t=this.channelActions.CHANNEL_ROUTE_CHANGE_EVENT,n=this.getDataFromParams(e),r=s.path(["observableData","srcElement"],e),o=e.observableEvent,i=!n.isHidden;this.sendRouteStream(n,i),this.sendStreamItem(t,n,r,o,this.navToStream$)},u.sendRouteStream=function(e,t){void 0===t&&(t=!0),!0===t&&this.setWindowLocation(e)},r.getRouteState=function(e){return"CHANNEL_ROUTE_CHANGE_EVENT"},r.getIsDeepLinkBool=function(){return 0===this._routeCount},r.getRouteCount=function(){return void 0===this._routeCount?(this._routeCount=0,this._routeCount):(this._routeCount+=1,this._routeCount)},r.getExtraPayloadParams=function(e){return void 0===e&&(e=this.routeConfigJson),{routeCount:this.getRouteCount(),isDeepLink:this.getIsDeepLinkBool(),isHash:e.isHash,isHidden:e.isHidden,routeType:e.type}},r.getDataFromParams=function(e,t){void 0===t&&(t=this.routeConfigJson);var n=s.path(["observableData","payload"],e),r=this.getRouteStrFromParams(n,t),o=this.getDataFromLocationStr(),i=o.routedParam,a=o.routedParamsArr;n=s.merge(o.params,n);var u=this.getExtraPayloadParams(t),c=u.routeCount;return{isDeepLink:u.isDeepLink,routeCount:c,routedParam:i,routedParamsArr:a,params:n,routeStr:r,isHash:u.isHash,isHidden:u.isHidden,routeType:u.routeType}},r.getDataFromString=function(e,t){void 0===e&&(e=this.routeConfigJson);var n=e.type,i=o.URLUtils.getLocationStrByType(n),a=r.getParamsFromRouteStr(i,e,n),s=a.routedParamsArr,u=a.routedParam,c=a.params,d=a.routeStr,l=this.getExtraPayloadParams(e),h=l.routeCount,p=l.isDeepLink,f=l.isHash,m=l.routeType;return{isDeepLink:p,routeCount:h,routedParam:u,routedParamsArr:s,params:c,routeStr:d,isHash:f,isHidden:l.isHidden,routeType:m}},r.getDataFromLocationStr=function(e){void 0===e&&(e="slash");var t=void 0!==this.routeConfigJson?this.routeConfigJson.type:e,n=o.URLUtils.getLocationStrByType(t),r=this.getParamsFromRouteStr(n,this.routeConfigJson,t);return{routedParamsArr:r.routedParamsArr,routedParam:r.routedParam,params:r.params,routeStr:r.routeStr,action:this.getRouteState()}},r.getLocationData=function(){return s.pickAll(["href","origin","protocol","host","hostname","port","pathname","search","hash"],window.location)},r.getRouteStrFromParams=function(e,t,n){var r=void 0!==n?n:t.type;return o.URLUtils.convertParamsToRoute(e,t,r)},r.getParamsFromRouteStr=function(e,t,n){var r=void 0!==n?n:t.type;return o.URLUtils.convertRouteToParams(e,t,r)},u.checkEmptyRouteStr=function(e,t){void 0===t&&(t=!1);var n=s.isEmpty(e),r=!0===n&&!1===t,o=!0===n&&!0===t,i=!1===n&&!0===t;return console.log("ROUTE STR CHECK ",{str:e,isHash:t}),!0===r||!0===o?"/":!0===i?s.concat("#",e):e},u.setWindowLocation=function(e){var t=e.isHash,n=e.routeStr;if(n=this.checkEmptyRouteStr(n,t),!0===t)console.log("ROUTE STR FOR HASH ",n),window.history.pushState({},"",n);else{var r=s.when(s.compose(s.complement(s.equals("/")),s.head),s.concat("/",s.__));window.history.pushState({},"",r(n))}},u.getWindowLocation=function(){return window.location.pathname},u.bindStaticMethods=function(){this.getIsDeepLinkBool=r.getIsDeepLinkBool.bind(this),this.getDataFromLocationStr=r.getDataFromLocationStr.bind(this),this.onIncomingDomEvent=r.onIncomingDomEvent.bind(this),this.getDataFromString=r.getDataFromString.bind(this),this.getParamsFromRouteStr=r.getParamsFromRouteStr.bind(this),this.getLocationData=r.getLocationData.bind(this),this.getRouteState=r.getRouteState.bind(this),this.getDataFromParams=r.getDataFromParams.bind(this),this.getRouteCount=r.getRouteCount.bind(this),this.getExtraPayloadParams=r.getExtraPayloadParams.bind(this);var e=s.curryN(3,r.getRouteStrFromParams);this.getRouteStrFromParams=e(s.__,this.routeConfigJson,this.routeConfigJson.type)},r}(r.ChannelsBase);t.ChannelRoute=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelsBaseController=void 0;var r=n(31),o=n(28),i=n(27),a=n(7),s=n(1),u=function(){function e(e){this.addMixins(),this.map=new Map,this.map.set("DISPATCHER",new s.Subject)}var t=e.prototype;return t.init=function(){this.createMainStreams()},t.createObserver=function(e){(0,a.validate)(e.validations,e.init),this.map.set(e.init.name,e.init.observable())},t.createMainStreams=function(){this.routeStream=new r.ChannelRoute,this.map.set("ROUTE",this.routeStream),this.uiStream=new o.ChannelUI,this.map.set("UI",this.uiStream),this.domStream=new i.ChannelDOM,this.map.set("DOM",this.domStream),this.routeStream.init(),this.domStream.init()},t.addKeyEvent=function(e){this.map.get("UI").addKeyEvent(e)},t.registerStream=function(e,t){this.map.set(e,t)},t.getChannelActions=function(e){return this.map.get(e).getRegisteredActionsArr()},t.getStream=function(e){if(void 0!==this.map.get(e))return this.map.get(e);console.warn('Spyne Warning: The Channel named "'+e+'" does not appear to be registered!')},t.addMixins=function(){},e}();t.ChannelsBaseController=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ChannelsBaseController",{enumerable:!0,get:function(){return r.ChannelsBaseController}}),Object.defineProperty(t,"DomItem",{enumerable:!0,get:function(){return o.DomItem}}),Object.defineProperty(t,"ViewToDomMediator",{enumerable:!0,get:function(){return i.ViewToDomMediator}}),Object.defineProperty(t,"ViewStream",{enumerable:!0,get:function(){return a.ViewStream}}),Object.defineProperty(t,"ViewStreamBroadcaster",{enumerable:!0,get:function(){return s.ViewStreamBroadcaster}}),Object.defineProperty(t,"ChannelsPayload",{enumerable:!0,get:function(){return u.ChannelsPayload}}),Object.defineProperty(t,"ChannelsBase",{enumerable:!0,get:function(){return c.ChannelsBase}}),Object.defineProperty(t,"ChannelsBaseData",{enumerable:!0,get:function(){return d.ChannelsBaseData}}),Object.defineProperty(t,"ChannelStreamItem",{enumerable:!0,get:function(){return l.ChannelStreamItem}}),t.Spyne=void 0;var r=n(32),o=n(14),i=n(13),a=n(21),s=n(9),u=n(5),c=n(3),d=n(17),l=n(8),h=n(15),p=function(){function e(e){var t=this;void 0===e&&(e={}),this.channels=new r.ChannelsBaseController,this.VERSION="0.7.0-BETA",this.ViewStream=a.ViewStream,this.BasicView=i.ViewToDomMediator,this.DomItem=o.DomItem,this.ViewStreamBroadcaster=s.ViewStreamBroadcaster,this.ChannelsPayload=u.ChannelsPayload,this.ChannelsBaseController=r.ChannelsBaseController,this.ChannelsBase=c.ChannelsBase,window.Spyne=this;void 0!==e&&(window.Spyne.config=(0,h.deepMerge)({channels:{DOM:{mediqQueries:{test:"(max-width: 500px)",newTest:"(max-width: 800px)"},listenForResize:!0,listenForOrientation:!0,listenForScroll:!0,listenForMouseWheel:!1,debounceMSTimeForResize:200,debounceMSTimeForScroll:150},ROUTE:{type:"slash",isHash:!1,isHidden:!1,routes:{route:{keyword:"change"}}}}},e)),this.getChannelActions=function(e){return window.Spyne.channels.getChannelActions(e)},this.registerChannel=function(e,n){return t.channels.registerStream(e,n)},this.registerDataChannel=function(e){return t.channels.registerStream(e.props.name,e)},this.channels.init()}return e.getChannelActions=function(e){return window.Spyne.channels.getChannelActions(e)},e.registerChannel=function(e,t){if(void 0!==window.Spyne)return window.Spyne.channels.registerStream(e,t);console.warn("Spyne has not been initialized")},e}();t.Spyne=p,window.Spyne=p}])});